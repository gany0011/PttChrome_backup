/*! paramikojs_ssh 2020-12-07 */
function paramikojs(){}function inherit(a,b){for(property in b)a[property]||(a[property]=b[property])}paramikojs={MSG_DISCONNECT:1,MSG_IGNORE:2,MSG_UNIMPLEMENTED:3,MSG_DEBUG:4,MSG_SERVICE_REQUEST:5,MSG_SERVICE_ACCEPT:6,MSG_KEXINIT:20,MSG_NEWKEYS:21,MSG_USERAUTH_REQUEST:50,MSG_USERAUTH_FAILURE:51,MSG_USERAUTH_SUCCESS:52,MSG_USERAUTH_BANNER:53,MSG_USERAUTH_PK_OK:60,MSG_USERAUTH_INFO_REQUEST:60,MSG_USERAUTH_INFO_RESPONSE:61,MSG_GLOBAL_REQUEST:80,MSG_REQUEST_SUCCESS:81,MSG_REQUEST_FAILURE:82,MSG_CHANNEL_OPEN:90,MSG_CHANNEL_OPEN_SUCCESS:91,MSG_CHANNEL_OPEN_FAILURE:92,MSG_CHANNEL_WINDOW_ADJUST:93,MSG_CHANNEL_DATA:94,MSG_CHANNEL_EXTENDED_DATA:95,MSG_CHANNEL_EOF:96,MSG_CHANNEL_CLOSE:97,MSG_CHANNEL_REQUEST:98,MSG_CHANNEL_SUCCESS:99,MSG_CHANNEL_FAILURE:100,MSG_NAMES:{1:"disconnect",2:"ignore",3:"unimplemented",4:"debug",5:"service-request",6:"service-accept",20:"kexinit",21:"newkeys",30:"kex30",31:"kex31",32:"kex32",33:"kex33",34:"kex34",50:"userauth-request",51:"userauth-failure",52:"userauth-success",53:"userauth--banner",60:"userauth-60(pk-ok/info-request)",61:"userauth-info-response",80:"global-request",81:"request-success",82:"request-failure",90:"channel-open",91:"channel-open-success",92:"channel-open-failure",93:"channel-window-adjust",94:"channel-data",95:"channel-extended-data",96:"channel-eof",97:"channel-close",98:"channel-request",99:"channel-success",100:"channel-failure"},AUTH_SUCCESSFUL:0,AUTH_PARTIALLY_SUCCESSFUL:1,AUTH_FAILED:2,OPEN_SUCCEEDED:0,OPEN_FAILED_ADMINISTRATIVELY_PROHIBITED:1,OPEN_FAILED_CONNECT_FAILED:2,OPEN_FAILED_UNKNOWN_CHANNEL_TYPE:3,OPEN_FAILED_RESOURCE_SHORTAGE:4,CONNECTION_FAILED_CODE:{1:"Administratively prohibited",2:"Connect failed",3:"Unknown channel type",4:"Resource shortage"},DISCONNECT_SERVICE_NOT_AVAILABLE:7,DISCONNECT_AUTH_CANCELLED_BY_USER:13,DISCONNECT_NO_MORE_AUTH_METHODS_AVAILABLE:14},kryptos=function(){},kryptos.prototype={},kryptos.cipher={},kryptos.hash={},kryptos.protocol={},kryptos.publicKey={},kryptos.random={},kryptos.random.Fortuna={},kryptos.random.OSRNG={},kryptos.util={},kryptos.toByteArray=function(a){function b(a){return a.charCodeAt(0)}return a.split("").map(b)},kryptos.fromByteArray=function(a){function b(a){return String.fromCharCode(a)}return a.map(b).join("")},kryptos.bytesToWords=function(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=(255&a[c])<<24-d%32;return b},kryptos.wordsToBytes=function(a){for(var b=[],c=0;c<32*a.length;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b},kryptos.hexToBytes=function(a){for(var b=[],c=0;c<a.length;c+=2)b.push(parseInt(a.substr(c,2),16));return b},kryptos.bytesToHex=function(a){for(var b=[],c=0;c<a.length;c++)b.push((a[c]>>>4).toString(16)),b.push((15&a[c]).toString(16));return b.join("")},sjcl={},sjcl.cipher={},sjcl.cipher.aes=function(a,b){this._tables[0][0][0]||this._precompute(),this.mode=b;var c,d,e,f,g,h=this._tables[0][4],i=this._tables[1],j=a.length,k=1;if(4!==j&&6!==j&&8!==j)throw"invalid aes key size";for(this._key=[f=a.slice(0),g=[]],c=j;4*j+28>c;c++)e=f[c-1],(c%j===0||8===j&&c%j===4)&&(e=h[e>>>24]<<24^h[e>>16&255]<<16^h[e>>8&255]<<8^h[255&e],c%j===0&&(e=e<<8^e>>>24^k<<24,k=k<<1^283*(k>>7))),f[c]=f[c-j]^e;for(d=0;c;d++,c--)e=f[3&d?c:c-4],g[d]=4>=c||4>d?e:i[0][h[e>>>24]]^i[1][h[e>>16&255]]^i[2][h[e>>8&255]]^i[3][h[255&e]]},sjcl.cipher.aes.MODE_CBC=2,sjcl.cipher.aes.MODE_CTR=6,sjcl.cipher.aes.prototype={encrypt:function(a,b,c){for(var d=this.mode==sjcl.cipher.aes.MODE_CBC?b:[],e=[],f=0;f<a.length/16;f++){var g=a.slice(16*f,16*(f+1));if(this.mode==sjcl.cipher.aes.MODE_CBC){for(var h=0;16>h;h++)g[h]^=d[h];d=sjcl.codec.bytes.fromBits(this._crypt(sjcl.codec.bytes.toBits(g),0))}else{d=sjcl.codec.bytes.fromBits(this._crypt(sjcl.codec.bytes.toBits(kryptos.toByteArray(c.call())),0));for(var h=0;16>h;h++)d[h]^=g[h]}e=e.concat(d)}return e},decrypt:function(a,b){for(var c=[],d=0;d<a.length/16;d++){var e=a.slice(16*d,16*(d+1));if(ct=sjcl.codec.bytes.fromBits(this._crypt(sjcl.codec.bytes.toBits(e),1)),this.mode==sjcl.cipher.aes.MODE_CBC){for(var f=0;16>f;f++)ct[f]^=b[f];b=e}c=c.concat(ct)}return c},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var a,b,c,d,e,f,g,h,i,j=this._tables[0],k=this._tables[1],l=j[4],m=k[4],n=[],o=[];for(a=0;256>a;a++)o[(n[a]=a<<1^283*(a>>7))^a]=a;for(b=c=0;!l[b];b^=d||1,c=o[c]||1)for(g=c^c<<1^c<<2^c<<3^c<<4,g=g>>8^255&g^99,l[b]=g,m[g]=b,f=n[e=n[d=n[b]]],i=16843009*f^65537*e^257*d^16843008*b,h=257*n[g]^16843008*g,a=0;4>a;a++)j[a][b]=h=h<<24^h>>>8,k[a][g]=i=i<<24^i>>>8;for(a=0;5>a;a++)j[a]=j[a].slice(0),k[a]=k[a].slice(0)},_crypt:function(a,b){if(4!==a.length)throw"invalid aes block size";var c,d,e,f,g=this._key[b],h=a[0]^g[0],i=a[b?3:1]^g[1],j=a[2]^g[2],k=a[b?1:3]^g[3],l=g.length/4-2,m=4,n=[0,0,0,0],o=this._tables[b],p=o[0],q=o[1],r=o[2],s=o[3],t=o[4];for(f=0;l>f;f++)c=p[h>>>24]^q[i>>16&255]^r[j>>8&255]^s[255&k]^g[m],d=p[i>>>24]^q[j>>16&255]^r[k>>8&255]^s[255&h]^g[m+1],e=p[j>>>24]^q[k>>16&255]^r[h>>8&255]^s[255&i]^g[m+2],k=p[k>>>24]^q[h>>16&255]^r[i>>8&255]^s[255&j]^g[m+3],m+=4,h=c,i=d,j=e;for(f=0;4>f;f++)n[b?3&-f:f]=t[h>>>24]<<24^t[i>>16&255]<<16^t[j>>8&255]<<8^t[255&k]^g[m++],c=h,h=i,i=j,j=k,k=c;return n}},sjcl.codec={},sjcl.codec.bytes={fromBits:function(a){var b,c,d=[],e=sjcl.bitArray.bitLength(a);for(b=0;e/8>b;b++)0===(3&b)&&(c=a[b/4]),d.push(c>>>24),c<<=8;return d},toBits:function(a){var b,c=[],d=0;for(b=0;b<a.length;b++)d=d<<8|a[b],3===(3&b)&&(c.push(d),d=0);return 3&b&&c.push(sjcl.bitArray.partial(8*(3&b),d)),c}},sjcl.bitArray={bitLength:function(a){var b,c=a.length;return 0===c?0:(b=a[c-1],32*(c-1)+sjcl.bitArray.getPartial(b))},partial:function(a,b,c){return 32===a?b:(c?0|b:b<<32-a)+1099511627776*a},getPartial:function(a){return Math.round(a/1099511627776)||32}},kryptos.cipher.AES=function(a,b,c,d){this.cipher=new sjcl.cipher.aes(sjcl.codec.bytes.toBits(kryptos.toByteArray(a)),b),this.mode=b,this.mode==kryptos.cipher.AES.MODE_CBC&&(this.iv=kryptos.toByteArray(c)),this.counter=d},kryptos.cipher.AES.MODE_CTR=6,kryptos.cipher.AES.MODE_CBC=2,kryptos.cipher.AES.prototype={encrypt:function(a){var b=this.cipher.encrypt(kryptos.toByteArray(a),this.iv,this.counter);return this.mode==kryptos.cipher.AES.MODE_CBC&&(this.iv=b.slice(-16)),kryptos.fromByteArray(b)},decrypt:function(a){if(a=kryptos.toByteArray(a),this.mode==kryptos.cipher.AES.MODE_CBC){var b=this.cipher.decrypt(a,this.iv);this.iv=a.slice(-16)}else var b=this.cipher.encrypt(a,this.iv,this.counter);return kryptos.fromByteArray(b)}},kryptos.cipher.Blowfish=function(a,b,c){this.c=new this.context(kryptos.toByteArray(a)),this.mode=b,this.originalIv=c=kryptos.toByteArray(c),this.iv=c[0]<<24|c[1]<<16|c[2]<<8|c[3],this.iv2=c[4]<<24|c[5]<<16|c[6]<<8|c[7]},kryptos.cipher.Blowfish.MODE_CBC=2,kryptos.cipher.Blowfish.prototype={context:function(a){this.p=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],this.s=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];for(var b=a.length>56?56:a.length,c=0,d=0;18>c;c++){for(var e=0,f=4;f--;)e=e<<8|a[d++%b];this.p[c]^=e}for(var g=0,h=0,c=0;18>c;){for(var i,j=16,k=-1,l=1;j--;)g^=this.p[k+=l],h^=(this.s[0][g>>24&255]+this.s[1][g>>16&255]^this.s[2][g>>8&255])+this.s[3][255&g],i=h,h=g,g=i;g=h^this.p[k+l+l],h=i^this.p[k+l],this.p[c++]=g,this.p[c++]=h}for(var m=0;4>m;m++)for(c=0;256>c;){for(var i,j=16,k=-1,l=1;j--;)g^=this.p[k+=l],h^=(this.s[0][g>>24&255]+this.s[1][g>>16&255]^this.s[2][g>>8&255])+this.s[3][255&g],i=h,h=g,g=i;g=h^this.p[k+l+l],h=i^this.p[k+l],this.s[m][c++]=g,this.s[m][c++]=h}},encrypt:function(a){for(var b=this.c.p,c=this.c.s[0],d=this.c.s[1],e=this.c.s[2],f=this.c.s[3],g=7&a.length;7&g++;)a+="\x00";g=a.length;for(var h=0,i=0,j=this.iv,k=this.iv2,l="",m=0;g>m;m+=8){var n=-1,o=1;h=a.charCodeAt(m)<<24|a.charCodeAt(m+1)<<16|a.charCodeAt(m+2)<<8|a.charCodeAt(m+3),i=a.charCodeAt(m+4)<<24|a.charCodeAt(m+5)<<16|a.charCodeAt(m+6)<<8|a.charCodeAt(m+7),h^=j,i^=k;for(var p,q=16;q--;)h^=b[n+=o],i^=(c[h>>24&255]+d[h>>16&255]^e[h>>8&255])+f[255&h],p=i,i=h,h=p;h=i^b[n+o+o],i=p^b[n+o],j=h,k=i,l+=String.fromCharCode(h>>24&255,h>>16&255,h>>8&255,255&h,i>>24&255,i>>16&255,i>>8&255,255&i)}return this.iv=h,this.iv2=i,l},decrypt:function(a){for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));var d=b.slice(-8),e=this.c.p,f=this.c.s[0],g=this.c.s[1],h=this.c.s[2],i=this.c.s[3],j=this.iv;8!=j.length&&(j=this.originalIv);for(var k=7&b.length;7&k++;)b.push(0);k=b.length;var l=0,m=0,n=0,o=0,p=0,q=0;p=j[0]<<24|j[1]<<16|j[2]<<8|j[3],q=j[4]<<24|j[5]<<16|j[6]<<8|j[7];for(var r="",s=0;k>s;s+=8){var t=18,u=-1;l=b[s]<<24|b[s+1]<<16|b[s+2]<<8|b[s+3],m=b[s+4]<<24|b[s+5]<<16|b[s+6]<<8|b[s+7],n=l,o=m;for(var v,c=16;c--;)l^=e[t+=u],m^=(f[l>>24&255]+g[l>>16&255]^h[l>>8&255])+i[255&l],v=m,m=l,l=v;l=m^e[t+u+u],m=v^e[t+u],l^=p,m^=q,p=n,q=o,r+=String.fromCharCode(l>>24&255,l>>16&255,l>>8&255,255&l,m>>24&255,m>>16&255,m>>8&255,255&m)}return this.iv=d,r}};var DES3=function(){function a(a,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=new Array(16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756),x=new Array(-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344),y=new Array(520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584),z=new Array(8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928),A=new Array(256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080),B=new Array(536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312),C=new Array(2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154),D=new Array(268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696),h=h||b(a),E=0,F=c.length,G=0,H=32==h.length?3:9;p=3==H?d?new Array(0,32,2):new Array(30,-2,-2):d?new Array(0,32,2,62,30,-2,64,96,2):new Array(94,62,-2,32,64,2,30,-2,-2),2==g?c+="        ":1==g?(k=8-F%8,c+=String.fromCharCode(k,k,k,k,k,k,k,k),8==k&&(F+=8)):g||(c+="\x00\x00\x00\x00\x00\x00\x00\x00");var I="",J="";for(1==e&&(q=f.charCodeAt(E++)<<24|f.charCodeAt(E++)<<16|f.charCodeAt(E++)<<8|f.charCodeAt(E++),s=f.charCodeAt(E++)<<24|f.charCodeAt(E++)<<16|f.charCodeAt(E++)<<8|f.charCodeAt(E++),E=0);F>E;){for(n=c.charCodeAt(E++)<<24|c.charCodeAt(E++)<<16|c.charCodeAt(E++)<<8|c.charCodeAt(E++),o=c.charCodeAt(E++)<<24|c.charCodeAt(E++)<<16|c.charCodeAt(E++)<<8|c.charCodeAt(E++),1==e&&(d?(n^=q,o^=s):(r=q,t=s,q=n,s=o)),k=252645135&(n>>>4^o),o^=k,n^=k<<4,k=65535&(n>>>16^o),o^=k,n^=k<<16,k=858993459&(o>>>2^n),n^=k,o^=k<<2,k=16711935&(o>>>8^n),n^=k,o^=k<<8,k=1431655765&(n>>>1^o),o^=k,n^=k<<1,n=n<<1|n>>>31,o=o<<1|o>>>31,j=0;H>j;j+=3){for(u=p[j+1],v=p[j+2],i=p[j];i!=u;i+=v)l=o^h[i],m=(o>>>4|o<<28)^h[i+1],k=n,n=o,o=k^(x[l>>>24&63]|z[l>>>16&63]|B[l>>>8&63]|D[63&l]|w[m>>>24&63]|y[m>>>16&63]|A[m>>>8&63]|C[63&m]);k=n,n=o,o=k}n=n>>>1|n<<31,o=o>>>1|o<<31,k=1431655765&(n>>>1^o),o^=k,n^=k<<1,k=16711935&(o>>>8^n),n^=k,o^=k<<8,k=858993459&(o>>>2^n),n^=k,o^=k<<2,k=65535&(n>>>16^o),o^=k,n^=k<<16,k=252645135&(n>>>4^o),o^=k,n^=k<<4,1==e&&(d?(q=n,s=o):(n^=r,o^=t)),J+=String.fromCharCode(n>>>24,n>>>16&255,n>>>8&255,255&n,o>>>24,o>>>16&255,o>>>8&255,255&o),G+=8,512==G&&(I+=J,J="",G=0)}return I+J}function b(a){for(var b,c,d,e,f,g=new Array(0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964),h=new Array(0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697),i=new Array(0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272),j=new Array(0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144),k=new Array(0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256),l=new Array(0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488),m=new Array(0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746),n=new Array(0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568),o=new Array(0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578),p=new Array(0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488),q=new Array(0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800),r=new Array(0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744),s=new Array(0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128),t=new Array(0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261),u=a.length>8?3:1,v=new Array(32*u),w=new Array(0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0),x=0,y=0,z=0;u>z;z++){e=a.charCodeAt(x++)<<24|a.charCodeAt(x++)<<16|a.charCodeAt(x++)<<8|a.charCodeAt(x++),f=a.charCodeAt(x++)<<24|a.charCodeAt(x++)<<16|a.charCodeAt(x++)<<8|a.charCodeAt(x++),d=252645135&(e>>>4^f),f^=d,e^=d<<4,d=65535&(f>>>-16^e),e^=d,f^=d<<-16,d=858993459&(e>>>2^f),f^=d,e^=d<<2,d=65535&(f>>>-16^e),e^=d,f^=d<<-16,d=1431655765&(e>>>1^f),f^=d,e^=d<<1,d=16711935&(f>>>8^e),e^=d,f^=d<<8,d=1431655765&(e>>>1^f),f^=d,e^=d<<1,d=e<<8|f>>>20&240,e=f<<24|f<<8&16711680|f>>>8&65280|f>>>24&240,f=d;for(var A=0;A<w.length;A++)w[A]?(e=e<<2|e>>>26,f=f<<2|f>>>26):(e=e<<1|e>>>27,f=f<<1|f>>>27),e&=-15,f&=-15,b=g[e>>>28]|h[e>>>24&15]|i[e>>>20&15]|j[e>>>16&15]|k[e>>>12&15]|l[e>>>8&15]|m[e>>>4&15],c=n[f>>>28]|o[f>>>24&15]|p[f>>>20&15]|q[f>>>16&15]|r[f>>>12&15]|s[f>>>8&15]|t[f>>>4&15],d=65535&(c>>>16^b),v[y++]=b^d,v[y++]=c^d<<16}return v}return{des:a,des_createKeys:b}}();kryptos.cipher.DES3=function(a,b,c){this.keys=DES3.des_createKeys(a),this.mode=b==kryptos.cipher.DES3.MODE_CBC?1:0,this.iv=c},kryptos.cipher.DES3.MODE_CBC=2,kryptos.cipher.DES3.prototype={encrypt:function(a){var b=DES3.des(null,a,!0,this.mode,this.iv,null,this.keys);return this.iv=b.substring(b.length-8),b},decrypt:function(a){var b=DES3.des(null,a,!1,this.mode,this.iv,null,this.keys);return this.iv=a.substring(a.length-8),b}},goog={},goog.crypt={},goog.crypt.Arc4=function(){this.state_=[],this.index1_=0,this.index2_=0},goog.crypt.Arc4.prototype.setKey=function(a,b){b||(b=a.length);for(var c=this.state_,d=0;256>d;++d)c[d]=d;for(var e=0,d=0;256>d;++d){e=e+c[d]+a[d%b]&255;var f=c[d];c[d]=c[e],c[e]=f}this.index1_=0,this.index2_=0},goog.crypt.Arc4.prototype.discard=function(a){var b=new Array(a);this.crypt(b)},goog.crypt.Arc4.prototype.crypt=function(a,b){b||(b=a.length);for(var c=this.index1_,d=this.index2_,e=this.state_,f=0;b>f;++f){c=c+1&255,d=d+e[c]&255;var g=e[c];e[c]=e[d],e[d]=g,a[f]^=e[e[c]+e[d]&255]}this.index1_=c,this.index2_=d},kryptos.cipher.ARC4=function(a){this.cipher=new goog.crypt.Arc4,this.cipher.setKey(kryptos.toByteArray(a))},kryptos.cipher.ARC4.prototype={encrypt:function(a){var a=kryptos.toByteArray(a);return this.cipher.crypt(a),kryptos.fromByteArray(a)},decrypt:function(a){return this.encrypt(a)}},kryptos.hash.baseHash=function(a){a instanceof Array&&(a=kryptos.fromByteArray(a)),this.data=a||""},kryptos.hash.baseHash.prototype={type:"",update:function(a){a instanceof Array&&(a=kryptos.fromByteArray(a)),this.data=this.data+a},digest:function(){for(var a=[],b=0;b<this.data.length;++b)a.push(this.data.charCodeAt(b));var c=window.Components.classes["@mozilla.org/security/hash;1"].createInstance(Components.interfaces.nsICryptoHash);c.initWithString(this.type),c.update(a,a.length);var d=c.finish(!1);return d}},kryptos.hash.SHA=function(a){inherit(this,new kryptos.hash.baseHash(a))},kryptos.hash.SHA.digest_size=20,kryptos.hash.SHA.prototype={type:"sha1"},window.Components||(kryptos.hash.SHA.prototype={digest:function(){var a=kryptos.toByteArray(this.data),b=kryptos.bytesToWords(a),c=8*a.length,d=[],e=1732584193,f=-271733879,g=-1732584194,h=271733878,i=-1009589776;b[c>>5]|=128<<24-c%32,b[(c+64>>>9<<4)+15]=c;for(var j=0;j<b.length;j+=16){for(var k=e,l=f,m=g,n=h,o=i,p=0;80>p;p++){if(16>p)d[p]=b[j+p];else{var q=d[p-3]^d[p-8]^d[p-14]^d[p-16];d[p]=q<<1|q>>>31}var r=(e<<5|e>>>27)+i+(d[p]>>>0)+(20>p?(f&g|~f&h)+1518500249:40>p?(f^g^h)+1859775393:60>p?(f&g|f&h|g&h)-1894007588:(f^g^h)-899497514);i=h,h=g,g=f<<30|f>>>2,f=e,e=r}e+=k,f+=l,g+=m,h+=n,i+=o}return kryptos.fromByteArray(kryptos.wordsToBytes([e,f,g,h,i]))}}),kryptos.hash.SHA256=function(a){inherit(this,new kryptos.hash.baseHash(a))},kryptos.hash.SHA256.digest_size=32,kryptos.hash.SHA256.prototype={type:"sha256"},window.Components||(kryptos.hash.SHA256.prototype={digest:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=kryptos.toByteArray(this.data),n=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=kryptos.bytesToWords(m),p=8*m.length,q=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],r=[];
o[p>>5]|=128<<24-p%32,o[(p+64>>9<<4)+15]=p;for(var i=0;i<o.length;i+=16){a=q[0],b=q[1],c=q[2],d=q[3],e=q[4],f=q[5],g=q[6],h=q[7];for(var j=0;64>j;j++){if(16>j)r[j]=o[j+i];else{var s=r[j-15],t=r[j-2],u=(s<<25|s>>>7)^(s<<14|s>>>18)^s>>>3,v=(t<<15|t>>>17)^(t<<13|t>>>19)^t>>>10;r[j]=u+(r[j-7]>>>0)+v+(r[j-16]>>>0)}var w=e&f^~e&g,x=a&b^a&c^b&c,y=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),z=(e<<26|e>>>6)^(e<<21|e>>>11)^(e<<7|e>>>25);k=(h>>>0)+z+w+n[j]+(r[j]>>>0),l=y+x,h=g,g=f,f=e,e=d+k>>>0,d=c,c=b,b=a,a=k+l>>>0}q[0]+=a,q[1]+=b,q[2]+=c,q[3]+=d,q[4]+=e,q[5]+=f,q[6]+=g,q[7]+=h}return kryptos.fromByteArray(kryptos.wordsToBytes(q))}}),kryptos.hash.SHA512=function(a){inherit(this,new kryptos.hash.baseHash(a))},kryptos.hash.SHA512.digest_size=64,kryptos.hash.SHA512.prototype={type:"sha512"},window.Components&&window.Components.classes||(kryptos.hash.SHA512.prototype={digest:function(){var a=kryptos.toByteArray(this.data),b=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],c=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],d=[],e=kryptos.bytesToWords(a),f=8*a.length;e[f>>5]|=128<<24-f%32,e[(f+128>>10<<5)+30]=Math.floor(f/4294967296),e[(f+128>>10<<5)+31]=f;for(var g=0;g<e.length;g+=32){for(var h=b,i=h[0],j=h[1],k=h[2],l=h[3],m=h[4],n=h[5],o=h[6],p=h[7],q=h[8],r=h[9],s=h[10],t=h[11],u=h[12],v=h[13],w=h[14],x=h[15],y=i,z=j,A=k,B=l,C=m,D=n,E=o,F=p,G=q,H=r,I=s,J=t,K=u,L=v,M=w,N=x,O=0;160>O;O+=2){if(32>O)var P=e[g+O],Q=e[g+O+1];else var R=d[O-4],S=d[O-3],T=d[O-14],U=d[O-13],V=d[O-30],W=d[O-29],X=d[O-32],Y=d[O-31],Z=(W<<31|V>>>1)^(W<<24|V>>>8)^V>>>7,$=(V<<31|W>>>1)^(V<<24|W>>>8)^(V<<25|W>>>7),_=(S<<13|R>>>19)^(R<<3|S>>>29)^R>>>6,ab=(R<<13|S>>>19)^(S<<3|R>>>29)^(R<<26|S>>>6),bb=$+ab,cb=Z+_+($>>>0>bb>>>0?1:0),db=U+Y,eb=T+X+(U>>>0>db>>>0?1:0),Q=bb+db,P=cb+eb+(bb>>>0>Q>>>0?1:0);d[O]=P|=0,d[O+1]=Q|=0}for(var O=0;160>O;O+=16){var P=d[O],Q=d[O+1],fb=c[O],gb=c[O+1],hb=q&s^~q&u,ib=r&t^~r&v,jb=i&k^i&m^k&m,kb=j&l^j&n^l&n,lb=(j<<4|i>>>28)^(i<<30|j>>>2)^(i<<25|j>>>7),mb=(i<<4|j>>>28)^(j<<30|i>>>2)^(j<<25|i>>>7),nb=(r<<18|q>>>14)^(r<<14|q>>>18)^(q<<23|r>>>9),ob=(q<<18|r>>>14)^(q<<14|r>>>18)^(r<<23|q>>>9),bb=ib+ob,cb=hb+nb+(ib>>>0>bb>>>0?1:0),db=Q+gb,eb=P+fb+(Q>>>0>db>>>0?1:0),pb=bb+db,qb=cb+eb+(bb>>>0>pb>>>0?1:0),rb=x+pb,sb=w+qb+(pb>>>0>rb>>>0?1:0),tb=kb+mb,ub=jb+lb+(kb>>>0>tb>>>0?1:0);p=p+rb|0,o=o+sb+(rb>>>0>p>>>0?1:0)|0,x=rb+tb|0,w=sb+ub+(rb>>>0>x>>>0?1:0)|0;var P=d[O+2],Q=d[O+3],fb=c[O+2],gb=c[O+3],hb=o&q^~o&s,ib=p&r^~p&t,jb=w&i^w&k^i&k,kb=x&j^x&l^j&l,lb=(x<<4|w>>>28)^(w<<30|x>>>2)^(w<<25|x>>>7),mb=(w<<4|x>>>28)^(x<<30|w>>>2)^(x<<25|w>>>7),nb=(p<<18|o>>>14)^(p<<14|o>>>18)^(o<<23|p>>>9),ob=(o<<18|p>>>14)^(o<<14|p>>>18)^(p<<23|o>>>9),bb=ib+ob,cb=hb+nb+(ib>>>0>bb>>>0?1:0),db=Q+gb,eb=P+fb+(Q>>>0>db>>>0?1:0),pb=bb+db,qb=cb+eb+(bb>>>0>pb>>>0?1:0),rb=v+pb,sb=u+qb+(pb>>>0>rb>>>0?1:0),tb=kb+mb,ub=jb+lb+(kb>>>0>tb>>>0?1:0);n=n+rb|0,m=m+sb+(rb>>>0>n>>>0?1:0)|0,v=rb+tb|0,u=sb+ub+(rb>>>0>v>>>0?1:0)|0;var P=d[O+4],Q=d[O+5],fb=c[O+4],gb=c[O+5],hb=m&o^~m&q,ib=n&p^~n&r,jb=u&w^u&i^w&i,kb=v&x^v&j^x&j,lb=(v<<4|u>>>28)^(u<<30|v>>>2)^(u<<25|v>>>7),mb=(u<<4|v>>>28)^(v<<30|u>>>2)^(v<<25|u>>>7),nb=(n<<18|m>>>14)^(n<<14|m>>>18)^(m<<23|n>>>9),ob=(m<<18|n>>>14)^(m<<14|n>>>18)^(n<<23|m>>>9),bb=ib+ob,cb=hb+nb+(ib>>>0>bb>>>0?1:0),db=Q+gb,eb=P+fb+(Q>>>0>db>>>0?1:0),pb=bb+db,qb=cb+eb+(bb>>>0>pb>>>0?1:0),rb=t+pb,sb=s+qb+(pb>>>0>rb>>>0?1:0),tb=kb+mb,ub=jb+lb+(kb>>>0>tb>>>0?1:0);l=l+rb|0,k=k+sb+(rb>>>0>l>>>0?1:0)|0,t=rb+tb|0,s=sb+ub+(rb>>>0>t>>>0?1:0)|0;var P=d[O+6],Q=d[O+7],fb=c[O+6],gb=c[O+7],hb=k&m^~k&o,ib=l&n^~l&p,jb=s&u^s&w^u&w,kb=t&v^t&x^v&x,lb=(t<<4|s>>>28)^(s<<30|t>>>2)^(s<<25|t>>>7),mb=(s<<4|t>>>28)^(t<<30|s>>>2)^(t<<25|s>>>7),nb=(l<<18|k>>>14)^(l<<14|k>>>18)^(k<<23|l>>>9),ob=(k<<18|l>>>14)^(k<<14|l>>>18)^(l<<23|k>>>9),bb=ib+ob,cb=hb+nb+(ib>>>0>bb>>>0?1:0),db=Q+gb,eb=P+fb+(Q>>>0>db>>>0?1:0),pb=bb+db,qb=cb+eb+(bb>>>0>pb>>>0?1:0),rb=r+pb,sb=q+qb+(pb>>>0>rb>>>0?1:0),tb=kb+mb,ub=jb+lb+(kb>>>0>tb>>>0?1:0);j=j+rb|0,i=i+sb+(rb>>>0>j>>>0?1:0)|0,r=rb+tb|0,q=sb+ub+(rb>>>0>r>>>0?1:0)|0;var P=d[O+8],Q=d[O+9],fb=c[O+8],gb=c[O+9],hb=i&k^~i&m,ib=j&l^~j&n,jb=q&s^q&u^s&u,kb=r&t^r&v^t&v,lb=(r<<4|q>>>28)^(q<<30|r>>>2)^(q<<25|r>>>7),mb=(q<<4|r>>>28)^(r<<30|q>>>2)^(r<<25|q>>>7),nb=(j<<18|i>>>14)^(j<<14|i>>>18)^(i<<23|j>>>9),ob=(i<<18|j>>>14)^(i<<14|j>>>18)^(j<<23|i>>>9),bb=ib+ob,cb=hb+nb+(ib>>>0>bb>>>0?1:0),db=Q+gb,eb=P+fb+(Q>>>0>db>>>0?1:0),pb=bb+db,qb=cb+eb+(bb>>>0>pb>>>0?1:0),rb=p+pb,sb=o+qb+(pb>>>0>rb>>>0?1:0),tb=kb+mb,ub=jb+lb+(kb>>>0>tb>>>0?1:0);x=x+rb|0,w=w+sb+(rb>>>0>x>>>0?1:0)|0,p=rb+tb|0,o=sb+ub+(rb>>>0>p>>>0?1:0)|0;var P=d[O+10],Q=d[O+11],fb=c[O+10],gb=c[O+11],hb=w&i^~w&k,ib=x&j^~x&l,jb=o&q^o&s^q&s,kb=p&r^p&t^r&t,lb=(p<<4|o>>>28)^(o<<30|p>>>2)^(o<<25|p>>>7),mb=(o<<4|p>>>28)^(p<<30|o>>>2)^(p<<25|o>>>7),nb=(x<<18|w>>>14)^(x<<14|w>>>18)^(w<<23|x>>>9),ob=(w<<18|x>>>14)^(w<<14|x>>>18)^(x<<23|w>>>9),bb=ib+ob,cb=hb+nb+(ib>>>0>bb>>>0?1:0),db=Q+gb,eb=P+fb+(Q>>>0>db>>>0?1:0),pb=bb+db,qb=cb+eb+(bb>>>0>pb>>>0?1:0),rb=n+pb,sb=m+qb+(pb>>>0>rb>>>0?1:0),tb=kb+mb,ub=jb+lb+(kb>>>0>tb>>>0?1:0);v=v+rb|0,u=u+sb+(rb>>>0>v>>>0?1:0)|0,n=rb+tb|0,m=sb+ub+(rb>>>0>n>>>0?1:0)|0;var P=d[O+12],Q=d[O+13],fb=c[O+12],gb=c[O+13],hb=u&w^~u&i,ib=v&x^~v&j,jb=m&o^m&q^o&q,kb=n&p^n&r^p&r,lb=(n<<4|m>>>28)^(m<<30|n>>>2)^(m<<25|n>>>7),mb=(m<<4|n>>>28)^(n<<30|m>>>2)^(n<<25|m>>>7),nb=(v<<18|u>>>14)^(v<<14|u>>>18)^(u<<23|v>>>9),ob=(u<<18|v>>>14)^(u<<14|v>>>18)^(v<<23|u>>>9),bb=ib+ob,cb=hb+nb+(ib>>>0>bb>>>0?1:0),db=Q+gb,eb=P+fb+(Q>>>0>db>>>0?1:0),pb=bb+db,qb=cb+eb+(bb>>>0>pb>>>0?1:0),rb=l+pb,sb=k+qb+(pb>>>0>rb>>>0?1:0),tb=kb+mb,ub=jb+lb+(kb>>>0>tb>>>0?1:0);t=t+rb|0,s=s+sb+(rb>>>0>t>>>0?1:0)|0,l=rb+tb|0,k=sb+ub+(rb>>>0>l>>>0?1:0)|0;var P=d[O+14],Q=d[O+15],fb=c[O+14],gb=c[O+15],hb=s&u^~s&w,ib=t&v^~t&x,jb=k&m^k&o^m&o,kb=l&n^l&p^n&p,lb=(l<<4|k>>>28)^(k<<30|l>>>2)^(k<<25|l>>>7),mb=(k<<4|l>>>28)^(l<<30|k>>>2)^(l<<25|k>>>7),nb=(t<<18|s>>>14)^(t<<14|s>>>18)^(s<<23|t>>>9),ob=(s<<18|t>>>14)^(s<<14|t>>>18)^(t<<23|s>>>9),bb=ib+ob,cb=hb+nb+(ib>>>0>bb>>>0?1:0),db=Q+gb,eb=P+fb+(Q>>>0>db>>>0?1:0),pb=bb+db,qb=cb+eb+(bb>>>0>pb>>>0?1:0),rb=j+pb,sb=i+qb+(pb>>>0>rb>>>0?1:0),tb=kb+mb,ub=jb+lb+(kb>>>0>tb>>>0?1:0);r=r+rb|0,q=q+sb+(rb>>>0>r>>>0?1:0)|0,j=rb+tb|0,i=sb+ub+(rb>>>0>j>>>0?1:0)|0}z=h[1]=z+j|0,h[0]=y+i+(j>>>0>z>>>0?1:0)|0,B=h[3]=B+l|0,h[2]=A+k+(l>>>0>B>>>0?1:0)|0,D=h[5]=D+n|0,h[4]=C+m+(n>>>0>D>>>0?1:0)|0,F=h[7]=F+p|0,h[6]=E+o+(p>>>0>F>>>0?1:0)|0,H=h[9]=H+r|0,h[8]=G+q+(r>>>0>H>>>0?1:0)|0,J=h[11]=J+t|0,h[10]=I+s+(t>>>0>J>>>0?1:0)|0,L=h[13]=L+v|0,h[12]=K+u+(v>>>0>L>>>0?1:0)|0,N=h[15]=N+x|0,h[14]=M+w+(x>>>0>N>>>0?1:0)|0}return kryptos.fromByteArray(kryptos.wordsToBytes(h))}}),kryptos.hash.MD5=function(a){inherit(this,new kryptos.hash.baseHash(a))},kryptos.hash.MD5.digest_size=16,kryptos.hash.MD5.prototype={type:"md5"},window.Components||(kryptos.hash.MD5.prototype={digest:function(){for(var a=kryptos.toByteArray(this.data),b=kryptos.bytesToWords(a),c=8*a.length,d=1732584193,e=-271733879,f=-1732584194,g=271733878,h=0;h<b.length;h++)b[h]=16711935&(b[h]<<8|b[h]>>>24)|4278255360&(b[h]<<24|b[h]>>>8);b[c>>>5]|=128<<c%32,b[(c+64>>>9<<4)+14]=c;for(var i=function(a,b,c,d,e,f,g){var h=a+(b&c|~b&d)+(e>>>0)+g;return(h<<f|h>>>32-f)+b},j=function(a,b,c,d,e,f,g){var h=a+(b&d|c&~d)+(e>>>0)+g;return(h<<f|h>>>32-f)+b},k=function(a,b,c,d,e,f,g){var h=a+(b^c^d)+(e>>>0)+g;return(h<<f|h>>>32-f)+b},l=function(a,b,c,d,e,f,g){var h=a+(c^(b|~d))+(e>>>0)+g;return(h<<f|h>>>32-f)+b},h=0;h<b.length;h+=16){var m=d,n=e,o=f,p=g;d=i(d,e,f,g,b[h+0],7,-680876936),g=i(g,d,e,f,b[h+1],12,-389564586),f=i(f,g,d,e,b[h+2],17,606105819),e=i(e,f,g,d,b[h+3],22,-1044525330),d=i(d,e,f,g,b[h+4],7,-176418897),g=i(g,d,e,f,b[h+5],12,1200080426),f=i(f,g,d,e,b[h+6],17,-1473231341),e=i(e,f,g,d,b[h+7],22,-45705983),d=i(d,e,f,g,b[h+8],7,1770035416),g=i(g,d,e,f,b[h+9],12,-1958414417),f=i(f,g,d,e,b[h+10],17,-42063),e=i(e,f,g,d,b[h+11],22,-1990404162),d=i(d,e,f,g,b[h+12],7,1804603682),g=i(g,d,e,f,b[h+13],12,-40341101),f=i(f,g,d,e,b[h+14],17,-1502002290),e=i(e,f,g,d,b[h+15],22,1236535329),d=j(d,e,f,g,b[h+1],5,-165796510),g=j(g,d,e,f,b[h+6],9,-1069501632),f=j(f,g,d,e,b[h+11],14,643717713),e=j(e,f,g,d,b[h+0],20,-373897302),d=j(d,e,f,g,b[h+5],5,-701558691),g=j(g,d,e,f,b[h+10],9,38016083),f=j(f,g,d,e,b[h+15],14,-660478335),e=j(e,f,g,d,b[h+4],20,-405537848),d=j(d,e,f,g,b[h+9],5,568446438),g=j(g,d,e,f,b[h+14],9,-1019803690),f=j(f,g,d,e,b[h+3],14,-187363961),e=j(e,f,g,d,b[h+8],20,1163531501),d=j(d,e,f,g,b[h+13],5,-1444681467),g=j(g,d,e,f,b[h+2],9,-51403784),f=j(f,g,d,e,b[h+7],14,1735328473),e=j(e,f,g,d,b[h+12],20,-1926607734),d=k(d,e,f,g,b[h+5],4,-378558),g=k(g,d,e,f,b[h+8],11,-2022574463),f=k(f,g,d,e,b[h+11],16,1839030562),e=k(e,f,g,d,b[h+14],23,-35309556),d=k(d,e,f,g,b[h+1],4,-1530992060),g=k(g,d,e,f,b[h+4],11,1272893353),f=k(f,g,d,e,b[h+7],16,-155497632),e=k(e,f,g,d,b[h+10],23,-1094730640),d=k(d,e,f,g,b[h+13],4,681279174),g=k(g,d,e,f,b[h+0],11,-358537222),f=k(f,g,d,e,b[h+3],16,-722521979),e=k(e,f,g,d,b[h+6],23,76029189),d=k(d,e,f,g,b[h+9],4,-640364487),g=k(g,d,e,f,b[h+12],11,-421815835),f=k(f,g,d,e,b[h+15],16,530742520),e=k(e,f,g,d,b[h+2],23,-995338651),d=l(d,e,f,g,b[h+0],6,-198630844),g=l(g,d,e,f,b[h+7],10,1126891415),f=l(f,g,d,e,b[h+14],15,-1416354905),e=l(e,f,g,d,b[h+5],21,-57434055),d=l(d,e,f,g,b[h+12],6,1700485571),g=l(g,d,e,f,b[h+3],10,-1894986606),f=l(f,g,d,e,b[h+10],15,-1051523),e=l(e,f,g,d,b[h+1],21,-2054922799),d=l(d,e,f,g,b[h+8],6,1873313359),g=l(g,d,e,f,b[h+15],10,-30611744),f=l(f,g,d,e,b[h+6],15,-1560198380),e=l(e,f,g,d,b[h+13],21,1309151649),d=l(d,e,f,g,b[h+4],6,-145523070),g=l(g,d,e,f,b[h+11],10,-1120210379),f=l(f,g,d,e,b[h+2],15,718787259),e=l(e,f,g,d,b[h+9],21,-343485551),d=d+m>>>0,e=e+n>>>0,f=f+o>>>0,g=g+p>>>0}var q=function(a,b){return a<<b|a>>>32-b},r=function(a){if(a.constructor==Number)return 16711935&q(a,8)|4278255360&q(a,24);for(var b=0;b<a.length;b++)a[b]=r(a[b]);return a};return kryptos.fromByteArray(kryptos.wordsToBytes(r([d,e,f,g])))}}),window.Components?(kryptos.hash.HMAC=function(a,b,c){var d=window.Components.classes["@mozilla.org/security/hmac;1"].createInstance(window.Components.interfaces.nsICryptoHMAC),e=window.Components.classes["@mozilla.org/security/keyobjectfactory;1"].getService(window.Components.interfaces.nsIKeyObjectFactory).keyFromString(window.Components.interfaces.nsIKeyObject.HMAC,a);d.init(c,e);var f=kryptos.toByteArray(b);return d.update(f,f.length),d.finish(!1)},kryptos.hash.HMAC_SHA=window.Components.classes["@mozilla.org/security/hmac;1"].createInstance(window.Components.interfaces.nsICryptoHMAC).SHA1,kryptos.hash.HMAC_SHA256=window.Components.classes["@mozilla.org/security/hmac;1"].createInstance(window.Components.interfaces.nsICryptoHMAC).SHA256,kryptos.hash.HMAC_SHA512=window.Components.classes["@mozilla.org/security/hmac;1"].createInstance(window.Components.interfaces.nsICryptoHMAC).SHA512,kryptos.hash.HMAC_MD5=window.Components.classes["@mozilla.org/security/hmac;1"].createInstance(window.Components.interfaces.nsICryptoHMAC).MD5):(kryptos.hash.HMAC=function(a,b,c){var d,e=64,f=54,g=92;switch(c){case 2:d=kryptos.hash.MD5;break;case 3:d=kryptos.hash.SHA;break;case 4:d=kryptos.hash.SHA256;break;case 6:d=kryptos.hash.SHA512,e=128}var h=new d,i=new d;a.length>e&&(a=new d(a).digest()),a+=new Array(e-a.length+1).join("\x00");for(var j=kryptos.toByteArray(a).slice(0),k=kryptos.toByteArray(a).slice(0),l=0;e>l;++l)j[l]^=g,k[l]^=f;return h.update(j),i.update(k),i.update(b),h.update(i.digest()),h.digest()},kryptos.hash.HMAC_SHA=3,kryptos.hash.HMAC_SHA256=4,kryptos.hash.HMAC_SHA512=6,kryptos.hash.HMAC_MD5=2),kryptos.publicKey.RSA=function(){},kryptos.publicKey.RSA.prototype={construct:function(a,b,c){return this.n=a,this.e=b,this.d=c,this},sign:function(a){return[a.modPow(this.d,this.n),""]},verify:function(a,b){var c=b[0];return c.modPow(this.e,this.n).equals(a)},generate:function(){alert("NOT_IMPLEMENTED")}},kryptos.publicKey.DSA=function(){},kryptos.publicKey.DSA.prototype={construct:function(a,b,c,d,e){return this.y=a,this.g=b,this.p=c,this.q=d,this.x=e,this},sign:function(a,b){var c=BigInteger.ONE;if(!(b.compareTo(c)>0&&this.q.compareTo(b)>0))throw"k is not between 2 and q-1";var d=b.modInverse(this.q),e=this.g.modPow(b,this.p).mod(this.q),f=d.multiply(a.add(this.x.multiply(e))).mod(this.q);return[e,f]},verify:function(a,b){var c=b[0],d=b[1],e=BigInteger.ZERO;if(!(c.compareTo(e)>0&&this.q.compareTo(c)>0&&d.compareTo(e)>0&&this.q.compareTo(d)>0))return!1;var f=d.modInverse(this.q),g=a.multiply(f).mod(this.q),h=c.multiply(f).mod(this.q),i=this.g.modPow(g,this.p).multiply(this.y.modPow(h,this.p)).mod(this.p).mod(this.q);return i.equals(c)},generate:function(){alert("NOT_IMPLEMENTED")}},kryptos.random.Random=function(){this._fa=new kryptos.random.Fortuna.FortunaAccumulator,this._ec=new kryptos.random._EntropyCollector(this._fa),this.reinit()},kryptos.random.Random.prototype={reinit:function(){this._ec.reinit()},flush:function(){},read:function(a,b){this._ec.collect(b);var c=this._fa.random_data(a);return c}},kryptos.random._EntropySource=function(a,b){this._fortuna=a,this._src_num=b,this._pool_num=0},kryptos.random._EntropySource.prototype={feed:function(a){this._fortuna.add_random_event(this._src_num,this._pool_num,a),this._pool_num=this._pool_num+1&31}},kryptos.random._EntropyCollector=function(a){this._osrng=new kryptos.random.OSRNG.BrowserRNG,this._osrng_es=new kryptos.random._EntropySource(a,255),this._time_es=new kryptos.random._EntropySource(a,254),this._time2_es=new kryptos.random._EntropySource(a,253),this.previousMilliseconds=(new Date).getMilliseconds()},kryptos.random._EntropyCollector.prototype={reinit:function(){for(var a=0;2>a;++a){for(var b=this._osrng.read(1024),c=0;32>c;++c)this._osrng_es.feed(b.substring(32*c,32*(c+1)));b=null}this._osrng.flush()},collect:function(a){this._osrng_es.feed(this._osrng.read(8,a));var b=(new Date).getMilliseconds()*Math.random()/1e3;this._time_es.feed(struct.pack("@I",parseInt(Math.pow(2,30)*(b-Math.floor(b)))));var c=(new Date).getMilliseconds();b=(this.previousMilliseconds+c)%1e3*Math.random()/1e3,this.previousMilliseconds=c,this._time2_es.feed(struct.pack("@I",parseInt(Math.pow(2,30)*(b-Math.floor(b)))))}},kryptos.random.Fortuna.SHAd256=function(a){inherit(this,new kryptos.hash.baseHash(a))},kryptos.random.Fortuna.SHAd256.digest_size=32,kryptos.random.Fortuna.SHAd256.prototype={type:"sha256",digest:function(){return new kryptos.hash.SHA256(new kryptos.hash.SHA256(this.data).digest()).digest()}},kryptos.random.Fortuna.FortunaPool=function(){this.reset()},kryptos.random.Fortuna.FortunaPool.prototype={digest_size:kryptos.random.Fortuna.SHAd256.digest_size,append:function(a){this._h.update(a),this.length+=a.length},digest:function(){return this._h.digest()},reset:function(){this._h=new kryptos.random.Fortuna.SHAd256,this.length=0}},kryptos.random.Fortuna.which_pools=function(a){for(var b=[],c=0,d=0;32>d&&0==(a&c);++d)b.push(d),c=c<<1|1;return b},kryptos.random.Fortuna.FortunaAccumulator=function(){this.reseed_count=0,this.generator=new kryptos.random.Fortuna.FortunaGenerator.AESGenerator,this.last_reseed=null,this.pools=[];for(var a=0;32>a;++a)this.pools.push(new kryptos.random.Fortuna.FortunaPool)},kryptos.random.Fortuna.FortunaAccumulator.prototype={min_pool_size:64,reseed_interval:.1,random_data:function(a){var b=new Date;return this.last_reseed>b&&(this.last_reseed=null),this.pools[0].length>=this.min_pool_size&&(!this.last_reseed||b>this.last_reseed+this.reseed_interval)&&this._reseed(b),this.generator.pseudo_random_data(a)},_reseed:function(a){a||(a=new Date);var b=[];this.reseed_count+=1,this.last_reseed=a;for(var c=kryptos.random.Fortuna.which_pools(this.reseed_count),d=0;d<c.length;++d)b.push(this.pools[d].digest()),this.pools[d].reset();b=b.join(""),this.generator.reseed(b)},add_random_event:function(a,b,c){this.pools[b].append(String.fromCharCode(a)),this.pools[b].append(String.fromCharCode(c.length)),this.pools[b].append(c)}},kryptos.random.Fortuna.FortunaGenerator={},kryptos.random.Fortuna.FortunaGenerator.AESGenerator=function(){this.counter=new paramikojs.util.Counter(8*this.block_size,0),this.key=null,this.block_size_shift=4,this.blocks_per_key=2,this.max_bytes_per_request=this.max_blocks_per_request*this.block_size},kryptos.random.Fortuna.FortunaGenerator.AESGenerator.prototype={block_size:16,key_size:32,max_blocks_per_request:Math.pow(2,16),_four_kiblocks_of_zeros:new Array(65537).join("\x00"),reseed:function(a){this.key||(this.key=new Array(this.key_size+1).join("\x00")),this._set_key(new kryptos.random.Fortuna.SHAd256(this.key+a).digest()),this.counter.call()},pseudo_random_data:function(a){for(var b=a>>20,c=1048575&a,d=[],e=0;b>e;++e)d.push(this._pseudo_random_data(1<<20));return d.push(this._pseudo_random_data(c)),d.join("")},_set_key:function(a){this.key=a,this._cipher=new kryptos.cipher.AES(a,kryptos.cipher.AES.MODE_CTR,0,this.counter)},_pseudo_random_data:function(a){var b=Math.ceil(1*a/this.block_size_shift),c=this._generate_blocks(b).substring(0,a);return this._set_key(this._generate_blocks(this.blocks_per_key)),c},_generate_blocks:function(a){for(var b=[],c=0;a>>12>c;++c)b.push(this._cipher.encrypt(this._four_kiblocks_of_zeros));var d=(4095&a)<<this.block_size_shift;return b.push(this._cipher.encrypt(this._four_kiblocks_of_zeros.substring(0,d))),b.join("")}},kryptos.random.OSRNG.BrowserRNG=function(){},kryptos.random.OSRNG.BrowserRNG.prototype={flush:function(){},read:function(a){var b=new Uint8Array(a);crypto.getRandomValues(b);for(var c="",d=0;a>d;++d)c+=String.fromCharCode(b[d]);return c},close:function(){}};var binascii={hexlify:function(a,b){var c="";b=b||"";for(var d=0;d<a.length;++d){var e=a.charCodeAt(d).toString(16);c+=(1==e.length?"0":"")+e+b}return c},unhexlify:function(a){for(var b="",c=0;c<a.length;c+=2)b+=String.fromCharCode(parseInt(a.charAt(c)+a.charAt(c+1),16));return b}},base64={encodestring:function(a){return window.btoa(a)},decodestring:function(a){return window.atob(a)}},struct={pack:function(a,b){var c=a[1],d="";switch(c){case"Q":var e=new BigInteger("ff",16);d+=String.fromCharCode(b.shiftRight(56).and(e)),d+=String.fromCharCode(b.shiftRight(48).and(e)),d+=String.fromCharCode(b.shiftRight(40).and(e)),d+=String.fromCharCode(b.shiftRight(32).and(e)),d+=String.fromCharCode(b.shiftRight(24).and(e)),d+=String.fromCharCode(b.shiftRight(16).and(e)),d+=String.fromCharCode(b.shiftRight(8).and(e)),d+=String.fromCharCode(b.and(e));break;case"I":d+=String.fromCharCode(b>>>24&255),d+=String.fromCharCode(b>>>16&255),d+=String.fromCharCode(b>>>8&255);case"B":d+=String.fromCharCode(255&b)}return d},unpack:function(a,b){var c=a[1],d=[],e=0,f=0;switch(c){case"Q":f=new BigInteger("0",10),f=f.add(new BigInteger(b.charCodeAt(0).toString(),10).shiftLeft(56)),f=f.add(new BigInteger(b.charCodeAt(1).toString(),10).shiftLeft(48)),f=f.add(new BigInteger(b.charCodeAt(2).toString(),10).shiftLeft(40)),f=f.add(new BigInteger(b.charCodeAt(3).toString(),10).shiftLeft(32)),f=f.add(new BigInteger(b.charCodeAt(4).toString(),10).shiftLeft(24)),f=f.add(new BigInteger(b.charCodeAt(5).toString(),10).shiftLeft(16)),f=f.add(new BigInteger(b.charCodeAt(6).toString(),10).shiftLeft(8)),f=f.add(new BigInteger(b.charCodeAt(7).toString(),10).shiftLeft(0)),d.push(f);break;case"I":f+=b.charCodeAt(0)<<24>>>0,f+=b.charCodeAt(1)<<16>>>0,f+=b.charCodeAt(2)<<8>>>0,e+=3;case"B":f+=b.charCodeAt(0+e)<<0>>>0,d.push(f)}return d}},sys={browser:"undefined"!=typeof window?-1!=navigator.userAgent.toLowerCase().indexOf("chrome")?"chrome":"mozilla":"server",platform:"undefined"!=typeof window?-1!=navigator.platform.toLowerCase().indexOf("linux")?"linux":-1!=navigator.platform.toLowerCase().indexOf("mac")?"darwin":"win32":"server"},BigInteger=function(){function a(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function b(){return new a(null)}function c(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function d(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function e(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function f(a){return dc.charAt(a)}function g(a,b){var c=ec[a.charCodeAt(b)];return null==c?-1:c}function h(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s}function i(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+DV:this.t=0}function j(a){var c=b();return c.fromInt(a),c}function k(b,c){var d;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return void this.fromRadix(b,c);d=2}this.t=0,this.s=0;for(var e=b.length,f=!1,h=0;--e>=0;){var i=8==d?255&b[e]:g(b,e);0>i?"-"==b.charAt(e)&&(f=!0):(f=!1,0==h?this[this.t++]=i:h+d>this.DB?(this[this.t-1]|=(i&(1<<this.DB-h)-1)<<h,this[this.t++]=i>>this.DB-h):this[this.t-1]|=i<<h,h+=d,h>=this.DB&&(h-=this.DB))}8==d&&0!=(128&b[0])&&(this.s=-1,h>0&&(this[this.t-1]|=(1<<this.DB-h)-1<<h)),this.clamp(),f&&a.ZERO.subTo(this,this)}function l(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function m(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,g="",h=this.t,i=this.DB-h*this.DB%b;if(h-->0)for(i<this.DB&&(c=this[h]>>i)>0&&(e=!0,g=f(c));h>=0;)b>i?(c=(this[h]&(1<<i)-1)<<b-i,c|=this[--h]>>(i+=this.DB-b)):(c=this[h]>>(i-=b)&d,0>=i&&(i+=this.DB,--h)),c>0&&(e=!0),e&&(g+=f(c));return e?g:"0"}function n(){var c=b();return a.ZERO.subTo(this,c),c}function o(){return this.s<0?this.negate():this}function p(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0}function q(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function r(){return this.t<=0?0:this.DB*(this.t-1)+q(this[this.t-1]^this.s&this.DM)}function s(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s}function t(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s}function u(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function v(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return void(b.t=0);var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function w(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()}function x(b,c){var d=this.abs(),e=b.abs(),f=d.t;for(c.t=f+e.t;--f>=0;)c[f]=0;for(f=0;f<e.t;++f)c[f+d.t]=d.am(0,e[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=b.s&&a.ZERO.subTo(c,c)}function y(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()}function z(c,d,e){var f=c.abs();if(!(f.t<=0)){var g=this.abs();if(g.t<f.t)return null!=d&&d.fromInt(0),void(null!=e&&this.copyTo(e));null==e&&(e=b());var h=b(),i=this.s,j=c.s,k=this.DB-q(f[f.t-1]);k>0?(f.lShiftTo(k,h),g.lShiftTo(k,e)):(f.copyTo(h),g.copyTo(e));var l=h.t,m=h[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?h[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,r=1<<this.F2,s=e.t,t=s-l,u=null==d?b():d;for(h.dlShiftTo(t,u),e.compareTo(u)>=0&&(e[e.t++]=1,e.subTo(u,e)),a.ONE.dlShiftTo(l,u),u.subTo(h,h);h.t<l;)h[h.t++]=0;for(;--t>=0;){var v=e[--s]==m?this.DM:Math.floor(e[s]*o+(e[s-1]+r)*p);if((e[s]+=h.am(0,v,e,t,0,l))<v)for(h.dlShiftTo(t,u),e.subTo(u,e);e[s]<--v;)e.subTo(u,e)}null!=d&&(e.drShiftTo(l,d),i!=j&&a.ZERO.subTo(d,d)),e.t=l,e.clamp(),k>0&&e.rShiftTo(k,e),0>i&&a.ZERO.subTo(e,e)}}}function A(c){var d=b();return this.abs().divRemTo(c,null,d),this.s<0&&d.compareTo(a.ZERO)>0&&c.subTo(d,d),d}function B(a){this.m=a}function C(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function D(a){return a}function E(a){a.divRemTo(this.m,null,a)}function F(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function G(a,b){a.squareTo(b),this.reduce(b)}function H(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function I(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function J(c){var d=b();return c.abs().dlShiftTo(this.m.t,d),d.divRemTo(this.m,null,d),c.s<0&&d.compareTo(a.ZERO)>0&&this.m.subTo(d,d),d}function K(a){var c=b();return a.copyTo(c),this.reduce(c),c}function L(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function M(a,b){a.squareTo(b),this.reduce(b)}function N(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function O(){return 0==(this.t>0?1&this[0]:this.s)}function P(c,d){if(c>4294967295||1>c)return a.ONE;var e=b(),f=b(),g=d.convert(this),h=q(c)-1;for(g.copyTo(e);--h>=0;)if(d.sqrTo(e,f),(c&1<<h)>0)d.mulTo(f,g,e);else{var i=e;e=f,f=i}return d.revert(e)}function Q(a,b){var c;return c=256>a||b.isEven()?new B(b):new I(b),this.exp(a,c)}function R(){var a=b();return this.copyTo(a),a}function S(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function T(){return 0==this.t?this.s:this[0]<<24>>24}function U(){return 0==this.t?this.s:this[0]<<16>>16}function V(a){return Math.floor(Math.LN2*this.DB/Math.log(a))}function W(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function X(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var c=this.chunkSize(a),d=Math.pow(a,c),e=j(d),f=b(),g=b(),h="";for(this.divRemTo(e,f,g);f.signum()>0;)h=(d+g.intValue()).toString(a).substr(1)+h,f.divRemTo(e,f,g);return g.intValue().toString(a)+h}function Y(b,c){this.fromInt(0),null==c&&(c=10);for(var d=this.chunkSize(c),e=Math.pow(c,d),f=!1,h=0,i=0,j=0;j<b.length;++j){var k=g(b,j);0>k?"-"==b.charAt(j)&&0==this.signum()&&(f=!0):(i=c*i+k,++h>=d&&(this.dMultiply(e),this.dAddOffset(i,0),h=0,i=0))}h>0&&(this.dMultiply(Math.pow(c,h)),this.dAddOffset(i,0)),f&&a.ZERO.subTo(this,this)}function Z(b,c,d){if("number"==typeof c)if(2>b)this.fromInt(1);else for(this.fromNumber(b,d),this.testBit(b-1)||this.bitwiseTo(a.ONE.shiftLeft(b-1),fb,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>b&&this.subTo(a.ONE.shiftLeft(b-1),this);else{var e=new Array,f=7&b;e.length=(b>>3)+1,c.nextBytes(e),f>0?e[0]&=(1<<f)-1:e[0]=0,this.fromString(e,256)}}function $(){var a=this.t,b=new Array;b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-->0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b}function _(a){return 0==this.compareTo(a)}function ab(a){return this.compareTo(a)<0?this:a}function bb(a){return this.compareTo(a)>0?this:a}function cb(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()}function db(a,b){return a&b}function eb(a){var c=b();return this.bitwiseTo(a,db,c),c}function fb(a,b){return a|b}function gb(a){var c=b();return this.bitwiseTo(a,fb,c),c}function hb(a,b){return a^b}function ib(a){var c=b();return this.bitwiseTo(a,hb,c),c}function jb(a,b){return a&~b}function kb(a){var c=b();return this.bitwiseTo(a,jb,c),c}function lb(){for(var a=b(),c=0;c<this.t;++c)a[c]=this.DM&~this[c];return a.t=this.t,a.s=~this.s,a}function mb(a){var c=b();return 0>a?this.rShiftTo(-a,c):this.lShiftTo(a,c),c}function nb(a){var c=b();return 0>a?this.lShiftTo(-a,c):this.rShiftTo(a,c),c}function ob(a){if(0==a)return-1;var b=0;return 0==(65535&a)&&(a>>=16,b+=16),0==(255&a)&&(a>>=8,b+=8),0==(15&a)&&(a>>=4,b+=4),0==(3&a)&&(a>>=2,b+=2),0==(1&a)&&++b,b}function pb(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+ob(this[a]);return this.s<0?this.t*this.DB:-1}function qb(a){for(var b=0;0!=a;)a&=a-1,++b;return b}function rb(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=qb(this[c]^b);return a}function sb(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)}function tb(b,c){var d=a.ONE.shiftLeft(b);return this.bitwiseTo(d,c,d),d}function ub(a){return this.changeBit(a,fb)}function vb(a){return this.changeBit(a,jb)}function wb(a){return this.changeBit(a,hb)}function xb(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b[c++]=d:-1>d&&(b[c++]=this.DV+d),b.t=c,b.clamp()}function yb(a){var c=b();return this.addTo(a,c),c}function zb(a){var c=b();return this.subTo(a,c),c}function Ab(a){var c=b();return this.multiplyTo(a,c),c}function Bb(a){var c=b();return this.divRemTo(a,c,null),c}function Cb(a){var c=b();return this.divRemTo(a,null,c),c}function Db(a){var c=b(),d=b();
return this.divRemTo(a,c,d),new Array(c,d)}function Eb(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()}function Fb(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}}function Gb(){}function Hb(a){return a}function Ib(a,b,c){a.multiplyTo(b,c)}function Jb(a,b){a.squareTo(b)}function Kb(a){return this.exp(a,new Gb)}function Lb(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()}function Mb(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)}function Nb(c){this.r2=b(),this.q3=b(),a.ONE.dlShiftTo(2*c.t,this.r2),this.mu=this.r2.divide(c),this.m=c}function Ob(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(a.compareTo(this.m)<0)return a;var c=b();return a.copyTo(c),this.reduce(c),c}function Pb(a){return a}function Qb(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);a.compareTo(this.r2)<0;)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)}function Rb(a,b){a.squareTo(b),this.reduce(b)}function Sb(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function Tb(a,c){var d,e,f=a.bitLength(),g=j(1);if(0>=f)return g;d=18>f?1:48>f?3:144>f?4:768>f?5:6,e=8>f?new B(c):c.isEven()?new Nb(c):new I(c);var h=new Array,i=3,k=d-1,l=(1<<d)-1;if(h[1]=e.convert(this),d>1){var m=b();for(e.sqrTo(h[1],m);l>=i;)h[i]=b(),e.mulTo(m,h[i-2],h[i]),i+=2}var n,o,p=a.t-1,r=!0,s=b();for(f=q(a[p])-1;p>=0;){for(f>=k?n=a[p]>>f-k&l:(n=(a[p]&(1<<f+1)-1)<<k-f,p>0&&(n|=a[p-1]>>this.DB+f-k)),i=d;0==(1&n);)n>>=1,--i;if((f-=i)<0&&(f+=this.DB,--p),r)h[n].copyTo(g),r=!1;else{for(;i>1;)e.sqrTo(g,s),e.sqrTo(s,g),i-=2;i>0?e.sqrTo(g,s):(o=g,g=s,s=o),e.mulTo(s,h[n],g)}for(;p>=0&&0==(a[p]&1<<f);)e.sqrTo(g,s),o=g,g=s,s=o,--f<0&&(f=this.DB-1,--p)}return e.revert(g)}function Ub(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(b.compareTo(c)<0){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(0>f)return b;for(f>e&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c}function Vb(a){if(0>=a)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c}function Wb(b){var c=b.isEven();if(this.isEven()&&c||0==b.signum())return a.ZERO;for(var d=b.clone(),e=this.clone(),f=j(1),g=j(0),h=j(0),i=j(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(b,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(b,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),c?(h.isEven()&&i.isEven()||(h.addTo(this,h),i.subTo(b,i)),h.rShiftTo(1,h)):i.isEven()||i.subTo(b,i),i.rShiftTo(1,i);d.compareTo(e)>=0?(d.subTo(e,d),c&&f.subTo(h,f),g.subTo(i,g)):(e.subTo(d,e),c&&h.subTo(f,h),i.subTo(g,i))}return 0!=e.compareTo(a.ONE)?a.ZERO:i.compareTo(b)>=0?i.subtract(b):i.signum()<0?(i.addTo(b,i),i.signum()<0?i.add(b):i):i}function Xb(a){var b,c=this.abs();if(1==c.t&&c[0]<=fc[fc.length-1]){for(b=0;b<fc.length;++b)if(c[0]==fc[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<fc.length;){for(var d=fc[b],e=b+1;e<fc.length&&gc>d;)d*=fc[e++];for(d=c.modInt(d);e>b;)if(d%fc[b++]==0)return!1}return c.millerRabin(a)}function Yb(c){var d=this.subtract(a.ONE),e=d.getLowestSetBit();if(0>=e)return!1;var f=d.shiftRight(e);c=c+1>>1,c>fc.length&&(c=fc.length);for(var g=b(),h=0;c>h;++h){g.fromInt(fc[h]);var i=g.modPow(f,this);if(0!=i.compareTo(a.ONE)&&0!=i.compareTo(d)){for(var j=1;j++<e&&0!=i.compareTo(d);)if(i=i.modPowInt(2,this),0==i.compareTo(a.ONE))return!1;if(0!=i.compareTo(d))return!1}}return!0}var Zb,$b=0xdeadbeefcafe,_b=15715070==(16777215&$b);_b&&"Microsoft Internet Explorer"==navigator.appName?(a.prototype.am=d,Zb=30):_b&&"Netscape"!=navigator.appName?(a.prototype.am=c,Zb=26):(a.prototype.am=e,Zb=28),a.prototype.DB=Zb,a.prototype.DM=(1<<Zb)-1,a.prototype.DV=1<<Zb;var ac=52;a.prototype.FV=Math.pow(2,ac),a.prototype.F1=ac-Zb,a.prototype.F2=2*Zb-ac;var bc,cc,dc="0123456789abcdefghijklmnopqrstuvwxyz",ec=new Array;for(bc="0".charCodeAt(0),cc=0;9>=cc;++cc)ec[bc++]=cc;for(bc="a".charCodeAt(0),cc=10;36>cc;++cc)ec[bc++]=cc;for(bc="A".charCodeAt(0),cc=10;36>cc;++cc)ec[bc++]=cc;B.prototype.convert=C,B.prototype.revert=D,B.prototype.reduce=E,B.prototype.mulTo=F,B.prototype.sqrTo=G,I.prototype.convert=J,I.prototype.revert=K,I.prototype.reduce=L,I.prototype.mulTo=N,I.prototype.sqrTo=M,a.prototype.copyTo=h,a.prototype.fromInt=i,a.prototype.fromString=k,a.prototype.clamp=l,a.prototype.dlShiftTo=s,a.prototype.drShiftTo=t,a.prototype.lShiftTo=u,a.prototype.rShiftTo=v,a.prototype.subTo=w,a.prototype.multiplyTo=x,a.prototype.squareTo=y,a.prototype.divRemTo=z,a.prototype.invDigit=H,a.prototype.isEven=O,a.prototype.exp=P,a.prototype.toString=m,a.prototype.negate=n,a.prototype.abs=o,a.prototype.compareTo=p,a.prototype.bitLength=r,a.prototype.mod=A,a.prototype.modPowInt=Q,a.ZERO=j(0),a.ONE=j(1),Gb.prototype.convert=Hb,Gb.prototype.revert=Hb,Gb.prototype.mulTo=Ib,Gb.prototype.sqrTo=Jb,Nb.prototype.convert=Ob,Nb.prototype.revert=Pb,Nb.prototype.reduce=Qb,Nb.prototype.mulTo=Sb,Nb.prototype.sqrTo=Rb;var fc=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],gc=(1<<26)/fc[fc.length-1];return a.prototype.chunkSize=V,a.prototype.toRadix=X,a.prototype.fromRadix=Y,a.prototype.fromNumber=Z,a.prototype.bitwiseTo=cb,a.prototype.changeBit=tb,a.prototype.addTo=xb,a.prototype.dMultiply=Eb,a.prototype.dAddOffset=Fb,a.prototype.multiplyLowerTo=Lb,a.prototype.multiplyUpperTo=Mb,a.prototype.modInt=Vb,a.prototype.millerRabin=Yb,a.prototype.clone=R,a.prototype.intValue=S,a.prototype.byteValue=T,a.prototype.shortValue=U,a.prototype.signum=W,a.prototype.toByteArray=$,a.prototype.equals=_,a.prototype.min=ab,a.prototype.max=bb,a.prototype.and=eb,a.prototype.or=gb,a.prototype.xor=ib,a.prototype.andNot=kb,a.prototype.not=lb,a.prototype.shiftLeft=mb,a.prototype.shiftRight=nb,a.prototype.getLowestSetBit=pb,a.prototype.bitCount=rb,a.prototype.testBit=sb,a.prototype.setBit=ub,a.prototype.clearBit=vb,a.prototype.flipBit=wb,a.prototype.add=yb,a.prototype.subtract=zb,a.prototype.multiply=Ab,a.prototype.divide=Bb,a.prototype.remainder=Cb,a.prototype.divideAndRemainder=Db,a.prototype.modPow=Tb,a.prototype.modInverse=Wb,a.prototype.pow=Kb,a.prototype.gcd=Ub,a.prototype.isProbablePrime=Xb,{BigInteger:a}}();BigInteger=BigInteger.BigInteger,paramikojs.Agent=function(){this.conn=null,this.keys=[];var a=window.Components.classes["@mozilla.org/process/environment;1"].getService(window.Components.interfaces.nsIEnvironment);if(a.exists("SSH_AUTH_SOCK")&&"win32"!=sys.platform){var b=socket.socket(socket.AF_UNIX,socket.SOCK_STREAM),c=a.get("SSH_AUTH_SOCK");try{b.connect(c)}catch(d){return}this.conn=b}else{if("win32"!=sys.platform)return;var e=new paramikojs.win_pageant;if(!e.can_talk_to_agent())return;this.conn=e.PageantConnection()}var f=this._send_message(String.fromCharCode(paramikojs.Agent.SSH2_AGENTC_REQUEST_IDENTITIES));if(f.ptype!=paramikojs.Agent.SSH2_AGENT_IDENTITIES_ANSWER)throw new paramikojs.ssh_exception.SSHException("could not get keys from ssh-agent");for(var g=f.result.get_int(),h=0;g>h;++h)this.keys.push(new paramikojs.AgentKey(this,f.result.get_string())),f.result.get_string()},paramikojs.Agent.SSH2_AGENTC_REQUEST_IDENTITIES=11,paramikojs.Agent.SSH2_AGENT_IDENTITIES_ANSWER=12,paramikojs.Agent.SSH2_AGENTC_SIGN_REQUEST=13,paramikojs.Agent.SSH2_AGENT_SIGN_RESPONSE=14,paramikojs.Agent.prototype={close:function(){this.conn&&this.conn.close(),this.conn=null,this.keys=[]},get_keys:function(){return this.keys},_send_message:function(a){var a=a.toString();this.conn.send(struct.pack(">I",a.length)+a);var b=this._read_all(4);return a=new paramikojs.Message(this._read_all(struct.unpack(">I",b)[0])),{ptype:a.get_byte().charCodeAt(0),result:a}},_read_all:function(a){for(var b=this.conn.recv(a);b.length<a;){if(0==b.length)throw new paramikojs.ssh_exception.SSHException("lost ssh-agent");var c=this.conn.recv(a-b.length);if(0==c.length)throw new paramikojs.ssh_exception.SSHException("lost ssh-agent");b+=c}return b}},paramikojs.AgentKey=function(a,b){inherit(this,new paramikojs.PKey),this.agent=a,this.blob=b,this.name=new paramikojs.Message(b).get_string()},paramikojs.AgentKey.prototype={toString:function(){return this.blob},get_name:function(){return this.name},sign_ssh_data:function(a,b,c){var d=new paramikojs.Message;d.add_byte(String.fromCharCode(paramikojs.Agent.SSH2_AGENTC_SIGN_REQUEST)),d.add_string(this.blob),d.add_string(b),d.add_int(0);var d=this.agent._send_message(d);if(d.ptype!=paramikojs.Agent.SSH2_AGENT_SIGN_RESPONSE)throw new paramikojs.ssh_exception.SSHException("key cannot be used for signing");c(d.result.get_string())}},paramikojs.AuthHandler=function(a){this.transport=a,this.username=null,this.authenticated=!1,this.auth_method="",this.password=null,this.private_key=null,this.interactive_handler=null,this.submethods=null,this.auth_username=null,this.auth_fail_count=0,this.callback=null,this.triedKeyboard=!1,this.triedPublicKey=!1},paramikojs.AuthHandler.prototype={is_authenticated:function(){return this.authenticated},get_username:function(){return this.transport.server_mode?this.auth_username:this.username},auth_none:function(a){this.auth_method="none",this.username=a,this._request_auth()},auth_publickey:function(a,b){this.auth_method="publickey",this.username=a,this.private_key=b,this.triedPublicKey=!0,this._request_auth()},auth_password:function(a,b){this.auth_method="password",this.username=a,this.password=b,this._request_auth()},auth_interactive:function(a,b,c){this.auth_method="keyboard-interactive",this.username=a,this.interactive_handler=b,this.submethods=c||"",this.triedKeyboard=!0,this._request_auth()},abort:function(){},_request_auth:function(){var a=new paramikojs.Message;a.add_byte(String.fromCharCode(paramikojs.MSG_SERVICE_REQUEST)),a.add_string("ssh-userauth"),this.transport._send_message(a)},_disconnect_service_not_available:function(){var a=new paramikojs.Message;a.add_byte(String.fromCharCode(paramikojs.MSG_DISCONNECT)),a.add_int(paramikojs.DISCONNECT_SERVICE_NOT_AVAILABLE),a.add_string("Service not available"),a.add_string("en"),this.transport._send_message(a),this.transport.close()},_disconnect_no_more_auth:function(){var a=new paramikojs.Message;a.add_byte(String.fromCharCode(paramikojs.MSG_DISCONNECT)),a.add_int(paramikojs.DISCONNECT_NO_MORE_AUTH_METHODS_AVAILABLE),a.add_string("No more auth methods available"),a.add_string("en"),this.transport._send_message(a),this.transport.close()},_get_session_blob:function(a,b,c){var d=new paramikojs.Message;return d.add_string(this.transport.session_id),d.add_byte(String.fromCharCode(paramikojs.MSG_USERAUTH_REQUEST)),d.add_string(c),d.add_string(b),d.add_string("publickey"),d.add_boolean(1),d.add_string(a.get_name()),d.add_string(a.toString()),d.toString()},wait_for_response:function(){},_parse_service_request:function(a){var b=a.get_string();if(this.transport.server_mode&&"ssh-userauth"==b){var a=new paramikojs.Message;return a.add_byte(String.fromCharCode(paramikojs.MSG_SERVICE_ACCEPT)),a.add_string(b),void this.transport._send_message(a)}this._disconnect_service_not_available()},_parse_service_accept:function(a){var b=a.get_string();if("ssh-userauth"==b){console.debug("userauth is OK");var a=new paramikojs.Message;if(a.add_byte(String.fromCharCode(paramikojs.MSG_USERAUTH_REQUEST)),a.add_string(this.username),a.add_string("ssh-connection"),a.add_string(this.auth_method),"password"==this.auth_method){a.add_boolean(!1);var c=this.password;try{c=this.transport.toUTF8.convertStringToUTF8(c,"UTF-8",1)}catch(d){console.debug(d)}a.add_string(c)}else{if("publickey"==this.auth_method){a.add_boolean(!0),a.add_string(this.private_key.get_name()),a.add_string(this.private_key.toString());var e=this._get_session_blob(this.private_key,"ssh-connection",this.username),f=this,g=function(b){a.add_string(b.toString()),f.transport._send_message(a)};return void this.private_key.sign_ssh_data(this.transport.rng,e,g)}if("keyboard-interactive"==this.auth_method)a.add_string(""),a.add_string(this.submethods);else if("none"!=this.auth_method)throw new paramikojs.ssh_exception.SSHException('Unknown auth method "'+this.auth_method+'"')}this.transport._send_message(a)}else console.debug('Service request "'+b+'" accepted (?)')},_send_auth_result:function(a,b,c){var d=new paramikojs.Message;c==paramikojs.AUTH_SUCCESSFUL?(console.info("Auth granted ("+b+")."),d.add_byte(String.fromCharCode(paramikojs.MSG_USERAUTH_SUCCESS)),this.authenticated=!0):(console.info("Auth rejected ("+b+")."),d.add_byte(String.fromCharCode(paramikojs.MSG_USERAUTH_FAILURE)),d.add_string(this.transport.server_object.get_allowed_auths(a)),c==paramikojs.AUTH_PARTIALLY_SUCCESSFUL?d.add_boolean(1):(d.add_boolean(0),this.auth_fail_count+=1)),this.transport._send_message(d),this.auth_fail_count>=10&&this._disconnect_no_more_auth(),c==paramikojs.AUTH_SUCCESSFUL&&this.transport._auth_trigger()},_interactive_query:function(a){var b=new paramikojs.Message;b.add_byte(String.fromCharCode(paramikojs.MSG_USERAUTH_INFO_REQUEST)),b.add_string(a.name),b.add_string(a.instructions),b.add_string(""),b.add_int(a.prompts.length);for(var c=0;c<a.prompts.length;++c)b.add_string(a.prompts[c][0]),b.add_boolean(a.prompts[c][1]);this.transport._send_message(b)},_parse_userauth_request:function(a){if(!this.transport.server_mode)return a=new paramikojs.Message,a.add_byte(String.fromCharCode(paramikojs.MSG_USERAUTH_FAILURE)),a.add_string("none"),a.add_boolean(0),void this.transport._send_message(a);if(!this.authenticated){var b=a.get_string(),c=a.get_string(),d=a.get_string();if(console.debug("Auth request (type="+d+") service="+c+", username="+b),"ssh-connection"!=c)return void this._disconnect_service_not_available();if(this.auth_username&&this.auth_username!=b)return console.info("Auth rejected because the client attempted to change username in mid-flight"),void this._disconnect_no_more_auth();this.auth_username=b;var e;if("none"==d)e=this.transport.server_object.check_auth_none(b);else if("password"==d){var f=a.get_boolean(),g=a.get_string();if(g=this.transport.fromUTF8.ConvertFromUnicode(g)+this.transport.fromUTF8.Finish(),f){console.debug("Auth request to change passwords (rejected)");var h=a.get_string();h=this.transport.fromUTF8.ConvertFromUnicode(h)+this.transport.fromUTF8.Finish(),e=paramikojs.AUTH_FAILED}else e=this.transport.server_object.check_auth_password(b,g)}else if("publickey"==d){var i=a.get_boolean(),j=a.get_string(),k=a.get_string();try{key=this.transport._key_info[j](new paramikojs.Message(k))}catch(l){console.info("Auth rejected: public key: "+l.toString()),key=null}if(!key)return void this._disconnect_no_more_auth();if(e=this.transport.server_object.check_auth_publickey(b,key),e!=paramikojs.AUTH_FAILED){if(!i)return a=new paramikojs.Message,a.add_byte(String.fromCharCode(paramikojs.MSG_USERAUTH_PK_OK)),a.add_string(j),a.add_string(k),void this.transport._send_message(a);var m=new paramikojs.Message(a.get_string()),n=this._get_session_blob(key,c,b);key.verify_ssh_sig(n,m)||(console.info("Auth rejected: invalid signature"),e=paramikojs.AUTH_FAILED)}}else if("keyboard-interactive"==d){var o=(a.get_string(),a.get_string());if(e=this.transport.server_object.check_auth_interactive(b,o),e instanceof paramikojs.InteractiveQuery)return void this._interactive_query(e)}else e=this.transport.server_object.check_auth_none(b);this._send_auth_result(b,d,e)}},_parse_userauth_success:function(){console.info("Authentication ("+this.auth_method+") successful!"),this.authenticated=!0,this.transport._auth_trigger(),this.transport.auth_callback(!0)},_parse_userauth_failure:function(a){var b=a.get_list(),c=a.get_boolean(),d=null;c?(console.info("Authentication continues..."),console.debug("Methods: "+b.toString()),d=b):-1==b.indexOf(this.auth_method)?(console.debug("Authentication type ("+this.auth_method+") not permitted."),console.debug("Allowed methods: "+b.toString()),d=b):console.info("Authentication ("+this.auth_method+") failed."),this.authenticated=!1,this.username=null,this.transport.auth_callback(!1,b,this.triedKeyboard,this.triedPublicKey)},_parse_userauth_banner:function(a){{var b=a.get_string();a.get_string()}console.info("Auth banner: "+b)},_parse_userauth_info_request:function(a){if("keyboard-interactive"!=this.auth_method)throw new paramikojs.ssh_exception.SSHException("Illegal info request from server");var b=a.get_string(),c=a.get_string();a.get_string();for(var d=a.get_int(),e=[],f=0;d>f;++f)e.push([a.get_string(),a.get_boolean()]);var g=this.interactive_handler(b,c,e);a=new paramikojs.Message,a.add_byte(String.fromCharCode(paramikojs.MSG_USERAUTH_INFO_RESPONSE)),a.add_int(g.length);for(var f=0;f<g.length;++f)a.add_string(g[f]);this.transport._send_message(a)},_parse_userauth_info_response:function(a){if(!this.transport.server_mode)throw new paramikojs.ssh_exception.SSHException("Illegal info response from server");for(var b=a.get_int(),c=[],d=0;b>d;++d)c.append(a.get_string());var e=this.transport.server_object.check_auth_interactive_response(c);return e instanceof paramikojs.InteractiveQuery?void this._interactive_query(e):void this._send_auth_result(this.auth_username,"keyboard-interactive",e)},_handler_table:{5:function(a,b){a._parse_service_request(b)},6:function(a,b){a._parse_service_accept(b)},50:function(a,b){a._parse_userauth_request(b)},51:function(a,b){a._parse_userauth_failure(b)},52:function(a,b){a._parse_userauth_success(b)},53:function(a,b){a._parse_userauth_banner(b)},60:function(a,b){a._parse_userauth_info_request(b)},61:function(a,b){a._parse_userauth_info_response(b)}}},paramikojs.BER=function(a){this.content=a,this.idx=0},paramikojs.BER.prototype={toString:function(){return this.content},decode:function(){return this.decode_next()},decode_next:function(){if(this.idx>=this.content.length)return null;var a,b=this.content[this.idx].charCodeAt(0);if(this.idx+=1,31==(31&b))for(b=0;this.idx<this.content.length&&(a=this.content[this.idx].charCodeAt(0),this.idx+=1,b=b<<7|127&a,128&a););if(this.idx>=this.content.length)return null;var c=this.content[this.idx].charCodeAt(0);if(this.idx+=1,128&c){if(a=127&c,this.idx+a>this.content.length)return null;c=paramikojs.util.inflate_long(this.content.substring(this.idx,this.idx+a),!0).intValue(),this.idx+=a}if(this.idx+c>this.content.length)return null;var d=this.content.substring(this.idx,this.idx+c);if(this.idx+=c,48==b)return this.decode_sequence(d);if(2==b)return paramikojs.util.inflate_long(d);throw new paramikojs.ssh_exception.BERException("Unknown ber encoding type "+b+" (robey is lazy)")},decode_sequence:function(a){for(var b=[],c=new paramikojs.BER(a);;){var d=c.decode_next();if(!d)break;b.push(d)}return b},encode_tlv:function(a,b){if(this.content+=String.fromCharCode(a),b.length>127){var c=paramikojs.util.deflate_long(b.length);this.content+=String.fromCharCode(128+c.length)+c}else this.content+=String.fromCharCode(b.length);this.content+=b},encode:function(a){if("boolean"==typeof a)a?this.encode_tlv(1,"ÿ"):this.encode_tlv(1,"\x00");else if("number"==typeof a)this.encode_tlv(2,paramikojs.util.deflate_long(a));else if("string"==typeof a)this.encode_tlv(4,a);else{if(!(a instanceof Array))throw new paramikojs.ssh_exception.BERException("Unknown type for encoding: "+typeof a);this.encode_tlv(48,this.encode_sequence(a))}},encode_sequence:function(a){for(var b=new paramikojs.BER,c=0;c<a.length;++c)b.encode(a[c]);return str(b)}},paramikojs.Channel=function(a){this.chanid=a,this.remote_chanid=0,this.transport=null,this.active=!1,this.eof_received=0,this.eof_sent=0,this.in_buffer="",this.in_stderr_buffer="",this.timeout=null,this.closed=!1,this.ultra_debug=!1,this.in_window_size=0,this.out_window_size=0,this.in_max_packet_size=0,this.out_max_packet_size=0,this.in_window_threshold=0,this.in_window_sofar=0,this._name=a.toString(),this._pipe=null,this.event_ready=!1,this.combine_stderr=!1,this.exit_status=-1,this.origin_addr=null},paramikojs.Channel.MIN_PACKET_SIZE=1024,paramikojs.Channel.prototype={get_pty:function(a,b,c){if(this.closed||this.eof_received||this.eof_sent||!this.active)throw new paramikojs.ssh_exception.SSHException("Channel is not open");var d=new paramikojs.Message;d.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_REQUEST)),d.add_int(this.remote_chanid),d.add_string("pty-req"),d.add_boolean(!0),d.add_string(a||"vt100"),d.add_int(b||80),d.add_int(c||24),d.add_int(0).add_int(0),d.add_string(""),this.transport._send_user_message(d)},invoke_shell:function(){if(this.closed||this.eof_received||this.eof_sent||!this.active)throw new paramikojs.ssh_exception.SSHException("Channel is not open");var a=new paramikojs.Message;a.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_REQUEST)),a.add_int(this.remote_chanid),a.add_string("shell"),a.add_boolean(1),this.transport._send_user_message(a)},exec_command:function(a){if(this.closed||this.eof_received||this.eof_sent||!this.active)throw new paramikojs.ssh_exception.SSHException("Channel is not open");var b=new paramikojs.Message;b.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_REQUEST)),b.add_int(this.remote_chanid),b.add_string("exec"),b.add_boolean(!0),b.add_string(a),this.transport._send_user_message(b)},invoke_subsystem:function(a){if(this.closed||this.eof_received||this.eof_sent||!this.active)throw new paramikojs.ssh_exception.SSHException("Channel is not open");var b=new paramikojs.Message;b.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_REQUEST)),b.add_int(this.remote_chanid),b.add_string("subsystem"),b.add_boolean(!0),b.add_string(a),this.transport._send_user_message(b)},resize_pty:function(a,b){if(this.closed||this.eof_received||this.eof_sent||!this.active)throw new paramikojs.ssh_exception.SSHException("Channel is not open");var c=new paramikojs.Message;c.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_REQUEST)),c.add_int(this.remote_chanid),c.add_string("window-change"),c.add_boolean(!0),c.add_int(a||80),c.add_int(b||24),c.add_int(0).add_int(0),this.transport._send_user_message(c)},exit_status_ready:function(){return this.closed},recv_exit_status:function(){return this.exit_status},send_exit_status:function(a){var b=new paramikojs.Message;b.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_REQUEST)),b.add_int(this.remote_chanid),b.add_string("exit-status"),b.add_boolean(!1),b.add_int(a),this.transport._send_user_message(b)},request_x11:function(a,b,c,d,e){if(this.closed||this.eof_received||this.eof_sent||!this.active)throw new paramikojs.ssh_exception.SSHException("Channel is not open");b||(b="MIT-MAGIC-COOKIE-1"),c||(c=binascii.hexlify(this.transport.rng.read(16)));var f=new paramikojs.Message;return f.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_REQUEST)),f.add_int(this.remote_chanid),f.add_string("x11-req"),f.add_boolean(!0),f.add_boolean(d),f.add_string(b),f.add_string(c),f.add_int(a||0),this.transport._send_user_message(f),this.transport._set_x11_handler(e),c},get_transport:function(){return this.transport},set_name:function(a){this._name=a},get_name:function(){return this._name},get_id:function(){return this.chanid},set_combine_stderr:function(a){var b="",c=this.combine_stderr;return this.combine_stderr=a,a&&!c&&(b=this.in_stderr_buffer,this.in_stderr_buffer=""),b.length>0&&this._feed(b),c},settimeout:function(a){this.timeout=a},gettimeout:function(){return this.timeout},setblocking:function(a){this.settimeout(a?null:0)},getpeername:function(){return this.transport.getpeername()},close:function(){if(this._pipe&&(this._pipe.close(),this._pipe=null),this.active&&!this.closed)for(var a=this._close_internal(),b=0;b<a.length;++b)a[b]&&this.transport._send_user_message(a[b])},recv_ready:function(){return 0!=this.in_buffer.length},recv:function(a){if(!this.in_buffer.length)throw new paramikojs.ssh_exception.WaitException("wait");var b=this.in_buffer.substring(0,a);this.in_buffer=this.in_buffer.substring(a);var c=this._check_add_window(b.length);if(c>0){var d=new paramikojs.Message;d.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_WINDOW_ADJUST)),d.add_int(this.remote_chanid),d.add_int(c),this.transport._send_user_message(d)}return b},recv_stderr_ready:function(){return!0},recv_stderr:function(a){if(!this.in_stderr_buffer.length)throw new paramikojs.ssh_exception.WaitException("wait");var b=this.in_stderr_buffer.substring(0,a);this.in_stderr_buffer=this.in_stderr_buffer.substring(a);var c=this._check_add_window(b.length);if(c>0){var d=new paramikojs.Message;d.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_WINDOW_ADJUST)),d.add_int(this.remote_chanid),d.add_int(c),this.transport._send_user_message(d)}return b},send_ready:function(){return this.closed||this.eof_sent?!0:this.out_window_size>0},send:function(a){var b=a.length;if(b=this._wait_for_send_window(b),0==b)return 0;var c=new paramikojs.Message;return c.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_DATA)),c.add_int(this.remote_chanid),c.add_string(a.substring(0,b)),this.transport._send_user_message(c),b},send_stderr:function(a){var b=a.length;if(b=this._wait_for_send_window(b),0==b)return 0;var c=new paramikojs.Message;return c.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_EXTENDED_DATA)),c.add_int(this.remote_chanid),c.add_int(1),c.add_string(a.substring(0,b)),this.transport._send_user_message(c),b},sendall:function(a){for(;a;){if(this.closed)throw"Socket is closed";var b=this.send(a);a=a.substring(b)}return null},sendall_stderr:function(a){for(;a;){if(this.closed)throw"Socket is closed";sent=this.send_stderr(a),a=a.substring(sent)}return null},makefile:function(){return paramikojs.ChannelFile([this]+arguments)},makefile_stderr:function(){return paramikojs.ChannelStderrFile([this]+arguments)},shutdown:function(a){if((0==a||2==a)&&(this.eof_received=1),1==a||2==a){var b=this._send_eof();b&&this.transport._send_user_message(b)}},shutdown_read:function(){this.shutdown(0)},shutdown_write:function(){this.shutdown(1)},_set_transport:function(a){this.transport=a},_set_window:function(a,b){this.in_window_size=a,this.in_max_packet_size=b,this.in_window_threshold=parseInt(a/10),this.in_window_sofar=0,console.debug("Max packet in: "+b+" bytes")},_set_remote_channel:function(a,b,c){this.remote_chanid=a,this.out_window_size=b,this.out_max_packet_size=Math.max(c,paramikojs.Channel.MIN_PACKET_SIZE),this.active=1,console.debug("Max packet out: "+c+" bytes")},_request_success:function(){console.debug("Sesch channel "+this.chanid+" request ok")},_request_failed:function(){for(var a=this._close_internal(),b=0;b<a.length;++b)a[b]&&this.transport._send_user_message(a[b])},_feed:function(a){var b;b="string"==typeof a?a:a.get_string(),this.in_buffer+=b},_feed_extended:function(a){var b=a.get_int(),c=a.get_string();return 1!=b?void console.error("unknown extended_data type "+b+"; discarding"):void(this.combine_stderr?this._feed(c):this.in_stderr_buffer+=c)},_window_adjust:function(a){var b=a.get_int();this.ultra_debug&&console.debug("window up "+b),this.out_window_size+=b},_handle_request:function(a){var b=a.get_string(),c=a.get_boolean(),d=this.transport.server_object,e=!1;if("exit-status"==b)this.exit_status=a.get_int(),e=!0;else if("xon-xoff"==b)e=!0;else if("pty-req"==b){var f=a.get_string(),g=a.get_int(),h=a.get_int(),i=a.get_int(),j=a.get_int(),k=a.get_string();e=d?d.check_channel_pty_request(this,f,g,h,i,j,k):!1}else if("shell"==b)e=d?d.check_channel_shell_request(this):!1;else if("exec"==b){var l=a.get_string();e=d?d.check_channel_exec_request(this,l):!1}else if("subsystem"==b){var m=a.get_string();e=d?d.check_channel_subsystem_request(this,m):!1}else if("window-change"==b){var g=a.get_int(),h=a.get_int(),i=a.get_int(),j=a.get_int();e=d?d.check_channel_window_change_request(this,g,h,i,j):!1}else if("x11-req"==b){var n=a.get_boolean(),o=a.get_string(),p=a.get_string(),q=a.get_int();e=d?d.check_channel_x11_request(this,n,o,p,q):!1}else console.debug('Unhandled channel request "'+b+'"'),e=!1;if(c){var a=new paramikojs.Message;a.add_byte(e?String.fromCharCode(paramikojs.MSG_CHANNEL_SUCCESS):String.fromCharCode(paramikojs.MSG_CHANNEL_FAILURE)),a.add_int(this.remote_chanid),this.transport._send_user_message(a)}},_handle_eof:function(){this.eof_received||(this.eof_received=!0,this.in_buffer="",this.in_stderr_buffer="",this._pipe&&this._pipe.set_forever()),console.debug("EOF received ("+this._name+")")},_handle_close:function(){var a=this._close_internal();this.transport._unlink_channel(this.chanid);for(var b=0;b<a.length;++b)a[b]&&this.transport._send_user_message(a[b])},_set_closed:function(){this.closed=!0,this.in_buffer="",this.in_stderr_buffer=""},_send_eof:function(){if(this.eof_sent)return null;var a=new paramikojs.Message;return a.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_EOF)),a.add_int(this.remote_chanid),this.eof_sent=!0,console.debug("EOF sent ("+this._name+")"),a},_close_internal:function(){if(!this.active||this.closed)return[null,null];var a=this._send_eof(),b=new paramikojs.Message;return b.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_CLOSE)),b.add_int(this.remote_chanid),this._set_closed(),[a,b]},_unlink:function(){this.closed||(this._set_closed(),this.transport._unlink_channel(this.chanid))},_check_add_window:function(a){if(this.closed||this.eof_received||!this.active)return 0;if(this.ultra_debug&&console.debug("addwindow "+a),this.in_window_sofar+=a,this.in_window_sofar<=this.in_window_threshold)return 0;this.ultra_debug&&console.debug("addwindow send "+this.in_window_sofar);var b=this.in_window_sofar;return this.in_window_sofar=0,b},_wait_for_send_window:function(a){if(this.closed||this.eof_sent)return 0;if(0==this.out_window_size)throw new paramikojs.ssh_exception.WaitException("wait");return this.closed||this.eof_sent?0:(this.out_window_size<a&&(a=this.out_window_size),this.out_max_packet_size-64<a&&(a=this.out_max_packet_size-64),this.out_window_size-=a,this.ultra_debug&&console.debug("window down to "+this.out_window_size),a)}},paramikojs.ChannelFile=function(a,b,c){inherit(this,new paramikojs.BufferedFile),b=b||"r",c=c||-1,this.channel=a,this._set_mode(b,c)},paramikojs.ChannelFile.prototype={_read:function(a){return this.channel.recv(a)},_write:function(a){return this.channel.sendall(a),a.length}},paramikojs.ChannelStderrFile=function(a,b,c){b=b||"r",c=c||-1,inherit(this,new paramikojs.ChannelFile(a,b,c))},paramikojs.ChannelStderrFile.prototype={_read:function(a){return this.channel.recv_stderr(a)},_write:function(a){return this.channel.sendall_stderr(a),a.length}},paramikojs.AutoAddPolicy=function(){},paramikojs.AutoAddPolicy.prototype={missing_host_key:function(a,b,c,d){a._host_keys.add(b,c.get_name(),c),a._host_keys_filename&&a.save_host_keys(a._host_keys_filename),console.debug("Adding "+c.get_name()+" host key for "+b+": "+paramikojs.util.hexify(c.get_fingerprint())),d(!0)}},paramikojs.AskPolicy=function(){},paramikojs.AskPolicy.prototype={missing_host_key:function(a,b,c,d){for(var e=paramikojs.util.hexify(c.get_fingerprint()).toLowerCase(),f="",g=0;g<e.length;g+=2)f+=e[g]+e[g+1]+":";f=f.substring(0,f.length-1)}},paramikojs.RejectPolicy=function(){},paramikojs.RejectPolicy.prototype={missing_host_key:function(a,b,c,d){console.debug("Rejecting "+c.get_name()+" host key for "+b+": "+paramikojs.util.hexify(c.get_fingerprint())),d(!1)
}},paramikojs.WarningPolicy=function(){},paramikojs.WarningPolicy.prototype={missing_host_key:function(a,b,c,d){console.debug("Unknown "+c.get_name()+" host key for "+b+": "+paramikojs.util.hexify(c.get_fingerprint())),d(!0)}},paramikojs.SSHClient=function(){this._system_host_keys=new paramikojs.HostKeys,this._host_keys=new paramikojs.HostKeys,this._host_keys_filename=null,this._log_channel=null,this._policy=new paramikojs.RejectPolicy,this._transport=null,this._agent=null},paramikojs.SSHClient.prototype={SSH_PORT:22,load_system_host_keys:function(a){return a?void this._system_host_keys.load(a):void this._system_host_keys.load("~/.ssh/known_hosts")},load_host_keys:function(a){this._host_keys_filename=a,this._host_keys.load(a)},save_host_keys:function(a){this._host_keys.save(a)},get_host_keys:function(){return this._host_keys},set_missing_host_key_policy:function(a){this._policy=a},connect:function(a,b,c,d,e,f,g,h,i,j,k,l){d=d||this.SSH_PORT,j=void 0==j?!0:j,k=void 0==k?!0:k;var m=this,n=function(){var a,b,i=m._transport.get_remote_server_key(),l=i.get_name();a=d==m.SSH_PORT?c:"["+c+"]:"+d,m._system_host_keys._entries.length&&(b=m._system_host_keys.get(a)[l]),!b&&m._host_keys._entries.length&&(b=m._host_keys.get(a)[l]);var n=function(a){if(!a)return void m.close(!0);var b;b=h?"string"==typeof h?[h]:h:[],m._auth(e,f,g,b,j,k)};b?i.compare(b)?n(!0):m._policy.missing_host_key(m,a,i,n):(m._policy.missing_host_key(m,a,i,n),b=i)};return this._transport=new paramikojs.transport,this._transport.writeCallback=a,this._transport.use_compression(l),this._transport.connect(null,n,e,f,g,b),this._transport},close:function(a){this._transport&&(this.legitClose=a,this._transport.close(),this._transport=null,this._agent&&(this._agent.close(),this._agent=null))},exec_command:function(a,b){b=b||-1;var c=function(){d.exec_command(a);var c=d.makefile("wb",b),e=d.makefile("rb",b),f=d.makefile_stderr("rb",b);return[c,e,f]},d=this._transport.open_session(c)},invoke_shell:function(a,b,c,d){a=a||"vt100",b=b||80,c=c||24;var e=function(e){e.get_pty(a,b,c),e.invoke_shell(),d(e)};this._transport.open_session(e)},open_sftp:function(a){this._transport.open_sftp_client(a)},get_transport:function(){return this._transport},_auth:function(a,b,c,d,e,f){var g,h=null;if(c)try{return console.debug("Trying SSH key "+paramikojs.util.hexify(c.get_fingerprint())),void this._transport.auth_publickey(a,c)}catch(i){h=i}for(var j=0;j<d.length;++j)for(var k=0;2>k;++k)try{var l=[paramikojs.RSAKey,paramikojs.DSSKey][k];return g=new l(null,null,d[j],b),console.debug("Trying key "+paramikojs.util.hexify(g.get_fingerprint())+" from "+d[j]),void this._transport.auth_publickey(a,g)}catch(i){console.debug("Tried key: "+i.message),h=i}var m=[];f||(m=[]);for(var k=0;k<m.length;++k)try{return g=new m[k][0](null,null,m[k][1].path,b),console.debug("Trying discovered key "+paramikojs.util.hexify(g.get_fingerprint())+" in "+m[k][1].path),void this._transport.auth_publickey(a,g)}catch(i){h=i}try{return void this._transport.auth_password(a,b)}catch(i){h=i}if(h)throw h;throw new paramikojs.ssh_exception.AuthenticationException("No authentication methods available")}},paramikojs.ZlibCompressor=function(){},paramikojs.ZlibCompressor.prototype={},paramikojs.ZlibDecompressor=function(){},paramikojs.ZlibDecompressor.prototype={},paramikojs.DSSKey=function(a,b,c,d,e,f){if(inherit(this,new paramikojs.PKey),this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,f)return void this._from_private_key(f,d);if(c)return void this._from_private_key_file(c,d);if(!a&&b&&(a=new paramikojs.Message(b)),e)this.p=e[0],this.q=e[1],this.g=e[2],this.y=e[3];else{if(!a)throw new paramikojs.ssh_exception.SSHException("Key object may not be empty");if("ssh-dss"!=a.get_string())throw new paramikojs.ssh_exception.SSHException("Invalid key");this.p=a.get_mpint(),this.q=a.get_mpint(),this.g=a.get_mpint(),this.y=a.get_mpint()}this.size=paramikojs.util.bit_length(this.p)},paramikojs.DSSKey.prototype={toString:function(){var a=new paramikojs.Message;return a.add_string("ssh-dss"),a.add_mpint(this.p),a.add_mpint(this.q),a.add_mpint(this.g),a.add_mpint(this.y),a.toString()},compare:function(a){return this.get_name()!=a.get_name()?!1:this.p.equals(a.p)&&this.q.equals(a.q)&&this.g.equals(a.g)&&this.y.equals(a.y)?!0:!1},get_name:function(){return"ssh-dss"},get_bits:function(){return this.size},can_sign:function(){return null!=this.x},sign_ssh_data:function(a,b,c){for(var d,e=new kryptos.hash.SHA(b).digest(),f=(new kryptos.publicKey.DSA).construct(this.y,this.g,this.p,this.q,this.x),g=paramikojs.util.deflate_long(this.q,0).length,h=new BigInteger("2",10);;)if(d=paramikojs.util.inflate_long(a.read(g),1),d.compareTo(h)>0&&this.q.compareTo(d)>0)break;var i=f.sign(paramikojs.util.inflate_long(e,1),d),j=new paramikojs.Message;j.add_string("ssh-dss");var k=paramikojs.util.deflate_long(i[0],0),l=paramikojs.util.deflate_long(i[1],0);k.length<20&&(k=new Array(20-k.length+1).join("\x00")+k),l.length<20&&(l=new Array(20-k.length+1).join("\x00")+l),j.add_string(k+l),c(j)},verify_ssh_sig:function(a,b){var c,d;if(40==b.toString().length)c=b.toString();else{if(d=b.get_string(),"ssh-dss"!=d)return 0;c=b.get_string()}var e=paramikojs.util.inflate_long(c.substring(0,20),1),f=paramikojs.util.inflate_long(c.substring(20),1),g=paramikojs.util.inflate_long(new kryptos.hash.SHA(a).digest(),1),h=(new kryptos.publicKey.DSA).construct(this.y,this.g,this.p,this.q);return h.verify(g,[e,f])},_encode_key:function(){if(!this.x)throw new paramikojs.ssh_exception.SSHException("Not enough key information");var a,b=[0,this.p,this.q,this.g,this.y,this.x];try{a=new paramikojs.BER,a.encode(b)}catch(c){throw new paramikojs.ssh_exception.SSHException("Unable to create ber encoding of key")}return a.toString()},write_private_key_file:function(a,b){this._write_private_key_file("DSA",a,this._encode_key(),b)},write_private_key:function(a,b){this._write_private_key("DSA",a,this._encode_key(),b)},generate:function(a,b){a=a||1024;var c=(new kryptos.publicKey.DSA).generate(a,paramikojs.rng.read,b),d=new paramikojs.DSSKey(null,null,null,null,[c.p,c.q,c.g,c.y],null);return d.x=c.x,d},_from_private_key_file:function(a,b){var c,d=null;try{c=this._read_private_key_file("DSA",a,b)}catch(e){if(!(e instanceof paramikojs.ssh_exception.IsPuttyKey))throw e;c=null,d=this._read_putty_private_key("DSA",e.lines,b)}this._decode_key(c,d)},_from_private_key:function(a,b){var c=this._read_private_key("DSA",a,b);this._decode_key(c)},_decode_key:function(a,b){try{b=b||new paramikojs.BER(a).decode()}catch(c){throw new paramikojs.ssh_exception.SSHException("Unable to parse key file")}if(!(b instanceof Array)||b.length<6||0!=b[0])throw new paramikojs.ssh_exception.SSHException("not a valid DSA private key file (bad ber encoding)");this.p=b[1],this.q=b[2],this.g=b[3],this.y=b[4],this.x=b[5],this.size=paramikojs.util.bit_length(this.p)}},paramikojs.BufferedFile=function(){this.newlines=null,this._flags=0,this._bufsize=this._DEFAULT_BUFSIZE,this._wbuffer="",this._rbuffer="",this._at_trailing_cr=!1,this._closed=!1,this._pos=this._realpos=0,this._size=0},paramikojs.BufferedFile.prototype={_DEFAULT_BUFSIZE:8192,SEEK_SET:0,SEEK_CUR:1,SEEK_END:2,FLAG_READ:1,FLAG_WRITE:2,FLAG_APPEND:4,FLAG_BINARY:16,FLAG_BUFFERED:32,FLAG_LINE_BUFFERED:64,FLAG_UNIVERSAL_NEWLINE:128,__close:function(){this.flush(),this._closed=!0},close:function(){this.__close()},flush:function(a){this._write_all(this._wbuffer,a),this._wbuffer=""},next:function(){var a=this.readline();if(!a)throw StopIteration;return a},read:function(a,b){if(this._closed)throw new paramikojs.ssh_exception.IOError("File is closed");if(!(this._flags&this.FLAG_READ))throw new paramikojs.ssh_exception.IOError("File is not open for reading");var c;return!a||0>a?(c=this._rbuffer,this._rbuffer="",this._pos+=c.length,void this.read_all(b,c)):a<=this._rbuffer.length?(c=this._rbuffer.substring(0,a),this._rbuffer=this._rbuffer.substring(a),this._pos+=c.length,void b(c)):void this.read_some(b,a)},read_all:function(a,b){var c=this,d=function(d,e){return e&&(d=null),d&&0!=d.length?(b+=d,c._realpos+=d.length,c._pos+=d.length,void c.read_all(a,b)):void a(b)};this._read(this._DEFAULT_BUFSIZE,d)},read_some:function(a,b){var c=this,d=function(d,e){return e&&(d=null),d&&0!=d.length?(c._rbuffer+=d,c._realpos+=d.length,void c.read_some(a,b)):void c.read_finish(a,b)};if(this._rbuffer.length<b){var e=b-this._rbuffer.length;return this._flags&this.FLAG_BUFFERED&&(e=Math.max(this._bufsize,e)),void this._read(e,d)}this.read_finish(a,b)},read_finish:function(a,b){var c=this._rbuffer.substring(0,b);this._rbuffer=this._rbuffer.substring(b),this._pos+=c.length,a(c)},readline:function(){},readlines:function(){},seek:function(){throw new paramikojs.ssh_exception.IOError("File does not support seeking.")},tell:function(){return this._pos},write:function(a,b){if(this._closed)throw new paramikojs.ssh_exception.IOError("File is closed");if(!(this._flags&this.FLAG_WRITE))throw new paramikojs.ssh_exception.IOError("File not open for writing");if(!(this._flags&this.FLAG_BUFFERED))return void this._write_all(a,b);if(this._wbuffer+=a,this._flags&this.FLAG_LINE_BUFFERED){var c=a.lastIndexOf("\n");if(c>=0){var d=this._wbuffer;c+=d.length-a.length,this._write_all(d.substring(0,c+1),b),this._wbuffer="",this._wbuffer+=d.substring(c+1)}}else this._wbuffer.length>=this._bufsize&&this.flush(b)},writelines:function(a){for(var b=0;b<a.length;++b)this.write(a[b])},xreadlines:function(){return this},_read:function(){throw new paramikojs.ssh_exception.EOFError},_write:function(){throw new paramikojs.ssh_exception.IOError("write not implemented")},_get_size:function(){return 0},_set_mode:function(a,b){a=a||"r",b=b||-1,this._bufsize=this._DEFAULT_BUFSIZE,0>b&&(b=0),1==b?this._flags|=this.FLAG_BUFFERED|this.FLAG_LINE_BUFFERED:b>1?(this._bufsize=b,this._flags|=this.FLAG_BUFFERED,this._flags&=~this.FLAG_LINE_BUFFERED):0==b&&(this._flags&=~(this.FLAG_BUFFERED|this.FLAG_LINE_BUFFERED)),(-1!=a.indexOf("r")||-1!=a.indexOf("+"))&&(this._flags|=this.FLAG_READ),(-1!=a.indexOf("w")||-1!=a.indexOf("+"))&&(this._flags|=this.FLAG_WRITE),-1!=a.indexOf("a")&&(this._flags|=this.FLAG_WRITE|this.FLAG_APPEND,this._size=this._get_size(),this._pos=this._realpos=this._size),-1!=a.indexOf("b")&&(this._flags|=this.FLAG_BINARY),-1!=a.indexOf("U")&&(this._flags|=this.FLAG_UNIVERSAL_NEWLINE,this.newlines=null)},_write_all:function(a,b){for(;a.length>0;){var c=this._write(a,b,a.length);a=a.substring(c),this._flags&this.FLAG_APPEND?(this._size+=c,this._pos=this._realpos=this._size):(this._pos+=c,this._realpos+=c)}return null},_record_newline:function(){}},paramikojs.HostKeyEntry=function(a,b){this.valid=a&&b,this.hostnames=a,this.key=b},paramikojs.HostKeyEntry.prototype={from_line:function(a){var b=a.split(" ");if(b.length<3)return null;b=b.slice(0,3);var c=b[0],d=b[1],e=b[2];return c=c.split(","),e="ssh-rsa"==d?new paramikojs.RSAKey(null,base64.decodestring(e)):"ssh-dss"==d?new paramikojs.DSSKey(null,base64.decodestring(e)):new paramikojs.UnknownKey(d,base64.decodestring(e)),new paramikojs.HostKeyEntry(c,e)},to_line:function(){return this.valid?this.hostnames.join(",")+" "+this.key.get_name()+" "+this.key.get_base64()+"\n":null}},paramikojs.HostKeys=function(a){this._entries=[],a&&this.load(a)},paramikojs.HostKeys.prototype={add:function(a,b,c){for(var d=0;d<this._entries.length;++d)if(-1!=this._entries[d].hostnames.indexOf(a)&&this._entries[d].key.get_name()==b)return void(this._entries[d].key=c);this._entries.push(new paramikojs.HostKeyEntry([a],c))},load:function(a){if(window.Components){var b=localFile.init(a);if(!b.exists())return void(this._entries=[]);var c=window.Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(window.Components.interfaces.nsIFileInputStream);c.init(b,-1,0,0);var d="UTF-8",e=window.Components.classes["@mozilla.org/intl/converter-input-stream;1"].createInstance(window.Components.interfaces.nsIConverterInputStream);e.init(c,d,1024,65533),e.QueryInterface(window.Components.interfaces.nsIUnicharLineInputStream),this.loadHelper(e)}else if(chrome.storage){var f=this;chrome.storage.local.get("host_keys",function(a){e=a.host_keys||"",f.loadHelper(e)})}else{var e=window.localStorage.host_keys;e=e||"",this.loadHelper(e)}},loadHelper:function(a){var b,c={};do if(c={},window.Components?(b=a.readLine(c),c=c.value.trim()):(c=a.substring(0,a.indexOf("\n")),a=a.substring(c.length+1),c=c.trim(),b=c.length),c.length&&"#"!=c[0]){var d=(new paramikojs.HostKeyEntry).from_line(c);d&&this._entries.push(d)}while(b);window.Components&&a.close()},save:function(a){if(window.Components){var b=localFile.init(a),c=window.Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(window.Components.interfaces.nsIFileOutputStream);c.init(b,42,420,0);var d=window.Components.classes["@mozilla.org/intl/converter-output-stream;1"].createInstance(window.Components.interfaces.nsIConverterOutputStream);d.init(c,"UTF-8",0,0)}for(var e="",f=0;f<this._entries.length;++f){var g=this._entries[f].to_line();g&&(e+=g)}window.Components?(d.writeString(e),d.close()):chrome.storage?chrome.storage.local.set({host_keys:e}):window.localStorage.host_keys=e},lookup:function(a){for(var b={},c=0;c<this._entries.length;++c)for(var d=0;d<this._entries[c].hostnames.length;++d){var e=this._entries[c].hostnames[d];(0==e.indexOf("|1|")&&this.hash_host(a,e)==e||e==a)&&(b[this._entries[c].key.get_name()]=this._entries[c].key)}return b},get:function(a){return this.lookup(a)},check:function(a,b){var c=this.lookup(a);if(!c)return!1;var d=c.get(b.get_name(),null);return d?d.toString()==b.toString():!1},clear:function(){this._entries=[]},keys:function(){for(var a=[],b=0;b<this._entries.length;++b)for(var c=0;c<this._entries[b].hostnames.length;++c){var d=this._entries[b].hostnames[c];-1==a.indexOf(d)&&a.push(d)}return a},values:function(){for(var a,b=[],c=this.keys();a<c.length;++a)b.push(this.lookup(c[a]));return b},hash_host:function(a,b){b?(0==b.indexOf("|1|")&&(b=b.split("|")[2]),b=base64.decodestring(b)):b=paramikojs.rng.read(kryptos.hash.SHA.digest_size);var c=kryptos.hash.HMAC(b,a,kryptos.hash.HMAC_SHA),d="|1|"+base64.encodestring(b)+"|"+base64.encodestring(c);return d.replace("\n","")}},paramikojs.KexGex=function(a){this.transport=a,this.p=null,this.q=null,this.g=null,this.x=null,this.e=null,this.f=null,this.old_style=!1,this.hash_algo=kryptos.hash.SHA},paramikojs.KexGex._MSG_KEXDH_GEX_REQUEST_OLD=30,paramikojs.KexGex._MSG_KEXDH_GEX_GROUP=31,paramikojs.KexGex._MSG_KEXDH_GEX_INIT=32,paramikojs.KexGex._MSG_KEXDH_GEX_REPLY=33,paramikojs.KexGex._MSG_KEXDH_GEX_REQUEST=34,paramikojs.KexGex.prototype={name:"diffie-hellman-group-exchange-sha1",min_bits:1024,max_bits:8192,preferred_bits:2048,start_kex:function(a){if(this.transport.server_mode)return void this.transport._expect_packet(paramikojs.KexGex._MSG_KEXDH_GEX_REQUEST,paramikojs.KexGex._MSG_KEXDH_GEX_REQUEST_OLD);var b=new paramikojs.Message;a?(b.add_byte(String.fromCharCode(paramikojs.KexGex._MSG_KEXDH_GEX_REQUEST_OLD)),b.add_int(this.preferred_bits),this.old_style=!0):(b.add_byte(String.fromCharCode(paramikojs.KexGex._MSG_KEXDH_GEX_REQUEST)),b.add_int(this.min_bits),b.add_int(this.preferred_bits),b.add_int(this.max_bits)),this.transport._send_message(b),this.transport._expect_packet(paramikojs.KexGex._MSG_KEXDH_GEX_GROUP)},parse_next:function(a,b){if(a==paramikojs.KexGex._MSG_KEXDH_GEX_GROUP)return this._parse_kexdh_gex_group(b);if(a==paramikojs.KexGex._MSG_KEXDH_GEX_REPLY)return this._parse_kexdh_gex_reply(b);throw new paramikojs.ssh_exception.SSHException("KexGex asked to handle packet type "+a)},_generate_x:function(){var a=BigInteger.ONE,b=this.p.subtract(a);b=b.divide(new BigInteger("2",10));for(var c=paramikojs.util.deflate_long(b,0),d=c[0].charCodeAt(0),e=c.length,f=255;!(128&d);)d<<=1,f>>=1;for(var g;;){var h=this.transport.rng.read(e);if(h=String.fromCharCode(h[0].charCodeAt(0)&f)+h.substring(1),g=paramikojs.util.inflate_long(h,1),g.compareTo(a)>0&&b.compareTo(g)>0)break}this.x=g},_parse_kexdh_gex_group:function(a){this.p=a.get_mpint(),this.g=a.get_mpint();var b=paramikojs.util.bit_length(this.p);if(1024>b||b>8192)throw new paramikojs.ssh_exception.SSHException("Server-generated gex p (don't ask) is out of range ("+b+" bits)");console.debug("Got server p ("+b+" bits)"),this._generate_x(),this.e=this.g.modPow(this.x,this.p),a=new paramikojs.Message,a.add_byte(String.fromCharCode(paramikojs.KexGex._MSG_KEXDH_GEX_INIT)),a.add_mpint(this.e),this.transport._send_message(a),this.transport._expect_packet(paramikojs.KexGex._MSG_KEXDH_GEX_REPLY)},_parse_kexdh_gex_reply:function(a){var b=a.get_string();this.f=a.get_mpint();var c=a.get_string(),d=BigInteger.ONE;if(d.compareTo(this.f)>0||this.f.compareTo(this.p.subtract(d))>0)throw new paramikojs.ssh_exception.SSHException('Server kex "f" is out of range');var e=this.f.modPow(this.x,this.p),f=new paramikojs.Message;f.add(this.transport.local_version,this.transport.remote_version,this.transport.local_kex_init,this.transport.remote_kex_init,b),this.old_style||f.add_int(this.min_bits),f.add_int(this.preferred_bits),this.old_style||f.add_int(this.max_bits),f.add_mpint(this.p),f.add_mpint(this.g),f.add_mpint(this.e),f.add_mpint(this.f),f.add_mpint(e),this.transport._set_K_H(e,new this.hash_algo(f.toString()).digest()),this.transport._verify_key(b,c),this.transport._activate_outbound()}},paramikojs.KexGexSHA256=function(a){inherit(this,new paramikojs.KexGex(a)),this.name="diffie-hellman-group-exchange-sha256",this.hash_algo=kryptos.hash.SHA256},paramikojs.KexGroup1=function(a){this.transport=a,this.x=new BigInteger("0",10),this.e=new BigInteger("0",10),this.f=new BigInteger("0",10),this.P=paramikojs.KexGroup1.P,this.G=paramikojs.KexGroup1.G,this.hash_algo=kryptos.hash.SHA},paramikojs.KexGroup1._MSG_KEXDH_INIT=30,paramikojs.KexGroup1._MSG_KEXDH_REPLY=31,paramikojs.KexGroup1.P=new BigInteger("FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE65381FFFFFFFFFFFFFFFF",16),paramikojs.KexGroup1.G=new BigInteger("2",10),paramikojs.KexGroup1.prototype={name:"diffie-hellman-group1-sha1",start_kex:function(){if(this._generate_x(),this.transport.server_mode)return this.f=this.G.modPow(this.x,this.P),void this.transport._expect_packet(paramikojs.KexGroup1._MSG_KEXDH_INIT);this.e=this.G.modPow(this.x,this.P);var a=new paramikojs.Message;a.add_byte(String.fromCharCode(paramikojs.KexGroup1._MSG_KEXDH_INIT)),a.add_mpint(this.e),this.transport._send_message(a),this.transport._expect_packet(paramikojs.KexGroup1._MSG_KEXDH_REPLY)},parse_next:function(a,b){if(this.transport.server_mode&&a==paramikojs.KexGroup1._MSG_KEXDH_INIT)return this._parse_kexdh_init(b);if(!this.transport.server_mode&&a==paramikojs.KexGroup1._MSG_KEXDH_REPLY)return this._parse_kexdh_reply(b);throw new paramikojs.ssh_exception.SSHException("KexGroup1 asked to handle packet type "+a)},_generate_x:function(){for(var a;;)if(a=this.transport.rng.read(128),a=String.fromCharCode(127&a[0].charCodeAt(0))+a.substring(1),"ÿÿÿÿÿÿÿ"!=a.substring(0,8)&&"\x00\x00\x00\x00\x00\x00\x00\x00"!=a.substring(0,8))break;this.x=paramikojs.util.inflate_long(a,!1)},_parse_kexdh_reply:function(a){var b=a.get_string();this.f=a.get_mpint();var c=BigInteger.ONE;if(c.compareTo(this.f)>0||this.f.compareTo(this.P.subtract(c))>0)throw new paramikojs.ssh_exception.SSHException('Server kex "f" is out of range');var d=a.get_string(),e=this.f.modPow(this.x,this.P),f=new paramikojs.Message;f.add(this.transport.local_version,this.transport.remote_version,this.transport.local_kex_init,this.transport.remote_kex_init),f.add_string(b),f.add_mpint(this.e),f.add_mpint(this.f),f.add_mpint(e),this.transport._set_K_H(e,new kryptos.hash.SHA(f.toString()).digest()),this.transport._verify_key(b,d),this.transport._activate_outbound()}},paramikojs.KexGroup14=function(a){inherit(this,new paramikojs.KexGroup1(a)),this.P=paramikojs.KexGroup14.P,this.G=paramikojs.KexGroup14.G,this.hash_algo=kryptos.hash.SHA},paramikojs.KexGroup14.P=new BigInteger("FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AACAA68FFFFFFFFFFFFFFFF",16),paramikojs.KexGroup14.G=new BigInteger("2",10),paramikojs.KexGroup14.prototype={name:"diffie-hellman-group14-sha1"},paramikojs.Message=function(a){this.packet=a?new String(a):new String,this.position=0},paramikojs.Message.prototype={toString:function(){return this.packet},rewind:function(){this.position=0},get_remainder:function(){return this.packet.substring(this.position)},get_so_far:function(){return this.packet.substring(0,this.position)},get_bytes:function(a){var b=this.packet.substring(this.position,this.position+a);this.position+=a;var c=1<<20;return b.length<a&&c>a?b+new Array(a-b.length+1).join("\x00"):b},get_byte:function(){return this.get_bytes(1)},get_boolean:function(){var a=this.get_bytes(1);return"\x00"!=a},get_int:function(){return struct.unpack(">I",this.get_bytes(4))[0]},get_int64:function(){return struct.unpack(">Q",this.get_bytes(8))[0]},get_mpint:function(){return paramikojs.util.inflate_long(this.get_string())},get_string:function(){return this.get_bytes(this.get_int())},get_list:function(){return this.get_string().split(",")},add_bytes:function(a){return this.packet+=a,this},add_byte:function(a){return this.packet+=a,this},add_boolean:function(a){return this.add_byte(a?"":"\x00"),this},add_int:function(a){return this.packet+=struct.pack(">I",a),this},add_int64:function(a){return this.packet+=struct.pack(">Q",a),this},add_mpint:function(a){return this.add_string(paramikojs.util.deflate_long(a)),this},add_string:function(a){return this.add_int(a.length),this.packet+=a,this},add_list:function(a){return this.add_string(a.join(",")),this},_add:function(a){if("string"==typeof a)return this.add_string(a);if("number"==typeof a)return this.add_int(a);if(a instanceof BigInteger)return this.add_mpint(a);if("boolean"==typeof a)return this.add_boolean(a);if(a instanceof Array)return this.add_list(a);throw"Unknown type"},add:function(){for(var a=0;a<arguments.length;++a)this._add(arguments[a])}},paramikojs.Packetizer=function(a){this.__socket=a,this.__closed=!1,this.__dump_packets=!1,this.__need_rekey=!1,this.__init_count=0,this.__remainder="",this.__decrypted_header="",this.__sent_bytes=0,this.__sent_packets=0,this.__received_bytes=0,this.__received_packets=0,this.__received_packets_overflow=0,this.__block_size_out=8,this.__block_size_in=8,this.__mac_size_out=0,this.__mac_size_in=0,this.__block_engine_out=null,this.__block_engine_in=null,this.__mac_engine_out=null,this.__mac_engine_in=null,this.__mac_key_out="",this.__mac_key_in="",this.__compress_engine_out=null,this.__compress_engine_in=null,this.__sequence_number_out=0,this.__sequence_number_in=0,this.__keepalive_interval=0,this.__keepalive_last=new Date,this.__keepalive_callback=null},paramikojs.Packetizer.prototype={REKEY_PACKETS:Math.pow(2,29),REKEY_BYTES:Math.pow(2,29),REKEY_PACKETS_OVERFLOW_MAX:Math.pow(2,29),REKEY_BYTES_OVERFLOW_MAX:Math.pow(2,29),set_outbound_cipher:function(a,b,c,d,e){this.__block_engine_out=a,this.__block_size_out=b,this.__mac_engine_out=c,this.__mac_size_out=d,this.__mac_key_out=e,this.__sent_bytes=0,this.__sent_packets=0,this.__init_count|=1,3==this.__init_count&&(this.__init_count=0,this.__need_rekey=!1)},set_inbound_cipher:function(a,b,c,d,e){this.__block_engine_in=a,this.__block_size_in=b,this.__mac_engine_in=c,this.__mac_size_in=d,this.__mac_key_in=e,this.__received_bytes=0,this.__received_packets=0,this.__received_bytes_overflow=0,this.__received_packets_overflow=0,this.__init_count|=2,3==this.__init_count&&(this.__init_count=0,this.__need_rekey=!1)},set_outbound_compressor:function(a){this.__compress_engine_out=a},set_inbound_compressor:function(a){this.__compress_engine_in=a},close:function(){this.__closed=!0},set_hexdump:function(a){this.__dump_packets=a},get_hexdump:function(){return this.__dump_packets},get_mac_size_in:function(){return this.__mac_size_in},get_mac_size_out:function(){return this.__mac_size_out},need_rekey:function(){return this.__need_rekey},set_keepalive:function(a,b){this.__keepalive_interval=a,this.__keepalive_callback=b,this.__keepalive_last=new Date},read_all:function(a){if(this.__socket.fullBuffer.length<a)throw new paramikojs.ssh_exception.WaitException("wait");var b="";return b+=this.__socket.fullBuffer.substring(0,a),this.__socket.fullBuffer=this.__socket.fullBuffer.substring(a),b},write_all:function(a){this.__keepalive_last=new Date,this.__socket.writeCallback(a)},readline:function(a){for(var b="";-1==b.indexOf("\n");)b+=this._read_timeout(a);var c=b.indexOf("\n");return this.__socket.fullBuffer=b.substring(c+1)+this.__socket.fullBuffer,b=b.substring(0,c),b.length>0&&"\r"==b.charAt(b.length-1)&&(b=b.substring(0,b.length-1)),b},send_message:function(a){a=a.toString();var b,c=a[0].charCodeAt(0);b=c in paramikojs.MSG_NAMES?paramikojs.MSG_NAMES[c]:"$"+c;var d=a.length;this.__compress_engine_out&&(a=this.__compress_engine_out.compress(a));var e=this._build_packet(a);this.__dump_packets&&(console.debug("Write packet <"+b+">, length "+d),console.debug(paramikojs.util.format_binary(e,"OUT: ")));var f;f=this.__block_engine_out?this.__block_engine_out.encrypt(e):e;var g;this.__block_engine_out&&(g=struct.pack(">I",this.__sequence_number_out)+e,f+=kryptos.hash.HMAC(this.__mac_key_out,g,this.__mac_engine_out).substring(0,this.__mac_size_out)),this.__sequence_number_out=this.__sequence_number_out+1&4294967295,this.write_all(f),this.__sent_bytes+=f.length,this.__sent_packets+=1,(this.__sent_packets>=this.REKEY_PACKETS||this.__sent_bytes>=this.REKEY_BYTES)&&!this.__need_rekey&&(console.debug("Rekeying (hit "+this.__sent_packets+" packets, "+this.__sent_bytes+" bytes sent)"),this.__received_bytes_overflow=0,this.__received_packets_overflow=0,this._trigger_rekey())},read_message:function(){var a;this.__decrypted_header?(a=this.__decrypted_header,this.__decrypted_header=""):(a=this.read_all(this.__block_size_in,!0),this.__block_engine_in&&(a=this.__block_engine_in.decrypt(a)),this.__dump_packets&&console.debug(paramikojs.util.format_binary(a,"IN: ")));var b=struct.unpack(">I",a.substring(0,4))[0],c=a.substring(4);if((b-c.length)%this.__block_size_in!=0)throw new paramikojs.ssh_exception.SSHException("Invalid packet blocking");var d;try{d=this.read_all(b+this.__mac_size_in-c.length)}catch(e){throw e instanceof paramikojs.ssh_exception.WaitException?(this.__decrypted_header=a,new paramikojs.ssh_exception.WaitException("wait")):e}var f=d.substring(0,b-c.length),g=d.substring(b-c.length);if(this.__block_engine_in&&f&&(f=this.__block_engine_in.decrypt(f)),this.__dump_packets&&console.debug(paramikojs.util.format_binary(f,"IN: ")),f=c+f,this.__mac_size_in>0){var h=g.substring(0,this.__mac_size_in),i=struct.pack(">I",this.__sequence_number_in)+struct.pack(">I",b)+f,j=kryptos.hash.HMAC(this.__mac_key_in,i,this.__mac_engine_in).substring(0,this.__mac_size_in);if(j!=h)throw new paramikojs.ssh_exception.SSHException("Mismatched MAC")}var k=f[0].charCodeAt(0),l=f.substring(1,b-k);this.__dump_packets&&console.debug("Got payload ("+b+" bytes, "+k+" padding)"),this.__compress_engine_in&&(l=this.__compress_engine_in.decompress(l));var m=new paramikojs.Message(l.substring(1));m.seqno=this.__sequence_number_in,this.__sequence_number_in=this.__sequence_number_in+1&4294967295;var n=b+this.__mac_size_in+4;if(this.__received_bytes+=n,this.__received_packets+=1,this.__need_rekey){if(this.__received_bytes_overflow+=n,this.__received_packets_overflow+=1,this.__received_packets_overflow>=this.REKEY_PACKETS_OVERFLOW_MAX||this.__received_bytes_overflow>=this.REKEY_BYTES_OVERFLOW_MAX)throw new paramikojs.ssh_exception.SSHException("Remote transport is ignoring rekey requests")}else(this.__received_packets>=this.REKEY_PACKETS||this.__received_bytes>=this.REKEY_BYTES)&&(console.debug("Rekeying (hit "+this.__received_packets+" packets, "+this.__received_bytes+" bytes received)"),this.__received_bytes_overflow=0,this.__received_packets_overflow=0,this._trigger_rekey());var o,p=l[0].charCodeAt(0);return o=p in paramikojs.MSG_NAMES?paramikojs.MSG_NAMES[p]:"$"+p,this.__dump_packets&&console.debug("Read packet <"+o+">, length "+l.length),{ptype:p,m:m}},_check_keepalive:function(){if(this.__keepalive_interval&&this.__block_engine_out&&!this.__need_rekey){var a=new Date;a>this.__keepalive_last+this.__keepalive_interval&&(this.__keepalive_callback(),this.__keepalive_last=a)}},_read_timeout:function(){var a=this.__socket.fullBuffer.substring(0,128);return this.__socket.fullBuffer=this.__socket.fullBuffer.substring(128),a},_build_packet:function(a){var b=this.__block_size_out,c=3+b-(a.length+8)%b,d=struct.pack(">I",a.length+c+1)+struct.pack(">B",c);return d+=a,d+=this.__block_engine_out?this.__socket.rng.read(c,!0):new Array(c+1).join("\x00")},_trigger_rekey:function(){this.__need_rekey=!0}},paramikojs.PKey=function(){},paramikojs.PKey.prototype={_CIPHER_TABLE:{"AES-128-CBC":{cipher:kryptos.cipher.AES,keysize:16,blocksize:16,mode:kryptos.cipher.AES.MODE_CBC},"DES-EDE3-CBC":{cipher:kryptos.cipher.DES3,keysize:24,blocksize:8,mode:kryptos.cipher.DES3.MODE_CBC}},toString:function(){return""},get_name:function(){return""},get_bits:function(){return 0},can_sign:function(){return!1},get_fingerprint:function(){return new kryptos.hash.MD5(this.toString()).digest()},get_base64:function(){return base64.encodestring(this.toString()).replace("\n","")},sign_ssh_data:function(a,b,c){c("")},verify_ssh_sig:function(){return!1},from_private_key_file:function(a,b){var c=new this(null,null,a,b);return c},from_private_key:function(a,b){var c=new this(null,null,null,b,null,a);return c},write_private_key_file:function(){throw"Not implemented in PKey"},write_private_key:function(){throw"Not implemented in PKey"},_read_private_key_file:function(a,b,c){var d=window.Components?localFile.init(b):b,e=this._read_private_key(a,d,c);return e},_read_private_key:function(a,b,c){var d;if(window.Components){d="";var e=window.Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(window.Components.interfaces.nsIFileInputStream),f=window.Components.classes["@mozilla.org/intl/converter-input-stream;1"].createInstance(window.Components.interfaces.nsIConverterInputStream);e.init(b,-1,0,0),f.init(e,"UTF-8",0,0);var g=0;do{var h={};g=f.readString(4294967295,h),d+=h.value}while(0!=g);f.close()}else d=gKeys[b];if(d=d.split(-1!=d.indexOf("\r\n")?"\r\n":"\n"),d.length&&0==d[0].indexOf("PuTTY-User-Key-File-"))throw new paramikojs.ssh_exception.IsPuttyKey("puttykey",d);for(var i=0;i<d.length&&d[i].trim()!="-----BEGIN "+a+" PRIVATE KEY-----";)i+=1;if(i>=d.length)throw new paramikojs.ssh_exception.SSHException("not a valid "+a+" private key file");var j={};for(i+=1;i<d.length;){var k=d[i].split(": ");if(1==k.length)break;j[k[0].toLowerCase()]=k[1].trim(),i+=1}for(var l=i;d[l].trim()!="-----END "+a+" PRIVATE KEY-----"&&l<d.length;)l+=1;var m;try{m=base64.decodestring(d.slice(i,l).join(""))}catch(n){throw new paramikojs.ssh_exception.SSHException("base64 decoding error: "+n.toString())}if(!("proc-type"in j)&&c)throw new paramikojs.ssh_exception.SSHException("Private key file is not encrypted but password used.");if(!("proc-type"in j))return m;if("4,ENCRYPTED"!=j["proc-type"])throw new paramikojs.ssh_exception.SSHException('Unknown private key structure "'+j["proc-type"]+'"');var o=j["dek-info"].split(","),p=o[0],q=o[1];if(!(p in this._CIPHER_TABLE))throw new paramikojs.ssh_exception.SSHException('Unknown private key cipher "'+p+'"');
if(!c)throw new paramikojs.ssh_exception.PasswordRequiredException("Private key file is encrypted");var r=this._CIPHER_TABLE[p].cipher,s=this._CIPHER_TABLE[p].keysize,t=this._CIPHER_TABLE[p].mode,u=paramikojs.util.unhexify(q),v=paramikojs.util.generate_key_bytes(kryptos.hash.MD5,u,c,s);return new r(v,t,u).decrypt(m)},_read_putty_private_key:function(a,b,c){for(var d={},e={},f=null,g=0;g<b.length;++g){var h=b[g],i=h.indexOf(": ");if(i>0)f=h.substring(0,i),d[f]=h.substring(i+2);else{var j=e[f];j?j+=h:j=h,e[f]=j}}if(a="DSA"==a?"DSS":a,d["PuTTY-User-Key-File-2"].substring(4).toUpperCase()!=a)throw new paramikojs.ssh_exception.SSHException("not a valid "+a+" private key file");var k="aes256-cbc"==d.Encryption,l=base64.decodestring(e["Public-Lines"]),m=base64.decodestring(e["Private-Lines"]),n=function(a){var b=new kryptos.hash.SHA;b.update("\x00\x00\x00\x00"),b.update(a);var c=b.digest();b=new kryptos.hash.SHA,b.update("\x00\x00\x00"),b.update(a);var d=b.digest();return(c+d).substring(0,32)};if(k){var o=n(c),p=new kryptos.cipher.AES(o,kryptos.cipher.AES.MODE_CBC,new Array(17).join("\x00"));m=p.decrypt(m)}if(d["Private-MAC"]){var o=new kryptos.hash.SHA("putty-private-key-file-mac-key");k&&o.update(c),o=o.digest();var q=new paramikojs.Message;q.add_string(d["PuTTY-User-Key-File-2"]),q.add_string(d.Encryption),q.add_string(d.Comment),q.add_string(l),q.add_string(m);var r=binascii.hexlify(kryptos.hash.HMAC(o,q.toString(),kryptos.hash.HMAC_SHA));if(d["Private-MAC"]!=r)throw new paramikojs.ssh_exception.SSHException("Unable to parse key file")}var s=m,t=[];if("ssh-rsa"==d["PuTTY-User-Key-File-2"]){var u=new paramikojs.Message(l);u.get_string(),t.push(0);var v=u.get_mpint();t.push(u.get_mpint()),t.push(v),u=new paramikojs.Message(s),t.push(u.get_mpint()),t.push(u.get_mpint()),t.push(u.get_mpint())}else{var u=new paramikojs.Message(l);u.get_string(),t.push(0),t.push(u.get_mpint()),t.push(u.get_mpint()),t.push(u.get_mpint()),t.push(u.get_mpint()),u=new paramikojs.Message(s),t.push(u.get_mpint())}return t},_write_private_key_file:function(a,b,c,d){localFile.init(b);this._write_private_key(a,f,c,d)},_write_private_key:function(a,b,c,d){var e=window.Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(window.Components.interfaces.nsIFileOutputStream);e.init(b,42,384,0);var f=window.Components.classes["@mozilla.org/intl/converter-output-stream;1"].createInstance(window.Components.interfaces.nsIConverterOutputStream);if(f.init(e,"UTF-8",0,0),f.writeString("-----BEGIN "+a+" PRIVATE KEY-----\n"),d){var g=this._CIPHER_TABLE.keys()[0],h=this._CIPHER_TABLE[g].cipher,i=this._CIPHER_TABLE[g].keysize,j=this._CIPHER_TABLE[g].blocksize,k=this._CIPHER_TABLE[g].mode,l=paramikojs.rng.read(j),m=paramikojs.util.generate_key_bytes(kryptos.hash.MD5,l,d,i);if(c.length%j!=0){var n=j-c.length%j;c+=new Array(n+1).join("\x00")}c=new h(m,k,l).encrypt(c),f.writeString("Proc-Type: 4,ENCRYPTED\n"),f.writeString("DEK-Info: "+g+","+paramikojs.util.hexify(l).toUpperCase()+"\n"),f.writeString("\n")}var o=base64.encodestring(c);o=o.split("\n").join("");for(var p="",q=0;q<o.length;q+=64)p+=o.substring(q,q+64)+"\n";f.writeString(p),f.writeString("\n"),f.writeString("-----END "+a+" PRIVATE KEY-----\n"),f.close()}},paramikojs.RSAKey=function(a,b,c,d,e,f){if(inherit(this,new paramikojs.PKey),this.n=null,this.e=null,this.d=null,this.p=null,this.q=null,f)return void this._from_private_key(f,d);if(c)return void this._from_private_key_file(c,d);if(!a&&b&&(a=new paramikojs.Message(b)),e)this.e=e[0],this.n=e[1];else{if(!a)throw new paramikojs.ssh_exception.SSHException("Key object may not be empty");if("ssh-rsa"!=a.get_string())throw new paramikojs.ssh_exception.SSHException("Invalid key");this.e=a.get_mpint(),this.n=a.get_mpint()}this.size=paramikojs.util.bit_length(this.n)},paramikojs.RSAKey.prototype={toString:function(){var a=new paramikojs.Message;return a.add_string("ssh-rsa"),a.add_mpint(this.e),a.add_mpint(this.n),a.toString()},compare:function(a){return this.get_name()!=a.get_name()?!1:this.e.equals(a.e)&&this.n.equals(a.n)?!0:!1},get_name:function(){return"ssh-rsa"},get_bits:function(){return this.size},can_sign:function(){return null!=this.d},sign_ssh_data:function(a,b,c){var d=new kryptos.hash.SHA(b).digest(),e=this._pkcs1imify(d),f=new Worker(gRsaKeyWorkerJs);f.onmessage=function(a){var b=new paramikojs.Message;b.add_string("ssh-rsa"),b.add_string(paramikojs.util.deflate_long(new BigInteger(a.data,10),0)),c(b)},f.postMessage({n:this.n.toString(),e:this.e.toString(),d:this.d.toString(),pkcs1imified:e})},verify_ssh_sig:function(a,b){if("ssh-rsa"!=b.get_string())return!1;var c=paramikojs.util.inflate_long(b.get_string(),!0),d=paramikojs.util.inflate_long(this._pkcs1imify(new kryptos.hash.SHA(a).digest()),!0),e=(new kryptos.publicKey.RSA).construct(this.n,this.e);return e.verify(d,[c])},_encode_key:function(){if(!this.p||!this.q)throw new paramikojs.ssh_exception.SSHException("Not enough key info to write private key file");keylist=[0,this.n,this.e,this.d,this.p,this.q,this.d%(this.p-1),this.d%(this.q-1),paramikojs.util.mod_inverse(this.q,this.p)];var a;try{a=new paramikojs.BER,a.encode(keylist)}catch(b){throw new paramikojs.ssh_exception.SSHException("Unable to create ber encoding of key")}return a.toString()},write_private_key_file:function(a,b){this._write_private_key_file("RSA",a,this._encode_key(),b)},write_private_key:function(a,b){this._write_private_key("RSA",a,this._encode_key(),b)},generate:function(a,b){var c=(new kryptos.publicKey.RSA).generate(a,paramikojs.rng.read,b),d=new paramikojs.RSAKey(null,null,null,null,[c.e,c.n],null);return d.d=c.d,d.p=c.p,d.q=c.q,d},_pkcs1imify:function(a){var b="0!0	+\x00",c=paramikojs.util.deflate_long(this.n,0).length,d=new Array(c-b.length-a.length-3+1).join("ÿ");return"\x00"+d+"\x00"+b+a},_from_private_key_file:function(a,b){var c,d=null;try{c=this._read_private_key_file("RSA",a,b)}catch(e){if(!(e instanceof paramikojs.ssh_exception.IsPuttyKey))throw e;c=null,d=this._read_putty_private_key("RSA",e.lines,b)}this._decode_key(c,d)},_from_private_key:function(a,b){var c=this._read_private_key("RSA",a,b);this._decode_key(c)},_decode_key:function(a,b){try{b=b||new paramikojs.BER(a).decode()}catch(c){throw new paramikojs.ssh_exception.SSHException("Unable to parse key file")}if(!(b instanceof Array)||b.length<4||0!=b[0])throw new paramikojs.ssh_exception.SSHException("Not a valid RSA private key file (bad ber encoding)");this.n=b[1],this.e=b[2],this.d=b[3],this.p=b[4],this.q=b[5],this.size=paramikojs.util.bit_length(this.n)}},paramikojs.SFTPAttributes=function(){this._flags=0,this.st_size=null,this.st_uid=null,this.st_gid=null,this.st_mode=null,this.st_atime=null,this.st_mtime=null,this.attr={}},paramikojs.SFTPAttributes.prototype={FLAG_SIZE:1,FLAG_UIDGID:2,FLAG_PERMISSIONS:4,FLAG_AMTIME:8,FLAG_EXTENDED:2147483648,from_stat:function(a,b){var c=this;return c.st_size=a.st_size,c.st_uid=a.st_uid,c.st_gid=a.st_gid,c.st_mode=a.st_mode,c.st_atime=a.st_atime,c.st_mtime=a.st_mtime,b&&(c.filename=b),c},_from_msg:function(a,b,c){var d=this;return d._unpack(a),b&&(d.filename=b),c&&(d.longname=c),d},_unpack:function(a){if(this._flags=a.get_int(),this._flags&this.FLAG_SIZE&&(this.st_size=a.get_int64()),this._flags&this.FLAG_UIDGID&&(this.st_uid=a.get_int(),this.st_gid=a.get_int()),this._flags&this.FLAG_PERMISSIONS&&(this.st_mode=a.get_int()),this._flags&this.FLAG_AMTIME&&(this.st_atime=a.get_int(),this.st_mtime=a.get_int()),this._flags&this.FLAG_EXTENDED)for(var b=a.get_int(),c=0;c<b.length;++c)this.attr[a.get_string()]=a.get_string()},_pack:function(a){this._flags=0,this.st_size&&(this._flags|=this.FLAG_SIZE),this.st_uid&&this.st_gid&&(this._flags|=this.FLAG_UIDGID),this.st_mode&&(this._flags|=this.FLAG_PERMISSIONS),this.st_atime&&this.st_mtime&&(this._flags|=this.FLAG_AMTIME);var b;for(b in this.attr)break;if(b&&(this._flags|=this.FLAG_EXTENDED),a.add_int(this._flags),this._flags&this.FLAG_SIZE&&a.add_int64(this.st_size),this._flags&this.FLAG_UIDGID&&(a.add_int(this.st_uid),a.add_int(this.st_gid)),this._flags&this.FLAG_PERMISSIONS&&a.add_int(this.st_mode),this._flags&this.FLAG_AMTIME&&(a.add_int(this.st_atime),a.add_int(this.st_mtime)),this._flags&this.FLAG_EXTENDED){a.add_int(this.attr.length);for(var c in this.attr)a.add_string(c),a.add_string(this.attr[c])}},_rwx:function(a,b,c){b&&(b=2);var d="-r".charCodeAt(a>>2)+"-w".charCodeAt(a>>1&1);return d+=c?"-xTt".charCodeAt(b+(1&a)):"-xSs".charCodeAt(b+(1&a))},toString:function(){}},paramikojs.SFTPClient=function(a,b,c){inherit(this,new paramikojs.BaseSFTP),this.sock=a,this.transport=b,this.ultra_debug=!1,this.request_number=1,this._cwd=null,this._expecting={},this._deferred_packet=null;var d=this,e=function(a){console.info("Opened sftp connection (server version "+a+")"),c(d)};this._send_version(e)},paramikojs.SFTPClient.from_transport=function(a,b){var c=function(c){c.invoke_subsystem("sftp");new paramikojs.SFTPClient(c,a,b)};a.open_session(c)},paramikojs.SFTPClient.prototype={close:function(){console.info("sftp session closed."),this.sock.close()},get_channel:function(){return this.sock},listdir:function(a,b){a=a||".";var c=function(a){b(a)};this.listdir_attr(a,c)},listdir_attr:function(a,b){a=a||".",a=this._adjust_cwd(a),console.debug("listdir("+a+")");var c=this,d=function(a,d,e){if(e)return void b(e);if(!a||a[0]!=c.CMD_HANDLE)return void b(new paramikojs.ssh_exception.SFTPError("Expected handle"));var f=a[1].get_string();c.listdir_attr_callback(f,b)};this._request(this.CMD_OPENDIR,d,a)},listdir_attr_callback:function(a,b,c){c=c||[];var d=this,e=function(e,f,g){if(g)return void b(g);if(f)return void d.listdir_attr_close_callback(a,b,c);if(!e||e[0]!=d.CMD_NAME)return void b(new paramikojs.ssh_exception.SFTPError("Expected name response"));for(var h=e[1].get_int(),i=0;h>i;++i){var j=e[1].get_string();try{j=d.transport.toUTF8.convertStringToUTF8(j,"UTF-8",1)}catch(k){console.debug(k)}var l=e[1].get_string();try{l=d.transport.toUTF8.convertStringToUTF8(l,"UTF-8",1)}catch(k){console.debug(k)}var m=(new paramikojs.SFTPAttributes)._from_msg(e[1],j,l);"."!=j&&".."!=j&&c.push(m)}d.listdir_attr_callback(a,b,c)};this._request(this.CMD_READDIR,e,a)},listdir_attr_close_callback:function(a,b,c){var d=this,e=function(){d.listdir_check_symlinks(b,c)};this._request(this.CMD_CLOSE,e,a)},listdir_check_symlinks:function(a,b){for(var c=[],d=0;d<b.length;++d)if("l"==b[d].longname.charAt(0)){var e=d,f=b[d].filename;c.push({index:e,filename:f})}if(c.length)for(var d=0;d<c.length;++d){var e=c[d].index,g=d==c.length-1,h=this.listdir_check_symlinks_helper(a,b,e,g);this.readlink(c[d].filename,h)}else a(b)},listdir_check_symlinks_helper:function(a,b,c,d){return function(e){b[c].longname+=" -> "+e,d&&a(b)}},open:function(a,b,c,d,e){b=b||"r",c=c||-1,e=e||0,a=this._adjust_cwd(a),console.debug("open("+a+", "+b+")");var f=0;(-1!=b.indexOf("r")||-1!=b.indexOf("+"))&&(f|=this.SFTP_FLAG_READ),(-1!=b.indexOf("w")||-1!=b.indexOf("+")||-1!=b.indexOf("a"))&&(f|=this.SFTP_FLAG_WRITE),-1!=b.indexOf("w")&&(f|=this.SFTP_FLAG_CREATE|this.SFTP_FLAG_TRUNC),-1!=b.indexOf("a")&&(f|=this.SFTP_FLAG_CREATE|this.SFTP_FLAG_APPEND),-1!=b.indexOf("x")&&(f|=this.SFTP_FLAG_CREATE|this.SFTP_FLAG_EXCL);var g=new paramikojs.SFTPAttributes,h=this,i=function(f){if(!f||f[0]!=h.CMD_HANDLE)return void d(new paramikojs.ssh_exception.SFTPError("Expected handle"));var g=f[1].get_string();console.debug("open("+a+", "+b+") -> "+paramikojs.util.hexify(g)),d(new paramikojs.SFTPFile(h,g,b,c,e))};this._request(this.CMD_OPEN,i,a,f,g)},remove:function(a,b){a=this._adjust_cwd(a),console.debug("remove("+a+")");var c=function(a,c,d){b(d?d:!0)};this._request(this.CMD_REMOVE,c,a)},rename:function(a,b,c){a=this._adjust_cwd(a),b=this._adjust_cwd(b),console.debug("rename("+a+", "+b+")");var d=function(a){c(a)};this._request(this.CMD_RENAME,d,a,b)},mkdir:function(a,b,c){b=b||511,a=this._adjust_cwd(a),console.debug("mkdir("+a+", "+b+")");var d=new paramikojs.SFTPAttributes;d.st_mode=b;var e=function(a,b,d){c(d?d:!0)};this._request(this.CMD_MKDIR,e,a,d)},rmdir:function(a,b){a=this._adjust_cwd(a),console.debug("rmdir("+a+")");var c=function(a,c,d){b(d?d:!0)};this._request(this.CMD_RMDIR,c,a)},stat:function(a,b){a=this._adjust_cwd(a),console.debug("stat("+a+")");var c=this,d=function(a,d,e){b(e?e:a[0]!=c.CMD_ATTRS?!1:(new paramikojs.SFTPAttributes)._from_msg(a[1]))};this._request(this.CMD_STAT,d,a)},lstat:function(a,b){a=this._adjust_cwd(a),console.debug("lstat("+a+")");var c=this,d=function(a,d,e){b(e?e:a[0]!=c.CMD_ATTRS?!1:(new paramikojs.SFTPAttributes)._from_msg(a[1]))};this._request(this.CMD_LSTAT,d,a)},symlink:function(a,b,c){b=this._adjust_cwd(b),console.debug("symlink("+a+", "+b+")"),a=this.transport.fromUTF8.ConvertFromUnicode(a)+this.transport.fromUTF8.Finish();var d=function(a,b,d){c(d?d:!0)};this._request(this.CMD_SYMLINK,d,a,b)},chmod:function(a,b,c){a=this._adjust_cwd(a),console.debug("chmod("+a+", "+b+")");var d=new paramikojs.SFTPAttributes;d.st_mode=b;var e=function(a,b,d){c(d?d:!0)};this._request(this.CMD_SETSTAT,e,a,d)},chown:function(a,b,c){a=this._adjust_cwd(a),console.debug("chown("+a+", "+b+", "+c+")");var d=new paramikojs.SFTPAttributes;d.st_uid=b,d.st_gid=c,this._request(this.CMD_SETSTAT,a,d)},utime:function(a,b,c){a=this._adjust_cwd(a),b||(b=[new Date,new Date]),console.debug("utime("+a+", "+b+")");var d=new paramikojs.SFTPAttributes;d.st_atime=b[0],d.st_mtime=b[1];var e=function(a,b,d){c(d?d:!0)};this._request(this.CMD_SETSTAT,e,a,d)},truncate:function(a,b){a=this._adjust_cwd(a),console.debug("truncate("+a+", "+b+")");var c=new paramikojs.SFTPAttributes;c.st_size=b,this._request(this.CMD_SETSTAT,a,c)},readlink:function(a,b){a=this._adjust_cwd(a),console.debug("readlink("+a+")");var c=this,d=function(a){if(!a||a[0]!=c.CMD_NAME)return void b(new paramikojs.ssh_exception.SFTPError("Expected name response"));var d=a[1].get_int();if(1!=d)return void b(new paramikojs.ssh_exception.SFTPError("Readlink returned "+d+" results"));var e=a[1].get_string();try{e=c.transport.toUTF8.convertStringToUTF8(e,"UTF-8",1)}catch(f){console.debug(f)}b(e)};this._request(this.CMD_READLINK,d,a)},normalize:function(a,b){a=this._adjust_cwd(a),console.debug("normalize("+a+")");var c=this,d=function(a){if(!a||a[0]!=c.CMD_NAME)return void b(new paramikojs.ssh_exception.SFTPError("Expected name response"));var d=a[1].get_int();if(1!=d)return void b(new paramikojs.ssh_exception.SFTPError("Realpath returned "+d+" results"));var e=a[1].get_string();try{e=c.transport.toUTF8.convertStringToUTF8(e,"UTF-8",1)}catch(f){console.debug(f)}b(e)};this._request(this.CMD_REALPATH,d,a)},chdir:function(a,b){if(!a)return void(this._cwd=null);var c=this,d=function(d){d instanceof paramikojs.ssh_exception.IOError||d instanceof paramikojs.ssh_exception.SFTPError?b(d):d&&16384==(61440&d.st_mode)?c.chdir_callback(a,b):b(!1)};this.stat(a,d)},chdir_callback:function(a,b){var c=this,d=function(a){c._cwd=a,b(!0)};this.normalize(a,d)},getcwd:function(){return this._cwd},put:function(a,b,c,d,e,f){var g,h,i;try{g=localFile.init(a),c=-1==c?0:c,h=window.Components.classes["@mozilla.org/network/file-input-stream;1"].createInstance(),h.QueryInterface(window.Components.interfaces.nsIFileInputStream),h.init(g,1,420,0),h.QueryInterface(window.Components.interfaces.nsISeekableStream),h.seek(0,c),i=window.Components.classes["@mozilla.org/binaryinputstream;1"].createInstance(window.Components.interfaces.nsIBinaryInputStream),i.setInputStream(h)}catch(j){console.debug(j),console.error(gStrbundle.getFormattedString("failedUpload",[a]));try{i.close()}catch(j){}try{h.close()}catch(j){}return void d(new paramikojs.ssh_exception.IOError("Couldn't open local file while uploading."))}var k=this,l=function(a){if(!a||a instanceof paramikojs.ssh_exception.IOError||a instanceof paramikojs.ssh_exception.SFTPError){try{i.close()}catch(b){}return void d(a)}a.seek(c),k.put_loop(i,a,d,f)};this.open(b,(c?"a":"w")+"b",null,l,c)},put_loop:function(a,b,c,d){try{var e=a.readBytes(a.available()<32768?a.available():32768);if(!e.length){var f=function(){try{a.close()}catch(b){}c(!0)};return void b.close(f)}var g=this,h=function(){d(e.length),g.put_loop(a,b,c,d)};b.write(e,h)}catch(i){c(new paramikojs.ssh_exception.IOError("Error reading file while uploading."))}},get:function(a,b,c,d,e){var f,g,h;try{f=localFile.init(b),c=-1==c?0:c,g=window.Components.classes["@mozilla.org/network/file-output-stream;1"].createInstance(window.Components.interfaces.nsIFileOutputStream),c?g.init(f,20,420,0):g.init(f,44,420,0),h=window.Components.classes["@mozilla.org/binaryoutputstream;1"].createInstance(window.Components.interfaces.nsIBinaryOutputStream),h.setOutputStream(g)}catch(i){console.debug(i),console.error(gStrbundle.getFormattedString("failedSave",[a]));try{h.close()}catch(i){}try{g.close()}catch(i){}return void d(new paramikojs.ssh_exception.IOError("Couldn't open local file while downloading."))}var j=this,k=function(a){if(!a||a instanceof paramikojs.ssh_exception.IOError||a instanceof paramikojs.ssh_exception.SFTPError){try{h.close()}catch(b){}return void d(a)}var f=function(){j.get_loop(h,a,d,e)};a.seek(c),a.prefetch(f)};this.open(a,"rb",null,k)},get_loop:function(a,b,c,d){var e=this,f=function(f){try{if(!f.length){b.close(!1);try{a.close()}catch(g){}return void c(!0)}d(f.length),a.writeBytes(f,f.length),e.get_loop(a,b,c,d)}catch(g){c(new paramikojs.ssh_exception.IOError("Error writing file while downloading."))}};b.read(32768,f)},_request:function(a,b){for(var c=this,d=function(a){c._read_response(a,b)},e=[],f=2;f<arguments.length;++f)e.push(arguments[f]);this._async_request(null,a,d,e)},_async_request:function(a,b,c,d,e,f){if(f=f||this.request_number,!e){e=new paramikojs.Message,e.add_int(this.request_number);for(var g=0;g<d.length;++g){var h=d[g];if("number"==typeof h)e.add_int(h);else if(h instanceof BigInteger)e.add_int64(h);else if("string"==typeof h)e.add_string(h);else{if(!(h instanceof paramikojs.SFTPAttributes))throw new paramikojs.ssh_exception.SFTPError("unknown type for "+h+" type "+typeof h);h._pack(e)}}this._expecting[f]=a,this.request_number+=1}var i=function(){c&&c(f)};return this._send_packet(b,e.toString(),i),f},_read_response:function(a,b){var c,d=this,e=function(){d._read_response(a,b)};if(this._deferred_packet){var f=new paramikojs.Message(this._deferred_packet[1]),g=f.get_int();if(g!=a)return void setTimeout(e,10);c=this._deferred_packet,this._deferred_packet=null}if(!c)try{c=this._read_packet()}catch(h){if(h instanceof paramikojs.ssh_exception.WaitException)return void setTimeout(e,10);throw h}var i=new paramikojs.Message(c[1]),j=i.get_int();if(null!=a&&a!=j)return this._deferred_packet=c,void setTimeout(e,10);if(!(j in this._expecting))return console.debug("Unexpected response #"+j),a?void setTimeout(e,10):void(b&&b([null,null]));var k=this._expecting[j];if(delete this._expecting[j],j==a){if(c[0]==this.CMD_STATUS)try{this._convert_status(i)}catch(h){if(h instanceof paramikojs.ssh_exception.EOFError)return void(b&&b(null,!0));if(h instanceof paramikojs.ssh_exception.IOError)return void(b&&b(null,!1,h));throw h}return void(b&&b([c[0],i]))}return k&&k._async_response(c[0],i),a?void setTimeout(e,10):void(b&&b([null,null]))},_finish_responses:function(a){for(var b;b in this._expecting;)this._expecting[b]==a&&(this._read_response(),a._check_exception())},_convert_status:function(a){var b=a.get_int(),c=a.get_string();if(b!=this.SFTP_OK)throw b==this.SFTP_EOF?new paramikojs.ssh_exception.EOFError(c):new paramikojs.ssh_exception.IOError(b==this.SFTP_NO_SUCH_FILE?c:b==this.SFTP_PERMISSION_DENIED?c:c)},_adjust_cwd:function(a){if(a=this.transport.fromUTF8.ConvertFromUnicode(a)+this.transport.fromUTF8.Finish(),!this._cwd)return a;if(a.length>0&&"/"==a[0])return a;if("/"==this._cwd)return this._cwd+a;var b=this.transport.fromUTF8.ConvertFromUnicode(this._cwd)+this.transport.fromUTF8.Finish();return b+"/"+a}},paramikojs.SFTPFile=function(a,b,c,d,e){inherit(this,new paramikojs.BufferedFile),c=c||"r",d=d||-1,e=e||0,this.sftp=a,this.handle=b,this._size=e,this._set_mode(c,d),this.mode=c,this.bufsize=d,this.pipelined=!1,this._prefetching=!1,this._prefetch_done=!1,this._prefetch_data={},this._prefetch_reads=[],this._saved_exception=null},paramikojs.SFTPFile.prototype={MAX_REQUEST_SIZE:32768,close:function(a){this._close(!1,a)},_close:function(a,b){if(!this._closed){console.debug("close("+paramikojs.util.hexify(this.handle)+")"),this.pipelined&&this.sftp._finish_responses(this),this.__close();try{a?this.sftp._async_request(null,this.sftp.CMD_CLOSE,null,[this.handle]):this.sftp._request(this.sftp.CMD_CLOSE,b,this.handle)}catch(c){}}},_data_in_prefetch_requests:function(a,b){function c(a,b){return a[0]<b[0]?-1:a[0]>b[0]?1:0}for(var d=[],e=0;e<this._prefetch_reads.length;++e)this._prefetch_reads[e][0]<=a&&d.push(this._prefetch_reads[e]);if(0==d.length)return!1;d.sort(c);var f=d[d.length-1],g=d[d.length-1];return a>=f+g?!1:f+g>=a+b?!0:this._data_in_prefetch_requests(f+g,a+b-f-g)},_data_in_prefetch_buffers:function(a){var b=[],c=null;for(var d in this._prefetch_data)a>=d&&(b.push(d),(!c||d>c)&&(c=d));if(0==b.length)return null;var e=a-c;return e>=this._prefetch_data[c].length?null:c},_read_prefetch:function(a,b){var c=this._data_in_prefetch_buffers(this._realpos);if(null!=c)return void this._read_prefetch_finished(a,c,b);if(this._prefetch_done||this._closed)return void this._read_prefetch_finished(a,null,b);var d=this,e=function(){d._check_exception(),d._read_prefetch(a,b)};this.sftp._read_response(null,e)},_read_prefetch_finished:function(a,b,c){if(null==b)return this._prefetching=!1,void c(null);var d=this._prefetch_data[b];delete this._prefetch_data[b];var e=this._realpos-b;e>0&&(this._prefetch_data[b]=d.substring(0,e),d=d.substring(e)),a<d.length&&(this._prefetch_data[this._realpos+a]=d.substring(a),d=d.substring(0,a)),c(d)},_read:function(a,b){if(a=Math.min(a,this.MAX_REQUEST_SIZE),this._prefetching)return void this._read_prefetch(a,b);var c=this,d=function(a,d){if(d)return void b(null);if(a[0]!=c.sftp.CMD_DATA)throw new paramikojs.ssh_exception.SFTPError("Expected data");b(a[1].get_string())};this.sftp._request(this.sftp.CMD_READ,d,this.handle,new BigInteger(this._realpos.toString(),10),a)},_write:function(a,b,c){var d=Math.min(a.length,this.MAX_REQUEST_SIZE),e=this.sftp._async_request(null,this.sftp.CMD_WRITE,null,[this.handle,new BigInteger(this._realpos.toString(),10),a.substring(0,d)]);if(!this.pipelined||this.sftp.sock.recv_ready()){var f=this,g=function(a){if(a[0]!=f.sftp.CMD_STATUS)throw new paramikojs.ssh_exception.SFTPError("Expected status");c<=f.MAX_REQUEST_SIZE&&b()};this.sftp._read_response(e,g)}return d},settimeout:function(a){this.sftp.sock.settimeout(a)},gettimeout:function(){return this.sftp.sock.gettimeout()},setblocking:function(a){this.sftp.sock.setblocking(a)},seek:function(a,b){b=b||0,this.flush(),b==this.SEEK_SET?this._realpos=this._pos=a:b==this.SEEK_CUR?(this._pos+=a,this._realpos=this._pos):this._realpos=this._pos=this._get_size()+a,this._rbuffer=""},stat:function(a){var b=this,c=function(c,d,e){a(e?e:c[0]!=b.sftp.CMD_ATTRS?!1:(new paramikojs.SFTPAttributes)._from_msg(c[1]))};this.sftp._request(this.sftp.CMD_FSTAT,c,this.handle)},chmod:function(a){console.debug("chmod("+paramikojs.util.hexify(this.handle)+", "+a+")");var b=new paramikojs.SFTPAttributes;b.st_mode=a,this.sftp._request(this.sftp.CMD_FSETSTAT,null,this.handle,b)},chown:function(a,b){console.debug("chown("+paramikojs.util.hexify(this.handle)+", "+a+", "+b+")");var c=new paramikojs.SFTPAttributes;c.st_uid=a,c.st_gid=b,this.sftp._request(this.sftp.CMD_FSETSTAT,null,this.handle,c)},utime:function(a){a||(a=[new Date,new Date]),console.debug("utime("+paramikojs.util.hexify(this.handle)+", "+a+")");var b=new paramikojs.SFTPAttributes;b.st_atime=a[0],b.st_mtime=a[1],this.sftp._request(this.sftp.CMD_FSETSTAT,null,this.handle,b)},truncate:function(a){console.debug("truncate("+paramikojs.util.hexify(this.handle)+", "+a+")");var b=new paramikojs.SFTPAttributes;b.st_size=a,this.sftp._request(this.sftp.CMD_FSETSTAT,null,this.handle,b)},check:function(a,b,c,d){b=b||0,c=c||0,d=d||0;var e=this.sftp._request(this.sftp.CMD_EXTENDED,null,"check-file",this.handle,a,new BigInteger(b.toString(),10),new BigInteger(c.toString(),10),d);return ext=e[1].get_string(),alg=e[1].get_string(),data=e[1].get_remainder()},set_pipelined:function(a){a=void 0==a?!0:a,this.pipelined=a},prefetch:function(a){var b=this,c=function(c){if(c instanceof paramikojs.ssh_exception.IOError)throw c;for(var d=b.size=c.st_size,e=[],f=b._realpos;d>f;)chunk=Math.min(b.MAX_REQUEST_SIZE,d-f),e.push([f,chunk]),f+=chunk;e.length>0&&b._start_prefetch(e),a()};this.stat(c)},readv:function(a){console.debug("readv("+paramikojs.util.hexify(this.handle)+", "+a+")");for(var b=[],c=0;c<a.length;++c){var d=a[c][0],e=a[c][1];if(!this._data_in_prefetch_buffers(d)&&!this._data_in_prefetch_requests(d,e))for(;e>0;){var f=Math.min(e,this.MAX_REQUEST_SIZE);b.push([d,f]),d+=f,e-=f}}this._start_prefetch(b);for(var c,g=[];c<a.length;++c)this.seek(a[c][0]),g.push(this.read(a[c][1]))},_get_size:function(){return this._size},_start_prefetch:function(a){this._prefetching=!0,this._prefetch_done=!1,this._prefetch_reads=this._prefetch_reads.concat(a),this._prefetch_thread(a)},_prefetch_thread:function(a){for(var b=0;b<a.length;++b){var c=a[b][0],d=a[b][1];this.sftp._async_request(this,this.sftp.CMD_READ,null,[this.handle,new BigInteger(c.toString(),10),d])}},_async_response:function(a,b){if(a!=this.sftp.CMD_STATUS){if(a!=this.sftp.CMD_DATA)throw new paramikojs.ssh_exception.SFTPError("Expected data");var c=b.get_string(),d=this._prefetch_reads.shift();this._prefetch_data[d[0]]=c,0==this._prefetch_reads.length&&(this._prefetch_done=!0)}else try{this.sftp._convert_status(b)}catch(e){this._saved_exception=e}},_check_exception:function(){if(this._saved_exception){var a=this._saved_exception;throw this._saved_exception=null,a}}},paramikojs.BaseSFTP=function(){this.ultra_debug=!1},paramikojs.BaseSFTP.prototype={CMD_INIT:1,CMD_VERSION:2,CMD_OPEN:3,CMD_CLOSE:4,CMD_READ:5,CMD_WRITE:6,CMD_LSTAT:7,CMD_FSTAT:8,CMD_SETSTAT:9,CMD_FSETSTAT:10,CMD_OPENDIR:11,CMD_READDIR:12,CMD_REMOVE:13,CMD_MKDIR:14,CMD_RMDIR:15,CMD_REALPATH:16,CMD_STAT:17,CMD_RENAME:18,CMD_READLINK:19,CMD_SYMLINK:20,CMD_STATUS:101,CMD_HANDLE:102,CMD_DATA:103,CMD_NAME:104,CMD_ATTRS:105,CMD_EXTENDED:200,CMD_EXTENDED_REPLY:201,SFTP_OK:0,SFTP_EOF:1,SFTP_NO_SUCH_FILE:2,SFTP_PERMISSION_DENIED:3,SFTP_FAILURE:4,SFTP_BAD_MESSAGE:5,SFTP_NO_CONNECTION:6,SFTP_CONNECTION_LOST:7,SFTP_OP_UNSUPPORTED:8,SFTP_DESC:["Success","End of file","No such file","Permission denied","Failure","Bad message","No connection","Connection lost","Operation unsupported"],SFTP_FLAG_READ:1,SFTP_FLAG_WRITE:2,SFTP_FLAG_APPEND:4,SFTP_FLAG_CREATE:8,SFTP_FLAG_TRUNC:16,SFTP_FLAG_EXCL:32,_VERSION:3,CMD_NAMES:{1:"init",2:"version",3:"open",4:"close",5:"read",6:"write",7:"lstat",8:"fstat",9:"setstat",10:"fsetstat",11:"opendir",12:"readdir",13:"remove",14:"mkdir",15:"rmdir",16:"realpath",17:"stat",18:"rename",19:"readlink",20:"symlink",101:"status",102:"handle",103:"data",104:"name",105:"attrs",200:"extended",201:"extended_reply"},_send_version:function(a){var b=this,c=function(){b._send_version_callback(a)};this._send_packet(this.CMD_INIT,struct.pack(">I",this._VERSION),c)},_send_version_callback:function(a){try{var b=this._read_packet()}catch(c){if(c instanceof paramikojs.ssh_exception.WaitException){var d=this,e=function(){d._send_version_callback(a)};return void setTimeout(e,10)}throw c}if(b[0]!=this.CMD_VERSION)throw"Incompatible sftp protocol";var f=struct.unpack(">I",b[1].substring(0,4))[0];a(f)},_send_server_version:function(){var a=this._read_packet();if(t!=this.CMD_INIT)throw"Incompatible sftp protocol";var b=struct.unpack(">I",a[0].substring(0,4))[0],c=["check-file","md5,sha1"],d=new paramikojs.Message;return d.add_int(this._VERSION),d.add(c),this._send_packet(this.CMD_VERSION,d.toString()),b},_write_all:function(a,b){for(;a.length>0;){try{var c=this.sock.send(a)}catch(d){if(d instanceof paramikojs.ssh_exception.WaitException){var e=this,f=function(){e._write_all(a,b)};return void setTimeout(f,10)}throw d}if(0>=c)throw new paramikojs.ssh_exception.EOFError;if(c==a.length)return void(b&&b());a=a.substring(c)}},_read_all:function(a){var b=this.sock.recv(a);if(b.length<a)throw this.sock.in_buffer=b+this.sock.in_buffer,new paramikojs.ssh_exception.WaitException("wait");return b},_send_packet:function(a,b,c){console.debug("write: "+this.CMD_NAMES[a]+"(len="+b.length+")");var d=struct.pack(">I",b.length+1)+String.fromCharCode(a)+b;this.ultra_debug&&console.debug(paramikojs.util.format_binary(d,"OUT: ")),this._write_all(d,c)},_read_packet:function(){var a=this._read_all(4);if("\x00"!=a[0])throw"Garbage packet received";var b=struct.unpack(">I",a)[0];try{var c=this._read_all(b)}catch(d){throw d instanceof paramikojs.ssh_exception.WaitException?(this.sock.in_buffer=a+this.sock.in_buffer,new paramikojs.ssh_exception.WaitException("wait")):d}if(this.ultra_debug&&console.debug(paramikojs.util.format_binary(c,"IN: ")),b>0){var e=c[0].charCodeAt(0);return console.debug("read: "+this.CMD_NAMES[e]+"(len="+(c.length-1)+")"),[e,c.substring(1)]}return[0,""]}},paramikojs.ssh_exception={},paramikojs.ssh_exception.SSHException=function(a){this.message=a,this.custom=!0,this.name="SSHException"},paramikojs.ssh_exception.SSHException.prototype.toString=function(){return this.name+': "'+this.message+'"'},paramikojs.ssh_exception.WaitException=function(a){var b=new paramikojs.ssh_exception.SSHException(a);inherit(this,b),this.toString=b.toString,this.name="WaitException"},paramikojs.ssh_exception.CipherException=function(a){var b=new paramikojs.ssh_exception.SSHException(a);inherit(this,b),this.toString=b.toString,this.name="CipherException"},paramikojs.ssh_exception.EOFError=function(a){var b=new paramikojs.ssh_exception.SSHException(a);inherit(this,b),this.toString=b.toString,this.name="EOFError"},paramikojs.ssh_exception.IOError=function(a){var b=new paramikojs.ssh_exception.SSHException(a);inherit(this,b),this.toString=b.toString,this.name="IOError"},paramikojs.ssh_exception.SFTPError=function(a){var b=new paramikojs.ssh_exception.SSHException(a);inherit(this,b),this.toString=b.toString,this.name="SFTPError"},paramikojs.ssh_exception.UserRequestedDisconnect=function(a){var b=new paramikojs.ssh_exception.SSHException(a);inherit(this,b),this.toString=b.toString,this.name="UserRequestedDisconnect"},paramikojs.ssh_exception.IsPuttyKey=function(a,b){var c=new paramikojs.ssh_exception.SSHException(a);inherit(this,c),this.toString=c.toString,this.name="IsPuttyKey",this.lines=b},paramikojs.ssh_exception.BERException=function(a){var b=new paramikojs.ssh_exception.SSHException(a);inherit(this,b),this.toString=b.toString,this.name="BERException"},paramikojs.ssh_exception.NeedRekeyException=function(a){var b=new paramikojs.ssh_exception.SSHException(a);inherit(this,b),this.toString=b.toString,this.name="NeedRekeyException"},paramikojs.ssh_exception.AuthenticationException=function(a){var b=new paramikojs.ssh_exception.SSHException(a);inherit(this,b),this.toString=b.toString,this.name="AuthenticationException"},paramikojs.ssh_exception.PasswordRequiredException=function(a){var b=new paramikojs.ssh_exception.SSHException(a);inherit(this,b),this.toString=b.toString,this.name="PasswordRequiredException"},paramikojs.ssh_exception.BadAuthenticationType=function(a,b){var c=new paramikojs.ssh_exception.SSHException(a);inherit(this,c),this.toString=c.toString,this.name="BadAuthenticationType",this.allowed_types=b},paramikojs.ssh_exception.BadAuthenticationType.prototype.toString=function(){return this.name+': "'+this.message+'"(allowed_types='+JSON.stringify(this.allowed_types)+")"},paramikojs.ssh_exception.PartialAuthentication=function(a){var b=new paramikojs.ssh_exception.SSHException("partial authentication");inherit(this,b),this.toString=b.toString,this.name="PartialAuthentication",this.allowed_types=a
},paramikojs.ssh_exception.ChannelException=function(a,b){var c=new paramikojs.ssh_exception.SSHException(b);inherit(this,c),this.toString=c.toString,this.name="ChannelException",this.code=a},paramikojs.ssh_exception.BadHostKeyException=function(a,b,c){var d=new paramikojs.ssh_exception.SSHException("Host key for server "+a+" does not match!");inherit(this,d),this.toString=d.toString,this.name="BadHostKeyException",this.hostname=a,this.key=b,this.expected_key=c},paramikojs.transport=function(){this.rng=new kryptos.random.Random,this.packetizer=new paramikojs.Packetizer(this),this.packetizer.set_hexdump(!1),this.local_version="SSH-"+this._PROTO_ID+"-"+this._CLIENT_ID,this.remote_version="",this.local_cipher=this.remote_cipher="",this.local_kex_init=this.remote_kex_init=null,this.local_mac=this.remote_mac=null,this.local_compression=this.remote_compression=null,this.session_id=null,this.host_key_type=null,this.host_key=null,this.kex_engine=null,this.H=null,this.K=null,this.active=!1,this.initial_kex_done=!1,this.in_kex=!1,this.authenticated=!1,this._expected_packet=[],this._channels={},this.channel_events={},this.channels_seen={},this._channel_counter=1,this.max_packet_size=Math.pow(2,15),this.window_size=64*this.max_packet_size,this._x11_handler=null,this._tcp_handler=null,this.saved_exception=null,this.clear_to_send=!1,this.auth_handler=null,this.global_response=null,this.completion_event=null,this.banner_timeout=15},paramikojs.transport.prototype={fullBuffer:"",gotWelcomeMessage:!1,authenticatedCallback:null,writeCallback:null,toUTF8:window.Components?window.Components.classes["@mozilla.org/intl/utf8converterservice;1"].getService(window.Components.interfaces.nsIUTF8ConverterService):{convertStringToUTF8:function(a){return a}},fromUTF8:window.Components?window.Components.classes["@mozilla.org/intl/scriptableunicodeconverter"].getService(window.Components.interfaces.nsIScriptableUnicodeConverter):{ConvertFromUnicode:function(a){return a},Finish:function(){}},_PROTO_ID:"2.0",_CLIENT_ID:"ParamikoJS_",_preferred_ciphers:["blowfish-cbc","aes128-ctr","aes256-ctr","aes128-cbc","aes256-cbc","3des-cbc","arcfour128","arcfour256"],_preferred_macs:["hmac-sha2-256","hmac-sha2-512","hmac-sha1","hmac-md5","hmac-sha1-96","hmac-md5-96"],_preferred_keys:["ssh-rsa","ssh-dss"],_preferred_kex:["diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha1","diffie-hellman-group-exchange-sha1","diffie-hellman-group1-sha1"],_preferred_compression:["none"],_cipher_info:{"aes128-ctr":{"class":kryptos.cipher.AES,mode:kryptos.cipher.AES.MODE_CTR,"block-size":16,"key-size":16},"aes256-ctr":{"class":kryptos.cipher.AES,mode:kryptos.cipher.AES.MODE_CTR,"block-size":16,"key-size":32},"blowfish-cbc":{"class":kryptos.cipher.Blowfish,mode:kryptos.cipher.Blowfish.MODE_CBC,"block-size":8,"key-size":16},"aes128-cbc":{"class":kryptos.cipher.AES,mode:kryptos.cipher.AES.MODE_CBC,"block-size":16,"key-size":16},"aes256-cbc":{"class":kryptos.cipher.AES,mode:kryptos.cipher.AES.MODE_CBC,"block-size":16,"key-size":32},"3des-cbc":{"class":kryptos.cipher.DES3,mode:kryptos.cipher.DES3.MODE_CBC,"block-size":8,"key-size":24},arcfour128:{"class":kryptos.cipher.ARC4,mode:null,"block-size":8,"key-size":16},arcfour256:{"class":kryptos.cipher.ARC4,mode:null,"block-size":8,"key-size":32}},_mac_info:{"hmac-sha1":{"class":kryptos.hash.HMAC_SHA,size:20,digest_size:kryptos.hash.SHA.digest_size},"hmac-sha1-96":{"class":kryptos.hash.HMAC_SHA,size:12,digest_size:kryptos.hash.SHA.digest_size},"hmac-sha2-256":{"class":kryptos.hash.HMAC_SHA256,size:32,digest_size:kryptos.hash.SHA256.digest_size},"hmac-sha2-512":{"class":kryptos.hash.HMAC_SHA512,size:64,digest_size:kryptos.hash.SHA512.digest_size},"hmac-md5":{"class":kryptos.hash.HMAC_MD5,size:16,digest_size:kryptos.hash.MD5.digest_size},"hmac-md5-96":{"class":kryptos.hash.HMAC_MD5,size:12,digest_size:kryptos.hash.MD5.digest_size}},_key_info:{"ssh-rsa":function(a){return new paramikojs.RSAKey(a)},"ssh-dss":function(a){return new paramikojs.DSSKey(a)}},_kex_info:{"diffie-hellman-group1-sha1":function(a){return new paramikojs.KexGroup1(a)},"diffie-hellman-group14-sha1":function(a){return new paramikojs.KexGroup14(a)},"diffie-hellman-group-exchange-sha1":function(a){return new paramikojs.KexGex(a)},"diffie-hellman-group-exchange-sha256":function(a){return new paramikojs.KexGexSHA256(a)}},_compression_info:{"zlib@openssh.com":[paramikojs.ZlibCompressor,paramikojs.ZlibDecompressor],zlib:[paramikojs.ZlibCompressor,paramikojs.ZlibDecompressor],none:[null,null]},_modulus_pack:null,start_client:function(){this.active=!0},close:function(){if(this.active){this.active=!1;for(var a=0;a<this._channels.length;++a)this._channels[a]._unlink();this.packetizer.close()}},get_remote_server_key:function(){if(!this.active||!this.initial_kex_done)throw new paramikojs.ssh_exception.SSHException("No existing session");return this.host_key},is_active:function(){return this.active},open_session:function(a){return this.open_channel("session",null,null,a)},open_x11_channel:function(a){return this.open_channel("x11",null,a)},open_forwarded_tcpip_channel:function(a,b,c,d){return this.open_channel("forwarded-tcpip",[c,d],[a,b])},open_channel:function(a,b,c,d){if(!this.active)throw new paramikojs.ssh_exception.SSHException("SSH session not active");var e=this._next_channel(),f=new paramikojs.Message;f.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_OPEN)),f.add_string(a),f.add_int(e),f.add_int(this.window_size),f.add_int(this.max_packet_size),"forwarded-tcpip"==a||"direct-tcpip"==a?(f.add_string(b[0]),f.add_int(b[1]),f.add_string(c[0]),f.add_int(c[1])):"x11"==a&&(f.add_string(c[0]),f.add_int(c[1]));var g=new paramikojs.Channel(e);return this._channels[e]=g,this._channels[e].on_success=d,this.channels_seen[e]=!0,g._set_transport(this),g._set_window(this.window_size,this.max_packet_size),this._send_user_message(f),g},request_port_forward:function(a,b,c){function d(a){f._queue_incoming_channel(a)}if(!this.active)throw new paramikojs.ssh_exception.SSHException("SSH session not active");var e=this.global_request("tcpip-forward",[a,b],!0);if(!e)throw new paramikojs.ssh_exception.SSHException("TCP forwarding request denied");if(0==b&&(b=e.get_int()),!c){var f=this;c=d}return this._tcp_handler=c,b},cancel_port_forward:function(a,b){this.active&&(this._tcp_handler=null,this.global_request("cancel-tcpip-forward",[a,b],!0))},open_sftp_client:function(a){paramikojs.SFTPClient.from_transport(this,a)},send_ignore:function(a){var b=new paramikojs.Message;b.add_byte(String.fromCharCode(paramikojs.MSG_IGNORE)),a||(a=this.rng.read(1).charCodeAt(0)%32+10),b.add_bytes(this.rng.read(a)),this._send_user_message(b)},renegotiate_keys:function(){this._send_kex_init()},set_keepalive:function(a){var b=this,c=function(){b.global_request("keepalive@lag.net",null,!1)};this.packetizer.set_keepalive(a,c)},global_request:function(a,b,c){var d=new paramikojs.Message;return d.add_byte(String.fromCharCode(paramikojs.MSG_GLOBAL_REQUEST)),d.add_string(a),d.add_boolean(c),b&&d.add(b),console.debug("Sending global request: "+a),this._send_user_message(d),this.global_response},connect:function(a,b,c,d,e,f){a&&(this._preferred_keys=[a.get_name()]),this.start_client(),this.authenticatedCallback=b||function(){var b=this.get_remote_server_key();if(a){if(b.get_name()!=a.get_name()||b.toString()!=a.toString())throw console.debug("Bad host key from server"),console.debug("Expected: %s: %s"+a.get_name()+":"+a.toString()),console.debug("Got     : %s: %s"+b.get_name()+": "+b.toString()),new paramikojs.ssh_exception.SSHException("Bad host key from server");console.debug("Host key verified ("+a.get_name()+")")}(e||d)&&(d?(console.debug("Attempting password auth..."),this.auth_password(c,d)):(console.debug("Attempting public-key auth..."),this.auth_publickey(c,e)))},this.auth_callback=function(a,b,g,h){if(a)f();else{if(!b)throw new paramikojs.ssh_exception.AuthenticationException("Authentication failed");if(g||-1==b.indexOf("keyboard-interactive")){if(h||!e||-1==b.indexOf("publickey"))throw new paramikojs.ssh_exception.AuthenticationException("Authentication failed");this.auth_publickey(c,e)}else{var i=function(a,b,c){if(c.length>1)throw new paramikojs.ssh_exception.SSHException("Fallback authentication failed.");return 0==c.length?[]:[d]};this.auth_interactive(c,i)}}}},get_exception:function(){var a=this.saved_exception;return this.saved_exception=null,a},is_authenticated:function(){return this.active&&this.auth_handler&&this.auth_handler.is_authenticated()},get_username:function(){return this.active&&this.auth_handler?this.auth_handler.get_username():null},auth_none:function(a){if(!this.active||!this.initial_kex_done)throw new paramikojs.ssh_exception.SSHException("No existing session");return this.auth_handler=new paramikojs.AuthHandler(this),this.auth_handler.auth_none(a),this.auth_handler.wait_for_response()},auth_password:function(a,b){if(!this.active||!this.initial_kex_done)throw new paramikojs.ssh_exception.SSHException("No existing session");return this.auth_handler=new paramikojs.AuthHandler(this),this.auth_handler.auth_password(a,b),this.auth_handler.wait_for_response()},auth_publickey:function(a,b){if(!this.active||!this.initial_kex_done)throw new paramikojs.ssh_exception.SSHException("No existing session");return this.auth_handler=new paramikojs.AuthHandler(this),this.auth_handler.auth_publickey(a,b),this.auth_handler.wait_for_response()},auth_interactive:function(a,b,c){if(!this.active||!this.initial_kex_done)throw new paramikojs.ssh_exception.SSHException("No existing session");return this.auth_handler=new paramikojs.AuthHandler(this),this.auth_handler.auth_interactive(a,b,c),this.auth_handler.wait_for_response()},use_compression:function(a){this._preferred_compression=a?["zlib@openssh.com","zlib","none"]:["none"]},_get_modulus_pack:function(){return this._modulus_pack},_next_channel:function(){for(var a=this._channel_counter;this._channels[a];)this._channel_counter=this._channel_counter+1&16777215,a=this._channel_counter;return this._channel_counter=this._channel_counter+1&16777215,a},_unlink_channel:function(a){delete this._channels[a]},_send_message:function(a){this.packetizer.send_message(a)},_send_user_message:function(a){if(!this.clear_to_send){var b=this,c=function(){b._send_user_message(a)};return void setTimeout(c,100)}this._send_message(a)},_set_K_H:function(a,b){this.K=a,this.H=b,this.session_id||(this.session_id=b)},_expect_packet:function(a){this._expected_packet=[a]},_verify_key:function(a,b){var c=this._key_info[this.host_key_type](new paramikojs.Message(a));if(!c)throw new paramikojs.ssh_exception.SSHException("Unknown host key type");if(!c.verify_ssh_sig(this.H,new paramikojs.Message(b)))throw new paramikojs.ssh_exception.SSHException("Signature verification ("+this.host_key_type+") failed.");this.host_key=c},_compute_key:function(a,b){var c=new paramikojs.Message;c.add_mpint(this.K),c.add_bytes(this.H),c.add_byte(a),c.add_bytes(this.session_id);var d,e,f,g=this.kex_engine.hash_algo;for(d=e=new g(c.toString()).digest();d.length<b;)c=new paramikojs.Message,c.add_mpint(this.K),c.add_bytes(this.H),c.add_bytes(e),f=new g(c.toString()).digest(),d+=f,e+=f;return d.substring(0,b)},_get_cipher:function(a,b,c){if(!(a in this._cipher_info))throw new paramikojs.ssh_exception.SSHException("Unknown client cipher "+a);if(a in{arcfour128:!0,arcfour256:!0}){var d=new this._cipher_info[a]["class"](b);return d.encrypt(new Array(1537).join(" ")),d}if(a.indexOf("-ctr")==a.length-4){var e=new paramikojs.util.Counter(8*this._cipher_info[a]["block-size"],paramikojs.util.inflate_long(c,!0));return new this._cipher_info[a]["class"](b,this._cipher_info[a].mode,c,e)}return new this._cipher_info[a]["class"](b,this._cipher_info[a].mode,c)},_set_x11_handler:function(a){if(a)this._x11_handler=a;else{var b=this,c=function(a){b._queue_incoming_channel(a)};this._x11_handler=c}},run:function(){if(this.active&&(this.gotWelcomeMessage||-1!=this.fullBuffer.indexOf("\n"))){this.gotWelcomeMessage&&this.packetizer.need_rekey()&&!this.in_kex&&this._send_kex_init();try{var a=this.gotWelcomeMessage?this.packetizer.read_message():""}catch(b){if(b instanceof paramikojs.ssh_exception.WaitException)return;throw b}if(!this.gotWelcomeMessage)return this.gotWelcomeMessage=!0,this._check_banner(),this.packetizer.write_all(this.local_version+"\r\n"),this._expect_packet(paramikojs.MSG_KEXINIT),void this.nextCommand();if(a.ptype==paramikojs.MSG_IGNORE)return void this.nextCommand();if(a.ptype==paramikojs.MSG_DISCONNECT)return this._parse_disconnect(a.m),this.active=!1,void this.packetizer.close();if(a.ptype==paramikojs.MSG_DEBUG)return this._parse_debug(a.m),void this.nextCommand();if(this._expected_packet.length>0){if(-1==this._expected_packet.indexOf(a.ptype))throw new paramikojs.ssh_exception.SSHException("Expecting packet from "+this._expected_packet+", got "+a.ptype);if(this._expected_packet=[],a.ptype>=30&&a.ptype<=39)return this.kex_engine.parse_next(a.ptype,a.m),void this.nextCommand()}if(a.ptype in this._handler_table)this._handler_table[a.ptype](this,a.m);else if(a.ptype in this._channel_handler_table){var c=a.m.get_int(),d=this._channels[c];d?this._channel_handler_table[a.ptype](d,a.m):c in this.channels_seen?console.debug("Ignoring message for dead channel "+c):(console.error("Channel request for unknown channel "+c),this.active=!1,this.packetizer.close())}else if(this.auth_handler&&a.ptype in this.auth_handler._handler_table)this.auth_handler._handler_table[a.ptype](this.auth_handler,a.m);else{console.warn("Oops, unhandled type "+a.ptype);var e=new paramikojs.Message;e.add_byte(String.fromCharCode(paramikojs.MSG_UNIMPLEMENTED)),e.add_int(a.m.seqno),this._send_message(e)}this.nextCommand()}},nextCommand:function(){this.fullBuffer&&this.run()},_negotiate_keys:function(a){this.clear_to_send=!1,this.local_kex_init||this._send_kex_init(),this._parse_kex_init(a),this.kex_engine.start_kex()},_check_banner:function(){var a=this.packetizer.readline();if("SSH-"!=a.substring(0,4))throw new paramikojs.ssh_exception.SSHException('Indecipherable protocol version "'+a+'"');this.remote_version=a;var b="",c=a.indexOf(" ");c>=0&&(b=a.substring(c+1),a=a.substring(0,c));var d=a.split("-");if(d.length<3)throw new paramikojs.ssh_exception.SSHException("Invalid SSH banner");var e=d[1],f=d[2];if("1.99"!=e&&"2.0"!=e)throw new paramikojs.ssh_exception.SSHException("Incompatible version ("+e+" instead of 2.0)");console.info("Connected (version "+e+", client "+f+(b?0/0+b:"")+")","input","info")},_send_kex_init:function(){this.clear_to_send=!1,this.in_kex=!0;var a=this._preferred_keys,b=new paramikojs.Message;b.add_byte(String.fromCharCode(paramikojs.MSG_KEXINIT)),b.add_bytes(this.rng.read(16)),b.add_list(this._preferred_kex),b.add_list(a),b.add_list(this._preferred_ciphers),b.add_list(this._preferred_ciphers),b.add_list(this._preferred_macs),b.add_list(this._preferred_macs),b.add_list(this._preferred_compression),b.add_list(this._preferred_compression),b.add_string(""),b.add_string(""),b.add_boolean(!1),b.add_int(0),this.local_kex_init=b.toString(),this._send_message(b)},_parse_kex_init:function(a){function b(a,b){for(var c=[],d=0;d<b.length;++d)-1!=a.indexOf(b[d])&&c.push(b[d]);return c}{var c=(a.get_bytes(16),a.get_list()),d=a.get_list(),e=a.get_list(),f=a.get_list(),g=a.get_list(),h=a.get_list(),i=a.get_list(),j=a.get_list(),k=a.get_list(),l=a.get_list(),m=a.get_boolean();a.get_int()}console.debug("kex algos: "+c+"\nserver key: "+d+"\nclient encrypt: "+e+"\nserver encrypt: "+f+"\nclient mac: "+g+"\nserver mac: "+h+"\nclient compress: "+i+"\nserver compress: "+j+"\nclient lang: "+k+"\nserver lang: "+l+"\nkex follows? "+m);var n=b(c,this._preferred_kex);if(!n.length)throw new paramikojs.ssh_exception.SSHException("Incompatible ssh peer (no acceptable kex algorithm)");this.kex_engine=this._kex_info[n[0]](this);var o=b(d,this._preferred_keys);if(!o.length)throw new paramikojs.ssh_exception.SSHException("Incompatible ssh peer (no acceptable host key)");this.host_key_type=o[0];var p=b(e,this._preferred_ciphers),q=b(f,this._preferred_ciphers);if(!p.length||!q.length)throw new paramikojs.ssh_exception.SSHException("Incompatible ssh server (no acceptable ciphers)");this.local_cipher=p[0],this.remote_cipher=q[0],console.debug("Ciphers agreed: local="+this.local_cipher+", remote="+this.remote_cipher);var r=b(g,this._preferred_macs),s=b(h,this._preferred_macs);if(!r.length||!s.length)throw new paramikojs.ssh_exception.SSHException("Incompatible ssh server (no acceptable macs)");this.local_mac=r[0],this.remote_mac=s[0];var t=b(i,this._preferred_compression),u=b(j,this._preferred_compression);if(!t.length||!u.length)throw new paramikojs.ssh_exception.SSHException("Incompatible ssh server (no acceptable compression) "+t+" "+u+" "+this._preferred_compression);this.local_compression=t[0],this.remote_compression=u[0],console.debug("using kex: "+n[0]+"\nserver key type: "+this.host_key_type+"\ncipher: local "+this.local_cipher+", remote "+this.remote_cipher+"\nmac: local "+this.local_mac+", remote "+this.remote_mac+"\ncompression: local "+this.local_compression+", remote "+this.remote_compression),this.remote_kex_init=String.fromCharCode(paramikojs.MSG_KEXINIT)+a.get_so_far()},_activate_inbound:function(){var a=this._cipher_info[this.remote_cipher]["block-size"],b=this._compute_key("B",a),c=this._compute_key("D",this._cipher_info[this.remote_cipher]["key-size"]),d=this._get_cipher(this.remote_cipher,c,b),e=this._mac_info[this.remote_mac].size,f=this._mac_info[this.remote_mac]["class"],g=this._mac_info[this.remote_mac].digest_size,h=this._compute_key("F",g);this.packetizer.set_inbound_cipher(d,a,f,e,h);var i=this._compression_info[this.remote_compression][1];i&&("zlib@openssh.com"!=this.remote_compression||this.authenticated)&&(console.debug("Switching on inbound compression ..."),this.packetizer.set_inbound_compressor(new i))},_activate_outbound:function(){var a=new paramikojs.Message;a.add_byte(String.fromCharCode(paramikojs.MSG_NEWKEYS)),this._send_message(a);var b=this._cipher_info[this.local_cipher]["block-size"],c=this._compute_key("A",b),d=this._compute_key("C",this._cipher_info[this.local_cipher]["key-size"]),e=this._get_cipher(this.local_cipher,d,c),f=this._mac_info[this.local_mac].size,g=this._mac_info[this.local_mac]["class"],h=this._mac_info[this.local_mac].digest_size,i=this._compute_key("E",h);this.packetizer.set_outbound_cipher(e,b,g,f,i);var j=this._compression_info[this.local_compression][0];j&&("zlib@openssh.com"!=this.local_compression||this.authenticated)&&(console.debug("Switching on outbound compression ..."),this.packetizer.set_outbound_compressor(new j)),this.packetizer.need_rekey()||(this.in_kex=!1),this._expect_packet(paramikojs.MSG_NEWKEYS)},_auth_trigger:function(){if(this.authenticated=!0,"zlib@openssh.com"==this.local_compression){var a=this._compression_info[this.local_compression][0];console.debug("Switching on outbound compression ..."),this.packetizer.set_outbound_compressor(new a)}if("zlib@openssh.com"==this.remote_compression){var b=this._compression_info[this.remote_compression][1];console.debug("Switching on inbound compression ..."),this.packetizer.set_inbound_compressor(new b)}},_parse_newkeys:function(){console.debug("Switch to new keys ..."),this._activate_inbound(),this.local_kex_init=this.remote_kex_init=null,this.K=null,this.kex_engine=null,this.initial_kex_done||(this.initial_kex_done=!0),this.packetizer.need_rekey()||(this.in_kex=!1),this.clear_to_send=!0,this.authenticatedCallback&&(this.authenticatedCallback(),this.authenticatedCallback=null)},_parse_disconnect:function(a){var b=a.get_int(),c=a.get_string();console.info("Disconnect (code "+b+"): "+c)},_parse_global_request:function(a){var b=a.get_string();console.debug("Received global request "+b);var c=a.get_boolean();console.debug('Rejecting "'+b+'" global request from server.');if(c){var d=new paramikojs.Message;d.add_byte(String.fromCharCode(paramikojs.MSG_REQUEST_FAILURE)),this._send_message(d)}},_parse_request_success:function(a){console.debug("Global request successful."),this.global_response=a},_parse_request_failure:function(){console.debug("Global request denied."),this.global_response=null},_parse_channel_open_success:function(a){var b=a.get_int(),c=a.get_int(),d=a.get_int(),e=a.get_int(),f=this._channels[b];return f?(f._set_remote_channel(c,d,e),console.info("Secsh channel "+b+" opened."),void(f.on_success&&f.on_success(f))):void console.debug("Success for unrequested channel! [??]")},_parse_channel_open_failure:function(a){var b=a.get_int(),c=a.get_int(),d=a.get_string(),e=(a.get_string(),c in paramikojs.CONNECTION_FAILED_CODE?paramikojs.CONNECTION_FAILED_CODE[c]:"(unknown code)");console.info("Secsh channel "+b+" open FAILED: "+d+": "+e),this.saved_exception=new paramikojs.ssh_exception.ChannelException(c,e)},_parse_channel_open:function(a){var b,c,d,e,f=a.get_string(),g=a.get_int(),h=a.get_int(),i=a.get_int(),j=!1;if("x11"==f&&this._x11_handler?(b=a.get_string(),c=a.get_int(),console.debug("Incoming x11 connection from "+b+":"+c),my_chanid=this._next_channel()):"forwarded-tcpip"==f&&this._tcp_handler?(d=a.get_string(),e=a.get_int(),b=a.get_string(),c=a.get_int(),console.debug("Incoming tcp forwarded connection from "+b+":"+c),my_chanid=this._next_channel()):(console.debug('Rejecting "'+f+'" channel request from server.'),j=!0,reason=paramikojs.OPEN_FAILED_ADMINISTRATIVELY_PROHIBITED),j){var k=new paramikojs.Message;return k.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_OPEN_FAILURE)),k.add_int(g),k.add_int(reason),k.add_string(""),k.add_string("en"),void this._send_message(k)}var l=new Channel(my_chanid);this._channels[my_chanid]=l,this.channels_seen[my_chanid]=!0,l._set_transport(this),l._set_window(this.window_size,this.max_packet_size),l._set_remote_channel(g,h,i);var a=new paramikojs.Message;a.add_byte(String.fromCharCode(paramikojs.MSG_CHANNEL_OPEN_SUCCESS)),a.add_int(g),a.add_int(my_chanid),a.add_int(this.window_size),a.add_int(this.max_packet_size),this._send_message(a),console.info("Secsh channel "+my_chanid+" ("+f+") opened."),"x11"==f?this._x11_handler(l,[b,c]):"forwarded-tcpip"==f?(l.origin_addr=[b,c],this._tcp_handler(l,[b,c],[d,e])):this._queue_incoming_channel(l)},_parse_debug:function(a){{var b=(a.get_boolean(),a.get_string());a.get_string()}console.debug("Debug msg: "+paramikojs.util.safe_string(b))},_get_subsystem_handler:function(a){return a in this.subsystem_table?this.subsystem_table[a]:[None,[],{}]},_handler_table:{21:function(a,b){a._parse_newkeys(b)},80:function(a,b){a._parse_global_request(b)},81:function(a,b){a._parse_request_success(b)},82:function(a,b){a._parse_request_failure(b)},91:function(a,b){a._parse_channel_open_success(b)},92:function(a,b){a._parse_channel_open_failure(b)},90:function(a,b){a._parse_channel_open(b)},20:function(a,b){a._negotiate_keys(b)}},_channel_handler_table:{99:function(a,b){a._request_success(b)},100:function(a,b){a._request_failed(b)},94:function(a,b){a._feed(b)},95:function(a,b){a._feed_extended(b)},93:function(a,b){a._window_adjust(b)},98:function(a,b){a._handle_request(b)},96:function(a,b){a._handle_eof(b)},97:function(a,b){a._handle_close(b)}}},paramikojs.util={},paramikojs.util.inflate_long=function(a,b){var c=new BigInteger("0",10),d=0;if(!b&&a.length>0&&a.charCodeAt(0)>=128&&(d=1),a.length%4){var e="\x00";d&&(e="ÿ"),a=new Array(4-a.length%4+1).join(e)+a}for(var f=0;f<a.length;f+=4)c=c.shiftLeft(32),c=c.add(new BigInteger(struct.unpack(">I",a.substring(f,f+4))[0].toString(),10));if(d){var g=new BigInteger("1",10);c=g.shiftLeft(8*a.length),c=c.subtract(g)}return c},paramikojs.util.deflate_long=function(a,b){a="number"==typeof a?new BigInteger(a.toString(),10):a.clone(),b=void 0==b?!0:b;for(var c="",d=new BigInteger("-1",10),e=new BigInteger("ffffffff",16);!a.equals(BigInteger.ZERO)&&!a.equals(d);)c=struct.pack(">I",a.and(e))+c,a=a.shiftRight(32);for(var f=!1,g=0;g<c.length;++g){if(a.equals(BigInteger.ZERO)&&"\x00"!=c.charAt(g)){f=!0;break}if(a.equals(d)&&"ÿ"!=c.charAt(g)){f=!0;break}}return f||(g=0,c=a.equals(BigInteger.ZERO)?"\x00":"ÿ"),c=c.substring(g),b&&(a.equals(BigInteger.ZERO)&&c.charCodeAt(0)>=128&&(c="\x00"+c),a.equals(d)&&c.charCodeAt(0)<128&&(c="ÿ"+c)),c},paramikojs.util.format_binary_weird=function(a){for(var b="",c=0;c<a.length;++c){var d=a[c];b+="%02X"%d[1].charCodeAt(0),d[0]%2&&(b+=" "),d[0]%16==15&&(b+="\n")}return b},paramikojs.util.format_binary=function(a,b){b=b||"";for(var c=0,d=[];a.length>c+16;)d.push(paramikojs.util.format_binary_line(a.substring(c,c+16))),c+=16;c<a.length&&d.push(paramikojs.util.format_binary_line(a.substring(c)));for(var e=[],f=0;f<d.length;++f)e.push(b+d[f]);return"\n"+e.join("\n")},paramikojs.util.format_binary_line=function(a){var b=paramikojs.util.hexify(a," ");b=b.length<50?b+new Array(50-b.length+1).join("&nbsp;"):b;for(var c="",d=0;d<a.length;++d){var e=a[d];c+=1==parseInt((e.charCodeAt(0)+63)/95)?e:"."}return b+" "+c},paramikojs.util.hexify=function(a,b){return binascii.hexlify(a,b).toUpperCase()},paramikojs.util.unhexify=function(a){return binascii.unhexlify(a)},paramikojs.util.safe_string=function(a){out="";for(var b=0;b<a.length;++b){var c=a[b];out+=c.charCodeAt(0)>=32&&c.charCodeAt(0)<=127?c:"%"+c.charCodeAt(0)+" "}return out},paramikojs.util.bit_length=function(a){var b=paramikojs.util.deflate_long(a,0),c=b[0].charCodeAt(0);if(0==c)return 1;for(var d=8*b.length;!(128&c);)c<<=1,d-=1;return d},paramikojs.util.tb_strings=function(){return""},paramikojs.util.generate_key_bytes=function(a,b,c,d){var e="",f="";for(b.length>8&&(b=b.substring(0,8));d>0;){var g=new a;f.length>0&&g.update(f),g.update(c),g.update(b),f=g.digest();var h=Math.min(d,f.length);e+=f.substring(0,h),d-=h}return e},paramikojs.util.load_host_keys=function(a){return new paramikojs.HostKeys(a)},paramikojs.util.parse_ssh_config=function(a){var b=new paramikojs.SSHConfig;return b.parse(a),b},paramikojs.util.lookup_ssh_host_config=function(a,b){return b.lookup(a)},paramikojs.util.mod_inverse=function(a,b){for(var c=1,d=0,e=b,f=0,g=1,h=a;h>0;){var i=parseInt(e/h),j=f;f=c-f*i,c=j,j=g,g=d-g*i,d=j,j=h,h=e-h*i,e=j}return 0>d&&(d+=b),d},paramikojs.util.Counter=function(a,b,c){if(b=void 0==b?1:b,c=c||0,this.blocksize=a/8,this.overflow=c,0==b)this.value=new Array(this.blocksize+1).join("ÿ");else{var d=BigInteger.ONE,e=paramikojs.util.deflate_long(b.subtract(d),!1);this.value=new Array(this.blocksize-e.length+1).join("\x00")+e}},paramikojs.util.Counter.prototype={call:function(){for(var a=this.blocksize-1;a>-1;){var b=String.fromCharCode((this.value.charCodeAt(a)+1)%256);if(this.value=paramikojs.util.setCharAt(this.value,a,b),"\x00"!=b)return this.value;a-=1}var c=paramikojs.util.deflate_long(this.overflow,!1);return this.value=new Array(this.blocksize-c.length+1).join("\x00")+c,this.value}},paramikojs.util.setCharAt=function(a,b,c){return a.substr(0,b)+c+a.substr(b+1)},paramikojs.win_pageant=function(){},paramikojs.win_pageant.prototype={_AGENT_COPYDATA_ID:2152616122,_AGENT_MAX_MSGLEN:8192,win32con_WM_COPYDATA:74,_get_pageant_window_object:function(){return ctypes.windll.user32.FindWindowA("Pageant","Pageant")},can_talk_to_agent:function(){return this._get_pageant_window_object()?!0:!1},_query_pageant:function(a){var b=_get_pageant_window_object();if(!b)return null;var c=tempfile.mktemp(".pag"),d=os.path.basename(c),e=open(c,"w+b");e.write(a),e.write("\x00"*(this._AGENT_MAX_MSGLEN-a.length));var f=mmap.mmap(e.fileno(),this._AGENT_MAX_MSGLEN,tagname=d,access=mmap.ACCESS_WRITE);try{var g=array.array("c",d+"\x00");return char_buffer_size=g.buffer_info(),cds=struct.pack("LLP",this._AGENT_COPYDATA_ID,char_buffer_size,char_buffer_address),_buf=array.array("B",cds),_size=_buf.buffer_info(),response=ctypes.windll.user32.SendMessageA(b,win32con_WM_COPYDATA,_size,_addr),response>0?(datalen=f.read(4),retlen=struct.unpack(">I",datalen)[0],datalen+f.read(retlen)):null}catch(h){}finally{f.close(),e.close(),os.unlink(c)}},PageantConnection:{response:null,send:function(a){this._response=paramikojs.win_pageant._query_pageant(a)},recv:function(a){return this._response?(ret=this._response.substring(0,a),this._response=this._response.substring(a),""==this._response&&(this._response=null),ret):""},close:function(){}}};